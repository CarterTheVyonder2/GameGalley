window.__require=function e(t,a,n){function i(l,o){if(!a[l]){if(!t[l]){var r=l.split("/");if(r=r[r.length-1],!t[r]){var c="function"==typeof __require&&__require;if(!o&&c)return c(r,!0);if(s)return s(r,!0);throw new Error("Cannot find module '"+l+"'")}l=r}var d=a[l]={exports:{}};t[l][0].call(d.exports,function(e){return i(t[l][1][e]||e)},d,d.exports,e,t,a,n)}return a[l].exports}for(var s="function"==typeof __require&&__require,l=0;l<n.length;l++)i(n[l]);return i}({ADCallBack:[function(e,t,a){"use strict";cc._RF.push(t,"c3d30bzLa1HK6/CetKo15dX","ADCallBack"),Object.defineProperty(a,"__esModule",{value:!0}),cc._RF.pop()},{}],ADInterface:[function(e,t,a){"use strict";cc._RF.push(t,"bc2adaZhkVNWr49g1FYBnps","ADInterface"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=class{showNative(e){}hideNative(e){}recorderStart(){}recorderStop(){}share(e){}requestSubscribeSystemMessage(e){}onAddToFavorites(e){}hideNativeBanner(){}},cc._RF.pop()},{}],ADManager:[function(e,t,a){"use strict";cc._RF.push(t,"7f898CnRDNJ3Yuor39RovZ7","ADManager"),Object.defineProperty(a,"__esModule",{value:!0}),a.SDK_TYPE=void 0;const n=e("./ADUnity");var i;(function(e){e[e.Byte=0]="Byte",e[e.WeChat=1]="WeChat",e[e.ViVo=2]="ViVo",e[e.Oppo=3]="Oppo",e[e.IOS=4]="IOS",e[e.XiaoMi=5]="XiaoMi",e[e.HuaWei=6]="HuaWei"})(i=a.SDK_TYPE||(a.SDK_TYPE={}));class s{constructor(){this.isTest=!0,this.isConsole=!1,this.sdkType=i.Byte,this.version=105}static get instance(){return this._instance||(this._instance=new s),this._instance}showVideo(e,t,a){if(this.isTest)return console.log("showVideo"),void(e&&e());n.default.showVideo(e,t,a)}hideNativeBanner(){this.isTest||n.default.hideNativeBanner()}hideBanner(){this.isTest||n.default.hideBanner()}showBanner(){this.isTest||n.default.showBanner()}showNative(e){this.isTest||n.default.showNative(e)}hideNative(e){this.isTest?console.log("hide==",e):(console.log("hide==",e),n.default.hideNative(e))}share(e){this.isTest?e&&e():n.default.share(e)}recorderStart(){this.isTest||n.default.recorderStart()}recorderStop(){this.isTest||n.default.recorderStop()}showInsert(){console.log("\u63d2\u5c4f==="),this.isTest||n.default.showInsert()}addShortcut(){this.isTest||n.default.addShortcut()}exitGame(){this.isTest||n.default.exitGame()}showToast(e){this.isTest||n.default.showToast(e)}requestSubscribeSystemMessage(e){this.isTest||n.default.requestSubscribeSystemMessage(e)}onAddToFavorites(e){this.isTest||n.default.onAddToFavorites(e)}init(){if(this.isConsole&&(console.log=function(){},console.info=function(){},console.error=function(){},console.warn=function(){}),this.isTest||cc.sys.os===cc.sys.OS_WINDOWS)return this.isTest=!0,this.isConsole=!1,void console.log("test==========");console.log("ver===",this.version),this.sdkType==i.Oppo&&window.qg.onError(window.Error=function(e){console.error("\u7a0b\u5e8f\u51fa\u9519\u4e86\n"+e.message),console.error("\u7a0b\u5e8f\u51fa\u9519\u4e862\n"+e)}),this.startTime=(new Date).getTime(),console.log("login==========1"),n.default.init(),n.default.creatAD()}}a.default=s,s._instance=null,cc._RF.pop()},{"./ADUnity":"ADUnity"}],ADUnity:[function(e,t,a){"use strict";cc._RF.push(t,"2c5369fsfBLtZ8k8jh0iQrH","ADUnity"),Object.defineProperty(a,"__esModule",{value:!0});const n=e("./ADManager"),i=e("./AD/Byte/ByteAD"),s=e("./AD/WeChat/WeChatAD"),l=e("./AD/Oppo/OppoAD"),o=e("./AD/VIVO/VIVOAD"),r=e("./AD/XiaoMi/XiaoMiAD"),c=e("./AD/HuaWei/HuaWeiAD");a.default=class{static init(){switch(console.log("init===="),n.default.instance.sdkType){case n.SDK_TYPE.Byte:this.AD=new i.default;break;case n.SDK_TYPE.WeChat:this.AD=new s.default;break;case n.SDK_TYPE.Oppo:this.AD=new l.default;break;case n.SDK_TYPE.ViVo:this.AD=new o.default;break;case n.SDK_TYPE.XiaoMi:this.AD=new r.default;break;case n.SDK_TYPE.HuaWei:this.AD=new c.default}}static share(e){this.AD.share(e)}static recorderStart(){this.AD.recorderStart()}static recorderStop(){this.AD.recorderStop()}static addShortcut(){this.AD.addShortcut()}static showBanner(){this.AD.showBanner()}static hideBanner(){this.AD.hideBanner()}static hideNativeBanner(){this.AD.hideNativeBanner()}static showNative(e){this.AD.showNative(e)}static hideNative(e){this.AD.hideNative(e)}static showInsert(){this.AD.showInsert()}static exitGame(){this.AD.exitGame()}static creatAD(){console.log("creatAD1111111111111111111111111111111111111"),this.AD.initAd()}static showToast(e){this.AD.showToast(e)}static showVideo(e,t,a){console.log("\u6fc0\u52b1\u89c6\u9891showvedio"),this.AD.showVideo(e,t,a)}static requestSubscribeSystemMessage(e){this.AD.requestSubscribeSystemMessage(e)}static onAddToFavorites(e){this.AD.onAddToFavorites(e)}},cc._RF.pop()},{"./AD/Byte/ByteAD":"ByteAD","./AD/HuaWei/HuaWeiAD":"HuaWeiAD","./AD/Oppo/OppoAD":"OppoAD","./AD/VIVO/VIVOAD":"VIVOAD","./AD/WeChat/WeChatAD":"WeChatAD","./AD/XiaoMi/XiaoMiAD":"XiaoMiAD","./ADManager":"ADManager"}],AudioManager:[function(e,t,a){"use strict";cc._RF.push(t,"6baff1kGdlJuIaZMEWCCwh3","AudioManager"),Object.defineProperty(a,"__esModule",{value:!0});const n=e("./BundleManager");class i{constructor(){this.audioMap={},this.muteBgm=!1,this.muteEffect=!1,this.bgmName=""}static get instance(){return this._instance||(this._instance=new i),this._instance}playMusic(e,t,a){if(this.muteBgm)return;let i;cc.audioEngine.stop(this.audioMap[this.bgmName]),null==t&&(t=!1),i=null!=a?a:1;let s=n.default.instance.getBundleRes("Audio",e,cc.AudioClip);this.audioMap[e]=cc.audioEngine.play(s,t,i),this.bgmName=e}playEffect(e,t=1,a,i,s=""){if(""==e)return;if(this.muteEffect)return;if(""!=s&&this.audioMap[e+s])return;null==i&&(i=!1);let l=n.default.instance.getBundleRes("Audio",e,cc.AudioClip);this.audioMap[e+s]=cc.audioEngine.play(l,i,t),a&&(this.pauseBgm(),cc.audioEngine.setFinishCallback(this.audioMap[e],()=>{this.resumeBgm()}))}pauseBgm(){cc.audioEngine.pause(this.audioMap[this.bgmName])}resumeBgm(){cc.audioEngine.resume(this.audioMap[this.bgmName])}stopAll(){cc.audioEngine.stopAll()}stopEffect(e){null!=this.audioMap[e]&&(cc.audioEngine.stop(this.audioMap[e]),delete this.audioMap[e])}pauseAll(){cc.audioEngine.pauseAll()}resumeAll(){cc.audioEngine.resumeAll()}}a.default=i,i._instance=null,cc._RF.pop()},{"./BundleManager":"BundleManager"}],Ball:[function(e,t,a){"use strict";cc._RF.push(t,"ad28cmsykRGYZvXWx/Xhd6Z","Ball");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const i=e("../ADlibs/Hts"),s=e("../ADManager/ADManager"),l=e("../Manager/BundleManager"),o=e("../Manager/DataManager"),r=e("../Manager/PlantMgr"),c=e("../Manager/UIManager"),d=e("../scene_stage/SceneStage"),h=e("../TaSdk/TaSdk"),u=e("../utils/MyUtils"),{ccclass:g}=cc._decorator;let p=class extends cc.Component{init(e){this.plantId=e,this.node.getComponentInChildren(sp.Skeleton).skeletonData=l.default.instance.getBundleRes("Spine","plant/"+r.default.instance().getPlant(this.plantId).dragonName+"/"+r.default.instance().getPlant(this.plantId).dragonName,sp.SkeletonData),this.node.getComponentInChildren(sp.Skeleton).setAnimation(0,"daiji",!0);let t=new cc.Vec2(u.MyUtils.getRandomInt(-800,0),440),a=new cc.Vec2(u.MyUtils.getRandomInt(-700,700),u.MyUtils.getRandomInt(-400,400)),n=new cc.Vec2(u.MyUtils.getRandomInt(-400,0),-440),i=new cc.Vec2(u.MyUtils.getRandomInt(-700,700),u.MyUtils.getRandomInt(-400,400)),s=new cc.Vec2(u.MyUtils.getRandomInt(0,800),500);this.node.setPosition(t),cc.tween(this.node).bezierTo(10,t,a,n).bezierTo(10,n,i,s).call(()=>{this.node.destroy()}).start(),h.default.instance.AdsExposure(h.VideoIndex.BallTry)}onClick(){if(o.default.instance.selectPlantID.includes(this.plantId))c.default.instance.showToast("\u5df2\u4f7f\u7528\u8be5\u690d\u7269!!!");else{h.default.instance.AdsButtonClick(h.VideoIndex.BallTry);let e=()=>{o.default.instance.selectPlantID.push(this.plantId),this.node.getChildByName("Circle").active=!1,this.node.getChildByName("video").active=!1,this.node.getChildByName("ballTitle").active=!1,o.default.instance.tryPlant.includes(this.plantId)||o.default.instance.tryPlant.push(this.plantId),d.default.instance.showDeck(!0);let e=d.default.instance.cardPanel.childrenCount;d.default.instance.cardPanel.children[e-1].active=!1,cc.Tween.stopAllByTarget(this.node),cc.tween(this.node).to(1,{x:d.default.instance.cardPanel.children[e-1].x-this.node.parent.x+d.default.instance.cardPanel.x,y:d.default.instance.cardPanel.children[e-1].y-this.node.parent.y+d.default.instance.cardPanel.y}).call(()=>{this.node.destroy(),d.default.instance.cardPanel.children[e-1].active=!0}).start(),i.default.instance.eventReport("\u6e38\u620f\u5185\u8bd5\u7528\u6c14\u7403\u89c6\u9891\u770b\u5b8c"),h.default.instance.AdsPlayRet(h.VideoIndex.BallTry,0)},t=()=>{i.default.instance.eventReport("\u6e38\u620f\u5185\u8bd5\u7528\u6c14\u7403\u89c6\u9891\u53d6\u6d88"),h.default.instance.AdsPlayRet(h.VideoIndex.BallTry,1)},a=()=>{i.default.instance.eventReport("\u6e38\u620f\u5185\u8bd5\u7528\u6c14\u7403\u89c6\u9891\u52a0\u8f7d\u5931\u8d25"),h.default.instance.AdsPlayRet(h.VideoIndex.BallTry,-1)};0!=o.default.instance.level?s.default.instance.showVideo(e,t,a):e()}}};p=n([g],p),a.default=p,cc._RF.pop()},{"../ADManager/ADManager":"ADManager","../ADlibs/Hts":"Hts","../Manager/BundleManager":"BundleManager","../Manager/DataManager":"DataManager","../Manager/PlantMgr":"PlantMgr","../Manager/UIManager":"UIManager","../TaSdk/TaSdk":"TaSdk","../scene_stage/SceneStage":"SceneStage","../utils/MyUtils":"MyUtils"}],BossSelectUI:[function(e,t,a){"use strict";cc._RF.push(t,"098be8EUP9LUb4P1jRGwwM3","BossSelectUI");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const i=e("../ADlibs/Hts"),s=e("../ADManager/ADManager"),l=e("../Manager/DataManager"),o=e("../Manager/UIManager"),r=e("../Manager/UserDataManager"),c=e("../TaSdk/TaSdk"),{ccclass:d,property:h}=cc._decorator;let u=class extends cc.Component{constructor(){super(...arguments),this.buttonList=null,this.gray=null,this.normal=null}onLoad(){r.default.instance.bossLevel.length<3&&c.default.instance.AdsExposure(c.VideoIndex.bossUnlock),this.initPlatform(),this.initPanel()}initPanel(){for(let e=0;e<3;e++)r.default.instance.bossLevel.includes(e+1)?(this.buttonList.children[e].getChildByName("Mask").active=!1,this.buttonList.children[e].getChildByName("video").active=!1,this.buttonList.children[e].getComponent(cc.Sprite).setMaterial(0,this.normal),this.buttonList.children[e].children[0].getComponent(cc.Sprite).setMaterial(0,this.normal)):(this.buttonList.children[e].getChildByName("Mask").active=!0,this.buttonList.children[e].getChildByName("video").active=!0,this.buttonList.children[e].getComponent(cc.Sprite).setMaterial(0,this.gray),this.buttonList.children[e].children[0].getComponent(cc.Sprite).setMaterial(0,this.gray))}initPlatform(){switch(s.default.instance.sdkType){case s.SDK_TYPE.WeChat:s.default.instance.hideNative(0),s.default.instance.showNative(1),s.default.instance.showNative(2),s.default.instance.showNative(3)}}onClickVideo(e,t){let a=parseInt(t);c.default.instance.AdsButtonClick(c.VideoIndex.bossUnlock),s.default.instance.showVideo(()=>{r.default.instance.setbossLevel(a),this.initPanel(),i.default.instance.eventReport("\u89e3\u9501Boss\u96be\u5ea6\u89c6\u9891\u770b\u5b8c"),c.default.instance.AdsPlayRet(c.VideoIndex.bossUnlock,0)},()=>{i.default.instance.eventReport("\u89e3\u9501Boss\u96be\u5ea6\u89c6\u9891\u53d6\u6d88"),c.default.instance.AdsPlayRet(c.VideoIndex.bossUnlock,1)},()=>{i.default.instance.eventReport("\u89e3\u9501Boss\u96be\u5ea6\u89c6\u9891\u52a0\u8f7d\u5931\u8d25"),c.default.instance.AdsPlayRet(c.VideoIndex.bossUnlock,-1)})}onClickStart(e){l.default.instance.bossLevel=parseInt(e.currentTarget.name),l.default.instance.level=20,o.default.instance.openUI("BossUI"),o.default.instance.closeUI("MenuUI"),o.default.instance.closeUI("BossSelectUI")}onClickClose(){o.default.instance.closeUI("BossSelectUI")}onDestroy(){s.default.instance.showNative(0),s.default.instance.hideNative(1),s.default.instance.hideNative(2),s.default.instance.hideNative(3)}};n([h(cc.Node)],u.prototype,"buttonList",void 0),n([h(cc.Material)],u.prototype,"gray",void 0),n([h(cc.Material)],u.prototype,"normal",void 0),u=n([d],u),a.default=u,cc._RF.pop()},{"../ADManager/ADManager":"ADManager","../ADlibs/Hts":"Hts","../Manager/DataManager":"DataManager","../Manager/UIManager":"UIManager","../Manager/UserDataManager":"UserDataManager","../TaSdk/TaSdk":"TaSdk"}],BossUI:[function(e,t,a){"use strict";cc._RF.push(t,"1c7deovBx9A2IdVdF+8yasi","BossUI");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const i=e("../ADlibs/Hts"),s=e("../entity/Boss"),l=e("../Manager/AudioManager"),o=e("../Manager/DataManager"),r=e("../Manager/UIManager"),c=e("../Manager/UserDataManager"),d=e("../Manager/ZombieMgr"),h=e("../scene_stage/SceneStage"),u=e("../TaSdk/TaSdk"),g=e("../utils/kc"),{ccclass:p,property:f}=cc._decorator;let m=class extends h.default{onLoad(){u.default.instance.postEvent("System",{system:"Boss\u5173"}),super.onLoad(),this.hpProgress=this.node.getChildByName("HpProgress"),this.hpProgress.active=!1}play(){let e=cc.find("Canvas/Bg").width*cc.find("Canvas/Bg").scaleX/2-g.default.view_x;this.node.getChildByName("PauseBtn").active=!1,cc.tween(cc.find("Canvas/Main Camera")).by(e/200,{x:e}).delay(1).by(e/200,{x:-e}).call(()=>{this.showPlantDeck(),d.default.instance().init(this),d.default.instance().play(),s.default.instance.play(),this.goldNums=3e3+o.default.instance.extraGold,this.node.getChildByName("PauseBtn").active=!0,this.node.getChildByName("Gold").active=!0,this.node.getChildByName("shovelPanel").active=!0,this.boss=this.node.getChildByName("groud").getChildByName("Boss").getComponent(sp.Skeleton),this.boss.node.x=720,this.boss.setAnimation(0,"1ruchang",!1),this.boss.setCompleteListener(()=>{this.boss.setCompleteListener(null),this.boss.setAnimation(0,"1daiji",!0)}),this.node.getChildByName("Begin").active=!0,this.node.getChildByName("Begin").scale=2;let e=this.node.getChildByName("Begin").getComponent(sp.Skeleton).setAnimation(0,"boss",!1);this.node.getChildByName("Begin").getComponent(sp.Skeleton).setTrackEventListener(e,(e,t)=>{"boss"==t.data.name&&l.default.instance.playEffect("boss")}),this.hpProgress.active=!0,this.initPlatform(),this.schedule(()=>{this.generateGold()},15)}).start()}showProgress(e){s.default.instance.hp>0?this.hpProgress.getComponent(cc.ProgressBar).progress=s.default.instance.hp/s.default.instance.allHp+.02:this.hpProgress.getComponent(cc.ProgressBar).progress=0}lose(){u.default.instance.postEvent("level",{level:20,is_Win:0}),i.default.instance.eventReport("\u7b2c"+c.default.instance.chapter+"\u5468\u76ee\u7b2c"+o.default.instance.bossLevel+"\u7ea7Boss\u5173\u5931\u8d25"),r.default.instance.closeUI("BossUI"),r.default.instance.openUI("FailUI")}win(){u.default.instance.postEvent("level",{level:20,is_Win:1}),this.scheduleOnce(()=>{i.default.instance.eventReport("\u7b2c"+c.default.instance.chapter+"\u5468\u76ee\u7b2c"+o.default.instance.bossLevel+"\u7ea7Boss\u5173\u6210\u529f"),r.default.instance.closeUI("BossUI"),r.default.instance.openUI("SuccessUI")},3)}};m=n([p],m),a.default=m,cc._RF.pop()},{"../ADlibs/Hts":"Hts","../Manager/AudioManager":"AudioManager","../Manager/DataManager":"DataManager","../Manager/UIManager":"UIManager","../Manager/UserDataManager":"UserDataManager","../Manager/ZombieMgr":"ZombieMgr","../TaSdk/TaSdk":"TaSdk","../entity/Boss":"Boss","../scene_stage/SceneStage":"SceneStage","../utils/kc":"kc"}],Boss:[function(e,t,a){"use strict";cc._RF.push(t,"6452f08JOxE5IlHSnOI4BWV","Boss");var n,i=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const s=e("../Manager/BulletMgr"),l=e("../Manager/DataManager"),o=e("../Manager/UserDataManager"),r=e("../Manager/ZombieMgr"),c=e("../utils/KDefine"),d=e("../utils/MyUtils"),h=e("../utils/StateComponent"),u=e("../view/BossUI"),g=e("./Plant/PlantBase"),{ccclass:p,property:f}=cc._decorator;let m=n=class extends h.default{constructor(){super(...arguments),this.zombieID=12,this.cd=10,this.aniName={dead:"2baozha",daiji:"1daiji",forward:"1ruchang",hurtForward:"2ruchang",hurtdaiji:"2daiji",attackDaiji2:"1daij2",hurtAttackDaiji2:"2daij2",skillFire:"1gongji",hurtSkillFire:"2gongji",back:"1houchebu",hurtBack:"2houchebu",down:"1ruchang2",hurtDown:"2ruchang2",up:"1chuhua",hurtUp:"2chuhua",start:"1ruchang",zhaohuan1:"1zhaohuan1",zhaohuan2:"1zhaohuan2",zhaohuan3:"1zhaohuan3",zhaohuan4:"1zhaohuan4",zhaohuan5:"1zhaohuan5",hurtZhaohuan1:"2zhaohuan1",hurtZhaohuan2:"2zhaohuan2",hurtZhaohuan3:"2zhaohuan3",hurtZhaohuan4:"2zhaohuan4",hurtZhaohuan5:"2zhaohuan5"},this.firePos=[0,100,200,300],this.normalPos=-45,this.index=0}static get instance(){return this._instance}onLoad(){n._instance=this,0!=l.default.instance.level&&(this.node.zIndex=c.ZIndex.boss),1==l.default.instance.bossLevel?this.zombieID=1:this.zombieID=12,this.setHp(),this.setCD()}addBoss(){for(let e=0;e<l.default.instance.row;e++)r.default.instance().zombieInRow[e].add(this);r.default.instance().zombieSet.add(this)}setCD(){switch(l.default.instance.bossLevel){case 1:case 2:this.cd=10;break;case 3:this.cd=5}}setHp(){switch(l.default.instance.bossLevel){case 1:this.allHp=4e3*o.default.instance.chapter;break;case 2:this.allHp=2e4*o.default.instance.chapter;break;case 3:this.allHp=4e4*o.default.instance.chapter;break;default:this.allHp=9999999}this.hp=this.allHp}play(){for(let e=0;e<l.default.instance.row;e++)r.default.instance().zombieInRow[e].add(this);r.default.instance().zombieSet.add(this),r.default.instance().zombieNums++,this.scheduleOnce(()=>{this.attack()},10)}get hp(){return this._hp}set hp(e){this._hp=e}hurt(e,t,a){if(0!=l.default.instance.level&&0!=this.hp){if(""!=t){let e=s.default.instance().getEffect(t);e.scale=a,e.parent=this.node,e.x=0,e.y=0;let n=e.getComponent(sp.Skeleton);n.setAnimation(0,"newAnimation",!1),n.setCompleteListener(()=>{e.scale=1,s.default.instance().removeEffect(e)})}if(this.hp-=e,u.default.instance.showProgress(null),this.hp<=0){this.hp=0,this.unscheduleAllCallbacks(),r.default.instance().zombieNums--,r.default.instance().zombieSet.delete(this),this.playAnimation("2baozha",!1);let e=[...r.default.instance().zombieSet.values()].length;for(let t=0;t<e;t++)[...r.default.instance().zombieSet.values()][t]&&[...r.default.instance().zombieSet.values()][t].hurt(9999);r.default.instance().stop(),this.node.getComponent(sp.Skeleton).setCompleteListener(()=>{u.default.instance.win()})}}}attack(){3==this.index?this.scheduleOnce(()=>{this.skillFire()},this.cd):this.scheduleOnce(()=>{this.skillZhaohuan()},this.cd),this.index++,this.index=this.index%4}skillFire(e){this.back(),this.node.getComponent(sp.Skeleton).setCompleteListener(()=>{let t=d.MyUtils.getRandomInt(0,4);this.node.y=this.firePos[t],this.node.getComponent(sp.Skeleton).setCompleteListener(()=>{this.attackDaiji(),this.clearAniEvent(),this.scheduleOnce(()=>{this.node.getComponent(sp.Skeleton).setCompleteListener(()=>{this.clearAniEvent(),this.attackDaiji(),this.scheduleOnce(()=>{this.node.getComponent(sp.Skeleton).setCompleteListener(()=>{this.node.y=this.normalPos,this.node.getComponent(sp.Skeleton).setCompleteListener(()=>{this.clearAniEvent(),this.daiji()}),this.forward()}),this.up()},8)}),this.scheduleOnce(()=>{for(let a=0;a<l.default.instance.row;a++)for(let n=0;n<l.default.instance.col;n++){let i=l.default.instance.blockArr[a][n][1];i&&(i.getComponent(g.default).row==t||i.getComponent(g.default).row==t+1||e)&&i.getComponent(g.default).hurt(500)}},.5),this.fire()},8)}),this.down()})}skillZhaohuan(){let e=d.MyUtils.getRandomInt(1,6);this.zhaohuan(6-e),this.scheduleOnce(()=>{let t=cc.v2(300,l.default.instance.groudYArr[e-1]);r.default.instance().showItem(this.zombieID,t,e-1)},.5),this.node.getComponent(sp.Skeleton).setCompleteListener(()=>{this.clearAniEvent(),this.daiji()})}clearAniEvent(){this.node.getComponent(sp.Skeleton).setCompleteListener(null)}zhaohuan(e){this.playAnimation(this.aniName["zhaohuan"+e])}back(){this.playAnimation(this.aniName.back)}forward(){this.playAnimation(this.aniName.forward)}up(){this.playAnimation(this.aniName.up)}down(){this.playAnimation(this.aniName.down)}daiji(){this.node.getComponent(sp.Skeleton).setAnimation(0,this.aniName.daiji,!0),0!=l.default.instance.level&&this.attack()}attackDaiji(){this.node.getComponent(sp.Skeleton).setAnimation(0,this.aniName.attackDaiji2,!0)}fire(){this.node.getComponent(sp.Skeleton).setAnimation(0,this.aniName.skillFire,!1)}playAnimation(e,t=!1){this.node.getComponent(sp.Skeleton).setAnimation(0,e,t)}};m._instance=null,m=n=i([p],m),a.default=m,cc._RF.pop()},{"../Manager/BulletMgr":"BulletMgr","../Manager/DataManager":"DataManager","../Manager/UserDataManager":"UserDataManager","../Manager/ZombieMgr":"ZombieMgr","../utils/KDefine":"KDefine","../utils/MyUtils":"MyUtils","../utils/StateComponent":"StateComponent","../view/BossUI":"BossUI","./Plant/PlantBase":"PlantBase"}],BulletBase:[function(e,t,a){"use strict";cc._RF.push(t,"9ae53A239lIOJsSCQU/xChD","BulletBase");var n,i=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const s=e("../../utils/KDefine"),l=e("../../Manager/BulletMgr"),o=e("../Zombie/Zombie"),r=e("../../Manager/BundleManager"),c=e("../../Manager/AudioManager"),d=e("../Boss"),{ccclass:h,property:u}=cc._decorator;let g=n=class extends cc.Component{constructor(){super(...arguments),this.damage=1,this.inUse=!1}reset(e,t,a,n){return this.hitSound=a,this.volume=n,this.id=parseFloat(t),this.type=l.default.instance().allItemArr[this.id].type,this.node.scale=l.default.instance().allItemArr[this.id].scale,this.bulletEffect=l.default.instance().allItemArr[this.id].bulletEffect,1==this.type?(this.node.addComponent(cc.Sprite).spriteFrame=r.default.instance.getBundleRes("BundleTexture","Bullet/"+l.default.instance().allItemArr[this.id].bullet,cc.SpriteFrame),this.node.getComponent(cc.Sprite).type=cc.Sprite.Type.SLICED):(this.node.addComponent(sp.Skeleton).skeletonData=r.default.instance.getBundleRes("Spine","bullet/"+l.default.instance().allItemArr[this.id].bullet+"/"+l.default.instance().allItemArr[this.id].bullet,sp.SkeletonData),this.node.getComponent(sp.Skeleton).animation="newAnimation",this.node.getComponent(sp.Skeleton).loop=!0),this.inUse=!0,this.node.opacity=0,this.radius=l.default.instance().allItemArr[this.id].radius,this.node.getComponent(cc.CircleCollider).radius=this.radius,this.effectScale=l.default.instance().allItemArr[this.id].effectScale,this.node.getChildByName("bulletEffect").scale=this.effectScale,e&&(this.damage=e),this}unuse(){this.inUse=!1}reuse(){this.inUse=!0}onHit(e,t){switch(this.id){case 12:case 13:case 14:case 15:case 24:t?e.hurt(this.damage):e.hurt(this.damage,"",this.effectScale);break;case 19:case 20:case 21:t?e.hurt(this.damage):(e.frozen(),e.hurt(this.damage,"",this.effectScale));break;default:if(cc.Tween.stopAllByTarget(this.node),t){e.hurt(this.damage);let t=this.node.getChildByName("bulletEffect").getComponent(sp.Skeleton);this.node.getChildByName("bulletEffect").active=!0,1==this.type?this.node.getComponent(cc.Sprite).enabled=!1:this.node.getComponent(sp.Skeleton).enabled=!1,t.skeletonData=r.default.instance.getBundleRes("Spine","effect/"+this.node.getComponent(n).bulletEffect+"/"+this.node.getComponent(n).bulletEffect,sp.SkeletonData),t.setAnimation(0,"newAnimation",!1),t.setCompleteListener(()=>{this.node.getChildByName("bulletEffect").active=!1,l.default.instance().removeBullet(this.node.getComponent(n)),t.setCompleteListener(null)})}else e.hurt(this.damage,this.bulletEffect,this.effectScale),l.default.instance().removeBullet(this)}c.default.instance.playEffect(this.hitSound,this.volume)}onHitBoss(e){}onCollisionEnter(e,t){if(this.inUse)if(e.tag===s.Tag.zombie){const t=e.node.getComponent(o.default);if(!t.inUse)return;this.onHit(t)}else e.tag!=s.Tag.bossLeg&&e.tag!=s.Tag.bossHead||(e.tag==s.Tag.bossLeg?this.damage=this.damage/5:(e.tag,s.Tag.bossHead),this.onHit(d.default.instance,!0))}onDestroy(){l.default.instance().removeFromPool(this.node)}};g=n=i([h],g),a.default=g,cc._RF.pop()},{"../../Manager/AudioManager":"AudioManager","../../Manager/BulletMgr":"BulletMgr","../../Manager/BundleManager":"BundleManager","../../utils/KDefine":"KDefine","../Boss":"Boss","../Zombie/Zombie":"Zombie"}],BulletMgr:[function(e,t,a){"use strict";cc._RF.push(t,"60618zc/ZFEwpDJw7gLjJ2V","BulletMgr"),Object.defineProperty(a,"__esModule",{value:!0});const n=e("../utils/kc"),i=e("../utils/KDefine"),s=e("../entity/Bullet/BulletBase"),l=e("./BundleManager"),o=e("./ExcelManager"),r=e("./DataManager");class c{constructor(){this.itemPoolSize=200,this.itemNode=null,this.bulletPool=new cc.NodePool,this.allItemArr={},this.hurtEffectPool=new cc.NodePool}static instance(){return c._me||(c._me=new c),c._me}init(){this.itemNode=cc.instantiate(l.default.instance.getBundleRes("Prefab","bullet/bullet_1")),this.allItemArr=o.ExcelMgr.instance.GetExcelObject(o.TableName.bulletTable);for(let e=0;e<this.itemPoolSize;e++)this.bulletPool.put(cc.instantiate(this.itemNode));for(let e=0;e<this.itemPoolSize;e++)this.hurtEffectPool.put(cc.instantiate(l.default.instance.getBundleRes("Prefab","effect/hurtEffect")));return this}createItem(){return cc.instantiate(this.itemNode)}getItem(e,t,a,i=1){let l=null;(l=this.bulletPool.get())||(n.default.log("BulletItemPool is empty"),l=this.createItem());const o=l.getComponent(s.default);return o.reset(t,e,a,i),o}getEffect(e){let t=null;return(t=this.hurtEffectPool.get())||(t=cc.instantiate(l.default.instance.getBundleRes("Prefab","effect/hurtEffect"))),t.getComponent(sp.Skeleton).skeletonData=l.default.instance.getBundleRes("Spine","effect/"+e+"/"+e,sp.SkeletonData),t.opacity=255,t}removeEffect(e){e.getComponent(sp.Skeleton).skeletonData=null,this.hurtEffectPool.get(e)}removeBullet(e){e.inUse=!1,cc.Tween.stopAllByTarget(e.node),1==e.type?e.node.removeComponent(cc.Sprite):e.node.removeComponent(sp.Skeleton),e.node.angle=0,this.bulletPool.put(e.node)}removeFromPool(e){}static shoot_to_right(e,t,a,n,s=1,l=1,o,d){const h=c.instance().getItem(a,n,o,d),u=h.node;u.parent=e,u.zIndex=i.ZIndex.bullet,u.setPosition(t),cc.tween(u).call(()=>{u.opacity=255}).by((s+1)*r.default.instance.blockWidth/(600*l),{x:(s+1)*r.default.instance.blockWidth}).call(()=>{c.instance().removeBullet(h)}).start()}}a.default=c,c._me=null,cc._RF.pop()},{"../entity/Bullet/BulletBase":"BulletBase","../utils/KDefine":"KDefine","../utils/kc":"kc","./BundleManager":"BundleManager","./DataManager":"DataManager","./ExcelManager":"ExcelManager"}],BulletPool:[function(e,t,a){"use strict";cc._RF.push(t,"7459eN3i5lCWry0gRhPWhcb","BulletPool"),Object.defineProperty(a,"__esModule",{value:!0});const n=e("./kc");a.default=class{constructor(){this.unuseMap={},this.inuseMap={},this.outPosX=2*n.default.view_x+100*n.default.randomInt(0,10),this.outPosY=-5e3,this.outPosDist=100}put(e){return e.opacity=0,e.x=this.outPosX,this.outPosY+=this.outPosDist,e.y=this.outPosY,this.unuseMap[e.uuid]=e,this}back(e){return e.opacity=0,e.x=this.outPosX,this.outPosY+=this.outPosDist,e.y=this.outPosY,this.outPosY>5e3&&(this.outPosY=-5e3),this.unuseMap[e.uuid]=e,delete this.inuseMap[e.uuid],this}del(e){delete this.inuseMap[e.uuid],delete this.unuseMap[e.uuid]}get(){let e=null;for(const t in this.unuseMap){e=this.unuseMap[t],this.inuseMap[t]=e,delete this.unuseMap[t];break}return e}},cc._RF.pop()},{"./kc":"kc"}],BundleManager:[function(e,t,a){"use strict";cc._RF.push(t,"3026bssP2FJWbRbxRyqqMct","BundleManager");var n,i=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const{ccclass:s,property:l}=cc._decorator;let o=n=class extends cc.Component{static get instance(){return this._instance||(this._instance=new n),this._instance}loadBundle(e){return new Promise((t,a)=>{cc.assetManager.loadBundle(e,(n,i)=>{n?(console.warn("\u8d44\u6e90\u5305\u52a0\u8f7d\u5931\u8d25",n),a("\u8d44\u6e90\u5305"+e+"\u52a0\u8f7d\u5931\u8d25")):(console.log("\u8d44\u6e90\u5305"+e+"\u52a0\u8f7d\u6210\u529f"),t(i))})})}preLoadBundleDir(e,t,a,n,i){return new Promise((s,l)=>{this.getBundle(e).loadDir(t,a,(e,t)=>{n&&n(e,t)},(e,t)=>{e&&(console.warn("\u8d44\u6e90\u5305\u52a0\u8f7d\u5931\u8d25",e),l()),i&&i(e,t),s()})})}preload(e,t,a,n,i){this.getBundle(e).loadDir(t,a,(e,t)=>{n&&n(e,t)},(e,t)=>{e&&console.warn("\u8d44\u6e90\u5305\u52a0\u8f7d\u5931\u8d25",e),i&&i(e,t)})}loadBundleRes(e,t,a,n){this.getBundle(e).load(t,a,(e,t)=>{n&&n(e,t)})}getBundleRes(e,t,a){let n=this.getBundle(e).get(t,a);if(n)return n;this.loadBundleRes(e,t,a,()=>this.getBundleRes(e,t,a))}getBundle(e){let t=cc.assetManager.getBundle(e);return t||this.loadBundle(e).then(e=>e).catch(e=>{console.log(e)}),t}};o=n=i([s],o),a.default=o,cc._RF.pop()},{}],ByteAD:[function(e,t,a){"use strict";cc._RF.push(t,"ffbfcNJaEFDzqpXiRPGJJuo","ByteAD"),Object.defineProperty(a,"__esModule",{value:!0});const n=e("../../../ADlibs/Hts"),i=e("../../ADManager"),s=e("../Interface/ADInterface"),l=e("./ByteConstant");class o extends s.default{constructor(){super(...arguments),this.isToutiaio=!1,this.bannerAd=null,this.rewardVideoAd=null,this.insertIntervalTime=0,this.vedioIsEnd=!0,this.lastClickTime=0}showNative(){}initAd(){o.videoTime=0,this.createVideo()}createVideo(){console.log("createVideo1111:"),this.rewardVideoAd=tt.createRewardedVideoAd({adUnitId:l.default.POSID_VedioAD}),console.log("createVideo2222:")}exitGame(){tt.exitMiniProgram({isFullExit:!0})}addShortcut(){tt.addShortcut({success(){console.log("success")},fail(e){console.log("err===",e.errMsg),this.showToast("\u6dfb\u52a0\u684c\u9762\u5931\u8d25")}})}checkShortCut(){let e=this;tt.checkShortcut({success(t){!t.status.exist||t.status.needUpdate?e.canAddShortCut=!0:(this.showToast("\u5df2\u6dfb\u52a0\u81f3\u684c\u9762"),e.canAddShortCut=!1)},fail(t){e.canAddShortCut=!1,this.showToast("\u6dfb\u52a0\u684c\u9762\u5931\u8d25"),console.log("\u68c0\u67e5\u5feb\u6377\u65b9\u5f0f\u5931\u8d25",t.errMsg)}})}requestSubscribeSystemMessage(){throw new Error("Method not implemented.")}creatInsert(){this.insertAd=tt.createInterstitialAd({adUnitId:l.default.POSID_InsertAD}),this.log("creatInsert this.isToutiaio:"+this.isToutiaio)}canShowInsert(){let e=(new Date).getTime();if(!(e-i.default.instance.startTime<3e4))return e-this.insertIntervalTime<6e4?(console.log("\u63d2\u5c4f\u663e\u793a\u95f4\u9694\u65f6\u95f4\u4e0d\u8db3"),!1):(console.log("\u53ef\u4ee5\u663e\u793a\u63d2\u5c4f"),this.insertIntervalTime=(new Date).getTime(),!0);console.log("\u8fdb\u6e38\u620f\u65f6\u95f4\u4e0d\u8db3")}showInsert(){if(!this.canShowInsert())return;this.log("\u63d2\u5c4f\u5e7f\u544ashowInsert111222233");let e=this;this.creatInsert(),this.insertAd.load().then(()=>{e.insertAd.show(),e.log("\u63d2\u5c4f\u5e7f\u544a\u52a0\u8f7d\u5b8c\u6210\uff0c\u51c6\u5907\u5c55\u793a")}).catch(t=>{e.log("\u63d2\u5c4f\u5e7f\u544a\u5f02\u5e38:"+JSON.stringify(t)),e.insertAd&&(e.insertAd.destroy(),e.insertAd=null)}),this.insertAd.onError(function(t){e.log("\u5934\u6761\u63d2\u5c4f\u5e7f\u544a\u52a0\u8f7d\u51fa\u9519\uff1a "+JSON.stringify(t)),e.insertAd&&(e.insertAd.destroy(),e.insertAd=null)}),this.insertAd.onClose(function(t){e.log("\u5934\u6761\u63d2\u5c4f\u5e7f\u544a\u5173\u95ed:"+t),e.insertAd&&(e.insertAd.destroy(),e.insertAd=null)})}creatbanner(){let e=tt.getSystemInfoSync().windowHeight,t=tt.getSystemInfoSync().windowWidth;this.bannerAd=tt.createBannerAd({adUnitId:l.default.POSID_BannerAD,adIntervals:60,style:{width:170,left:(t-170)/2}}),console.log("hei===112221"),this.bannerAd.onResize(a=>{console.log("hei===",a.height),this.bannerAd.style.top=e-a.height+60,this.bannerAd.style.left=(t-a.width)/2}),this.bannerAd.onError(e=>{this.bannerAd=null,console.log("initBanner err1:"+e)})}showBanner(){null!=this.bannerAd&&null!=this.bannerAd||this.creatbanner(),this.log("banner\u5e7f\u544a 4444422212222"),this.bannerAd.onLoad(()=>{this.bannerAd.show().then(()=>{console.log("banner\u52a0\u8f7d\u6210\u529f")}).catch(e=>{this.bannerAd=null,console.log("showBanner err:"+JSON.stringify(e))})})}hideBanner(){console.log("hideBanner"),null!=this.bannerAd&&(this.bannerAd.destroy(),this.bannerAd=null)}destroyBanner(){null!=this.bannerAd&&this.bannerAd.destroy()}vedioEnd(){return this.vedioIsEnd}recorderStart(){console.log("\u5f55\u5c4f===="),tt.getGameRecorderManager().onStart(function(){console.log("\u5f55\u5c4f\u5f00\u59cb"),l.default.startRecorderTime=(new Date).getTime()}),tt.getGameRecorderManager().start({duration:300})}recorderStop(){this.log("recorderStop"),tt.getGameRecorderManager().onStop(function(e){l.default.video_path=e.videoPath,l.default.endRecorderTime=(new Date).getTime(),console.log("1111==",l.default.endRecorderTime-l.default.startRecorderTime),l.default.endRecorderTime,l.default.startRecorderTime}),this.log("\u505c\u6b62\u5f55\u5c4f"),tt.getGameRecorderManager().stop()}share(e){let t=this;tt.shareAppMessage({channel:"video",title:l.default.title,imageUrl:"",query:"",extra:{videoPath:l.default.video_path,videoTopics:l.default.videoTopics},success:function(){e&&e(),t.showToast("\u5206\u4eab\u6210\u529f")},fail:function(e){t.showToast("\u5206\u4eab\u89c6\u9891\u5931\u8d25"),n.default.instance.eventReport("\u5206\u4eab\u53d6\u6d88"),t.log(e)}})}isFastClick(){return 0!==this.lastClickTime&&(new Date).getTime()-this.lastClickTime<2e3||(this.lastClickTime=(new Date).getTime(),!1)}showVideo(e,t,a){if(this.isFastClick())return;null!=this.rewardVideoAd&&null!=this.rewardVideoAd||this.createVideo(),console.log("showvideo====112"),this.insertIntervalTime=(new Date).getTime(),this.rewardVideoAd.show().then(()=>{cc.game.pause()}).catch(e=>{cc.game.resume(),console.log("\u5e7f\u544a\u7ec4\u4ef6\u51fa\u73b0\u95ee\u9898",e),a&&a()}),this.rewardVideoAd.onError(()=>{a&&a(),cc.game.resume()});let n=a=>{console.log("res==112",a),a&&a.isEnded||void 0===a?(cc.game.resume(),e&&e(),this.showToast("\u5956\u52b1\u9886\u53d6\u6210\u529f")):(this.showToast("\u64ad\u653e\u4e2d\u9014\u9000\u51fa"),t&&t(),cc.game.resume()),this.rewardVideoAd.offClose(n),this.insertIntervalTime=(new Date).getTime()};this.rewardVideoAd.onClose(n),this.rewardVideoAd.offError(),this.rewardVideoAd.load()}showToast(e){tt.showToast({title:e})}log(e){console.log("byteAD:"+e)}}a.default=o,cc._RF.pop()},{"../../../ADlibs/Hts":"Hts","../../ADManager":"ADManager","../Interface/ADInterface":"ADInterface","./ByteConstant":"ByteConstant"}],ByteConstant:[function(e,t,a){"use strict";cc._RF.push(t,"9b1f9SQXbNJdKJTVzqXekpH","ByteConstant"),Object.defineProperty(a,"__esModule",{value:!0});class n{}a.default=n,n.POSID_BannerAD="4b88i97gcc0gcbslkr",n.POSID_InsertAD="3b2i9bb1qk74rejk3o",n.POSID_VedioAD="1qwncl4bn161b83a44",n.appId="tt7f37098ae009676002",n.video_path="",n.title="\u5a18\u5316\u690d\u7269\uff0c\u706b\u70ed\u51fa\u51fb",n.videoTopics=["\u690d\u7269\u5927\u6218\u50f5\u5c382\u8fdb\u5316","\u690d\u7269\u5927\u6218\u50f5\u5c38","\u7ecf\u5178\u6e38\u620f","\u5a18\u5316"],n.resultInster=0,n.gameBanner=0,n.tryPanel=0,cc._RF.pop()},{}],CSVParser:[function(e,t,a){"use strict";cc._RF.push(t,"24904RZnUZPR4MUj4ajDMTp","CSVParser"),Object.defineProperty(a,"__esModule",{value:!0});var n=[",",";","\t","|","^"],i=["\r\n","\r","\n"],s=function(e,t,a,n){if(a instanceof Array){if("number"===a[t])return Number(n[t]);if("boolean"===a[t])return"true"===n[t]||"t"===n[t]||"1"===n[t];if("string[]"===a[t])return n[t].split(",");if("number[]"===a[t])return n[t].split(",").map(Number);if("number[][]"===a[t]){let e=n[t].replace(/\[/g,"").replace(/\]/g,"");return e=e.split(",").map(Number),e=l(e)}if("string[][]"===a[t]){let e=n[t].replace(/\[/g,"").replace(/\]/g,"").split(",");return e=l(e)}if("number[][][]"===a[t]){let e=n[t].split("-");return e=o(e,!0)}return n[t]}return isNaN(Number(e))?"false"==e||"true"==e||"t"==e||"f"==e?"true"===n[t]||"t"===n[t]||"1"===n[t]:n[t]:Number(n[t])};let l=function(e,t=2){let a=e.length,n=a%t==0?a/t:Math.floor(a/t+1),i=[];for(let s=0;s<n;s++){let a=e.slice(s*t,s*t+t);i.push(a)}return i},o=function(e,t=!1){let a=[];for(let n=0;n<e.length;n++)e[n]=e[n].replace(/\[/g,"").replace(/\]/g,"").split(","),t&&(e[n]=e[n].map(Number)),e[n]=l(e[n]),a.push(e[n]);return a};var r={STANDARD_DECODE_OPTS:{skip:0,limit:!1,header:!1,cast:!1,comment:""},STANDARD_ENCODE_OPTS:{delimiter:n[0],newline:i[0],skip:0,limit:!1,header:!1},quoteMark:'"',doubleQuoteMark:'""',quoteRegex:/"/g,assign:function(){for(var e=Array.prototype.slice.call(arguments),t=e[0],a=e.slice(1),n=0,i=a.length;n<i;n++)for(var s in a[n])t[s]=a[n][s];return t},map:function(e,t){for(var a=[],n=0,i=e.length;n<i;n++)a[n]=t(e[n],n);return a},getType:function(e){return Object.prototype.toString.call(e).slice(8,-1)},getLimit:function(e,t){return!1===e?t:e},buildObjectConstructor:function(e,t,a){return function(n){var i=new Object,l=function(e,t){return i[e]=t};return a?e.forEach(function(e,i){l(e,s(t[i],i,a,n))}):e.forEach(function(e,a){l(e,s(t[a],a,null,n))}),i}},buildArrayConstructor:function(e,t,a){return function(n){var i=new Array(t.length),l=function(e,t){return i[e]=t};return a?e.forEach(function(e,i){l(e,s(t[i],i,a,n))}):e.forEach(function(e,a){l(e,s(t[a],a,null,n))}),i}},frequency:function(e,t,a){void 0===a&&(a=!1);for(var n=0,i=0,s=this.getLimit(a,e.length);i<s&&-1!==(i=e.indexOf(t,i));)i+=1,n++;return n},mostFrequent:function(e,t,a){for(var n,i=t.length-1;i>=0;i--)this.frequency(e,t[i],a)>0&&(n=t[i]);return n||t[0]},unsafeParse:function(e,t,a){var n,i,s=e.split(t.newline);function l(e){var a=e.shift();if(a.indexOf('"')>=0){for(var n=0,i=0,s=0;e.length>0&&(-1!==(n=a.indexOf('"',i))||s%2!=0);)-1!==n?(i=n+1,s++):a=a+t.newline+e.shift();var l,o=[],r=0,c=0,d=0,h=a.length;for(var u in a){if(!a.hasOwnProperty(u))continue;let e=parseInt(u);var g=a[u];0===e&&'"'===g&&(r++,c=1),'"'===g&&(r++,a[e-1]===t.delimiter&&c===e&&c++),'"'===g&&r%2==0&&(a[e+1]!==t.delimiter&&e+1!==h||(d=e,l=a.substring(c,d),o.push(l),d=c=d+2)),g===t.delimiter&&r%2==0&&((d=e)>c?(l=a.substring(c,d),o.push(l),d=c=d+1):d===c&&(o.push(""),d=c=d+1))}return(d=h)>=c&&(l=a.substring(c,d),o.push(l)),o}return a.split(t.delimiter)}for(t.skip>0&&s.splice(t.skip),t.header?(!0===t.header?(t.comment=l(s),t.cast=l(s),n=l(s)):"Array"===this.getType(t.header)&&(n=t.header),i=this.buildObjectConstructor(n,s[0].split(t.delimiter),t.cast)):i=this.buildArrayConstructor(n,s[0].split(t.delimiter),t.cast);s.length>0;){var o=l(s);o.length>1&&a(i(o),n[0])}return!0},safeParse:function(e,t){t.delimiter;var a=t.newline,n=e.split(a);return t.skip>0&&n.splice(t.skip),!0},encodeCells:function(e,t,a){for(var n=e.slice(0),i=0,s=n.length;i<s;i++)-1!==n[i].indexOf(this.quoteMark)&&(n[i]=n[i].replace(this.quoteRegex,this.doubleQuoteMark)),-1===n[i].indexOf(t)&&-1===n[i].indexOf(a)||(n[i]=this.quoteMark+n[i]+this.quoteMark);return n.join(t)},encodeArrays:function(e,t,a){var n=t.delimiter,i=t.newline;t.header&&"Array"===this.getType(t.header)&&a(this.encodeCells(t.header,n,i));for(var s=0,l=this.getLimit(t.limit,e.length);s<l;s++)a(this.encodeCells(e[s],n,i));return!0},encodeObjects:function(e,t,a){var n,i,s=t.delimiter,l=t.newline;for(var o in n=[],i=[],e[0])n.push(o),i.push(e[0][o]);!0===t.header?a(this.encodeCells(n,s,l)):"Array"===this.getType(t.header)&&a(this.encodeCells(t.header,s,l)),a(this.encodeCells(i,s));for(var r=1,c=this.getLimit(t.limit,e.length);r<c;r++){i=[];for(var d=0,h=n.length;d<h;d++)i.push(e[r][n[d]]);a(this.encodeCells(i,s,l))}return!0},parse:function(e,t,a){var s;if("Function"===this.getType(t)?(a=t,t={}):"Function"!==this.getType(a)?a=(s=[]).push.bind(s):s=[],t=this.assign({},this.STANDARD_DECODE_OPTS,t),this.opts=t,!t.delimiter||!t.newline){var l=Math.min(48,Math.floor(e.length/20),e.length);t.delimiter=t.delimiter||this.mostFrequent(e,n,l),t.newline=t.newline||this.mostFrequent(e,i,l)}return this.unsafeParse(e,t,a)&&(!(s.length>0)||s)},encode:function(e,t,a){var n;return"Function"===this.getType(t)?(a=t,t={}):"Function"!==this.getType(a)&&(a=(n=[]).push.bind(n)),(t=this.assign({},this.STANDARD_ENCODE_OPTS,t)).skip>0&&(e=e.slice(t.skip)),("Array"===this.getType(e[0])?this.encodeArrays:this.encodeObjects)(e,t,a)&&(!(n.length>0)||n.join(t.newline))}};a.default=r,cc._RF.pop()},{}],CardMgr:[function(e,t,a){"use strict";cc._RF.push(t,"313dcLjOLRNA7w/+q8vLdvq","CardMgr"),Object.defineProperty(a,"__esModule",{value:!0});class n{static instance(){return n._me||(n._me=new n),n._me}}a.default=n,n._me=null,cc._RF.pop()},{}],Card:[function(e,t,a){"use strict";cc._RF.push(t,"b3fa31XLfhG4rBQE2mdiIbn","Card");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const i=e("../Manager/BundleManager"),s=e("../Manager/DataManager"),l=e("../Manager/PlantMgr"),o=e("../Manager/UserDataManager"),{ccclass:r,property:c}=cc._decorator;let d=class extends cc.Component{constructor(){super(...arguments),this.bg=null,this.icon=null,this.mask=null,this.costLabel=null,this.costMask=null,this.new=null,this.lock=!0,this.id=0,this.desc=null,this.name=null,this.level=0,this.isLock=!1}init(e){this.id=e,this.desc=l.default.instance().getPlant(e).desc,this.name=l.default.instance().getPlant(e).name,this.cd=l.default.instance().getPlant(e).cd[o.default.instance.getPlantLevel(this.id)-1][1],o.default.instance.plantLock.includes(this.id)||s.default.instance.tryPlant.includes(e)?(this.node.getChildByName("Lock").active=!1,this.lock=!1):(this.node.getChildByName("Lock").active=!0,this.lock=!0);const t=this.icon.getComponent(cc.Sprite);return t.spriteFrame=i.default.instance.getBundleRes("BundleTexture","PlantIcon/p_"+e,cc.SpriteFrame),t.sizeMode=cc.Sprite.SizeMode.RAW,t.trim=!1,this.costLabel.string=""+l.default.instance().getPlant(e).cost[o.default.instance.getPlantLevel(e)-1][1],this.rare=l.default.instance().getPlant(e).rare,this.bg.getComponent(cc.Sprite).spriteFrame=i.default.instance.getBundleRes("BundleTexture","ui/card_bg_"+this.rare,cc.SpriteFrame),this.mask.active=!1,this}showCD(){this.mask.active=!0,this.mask.getComponent(cc.Sprite).fillRange=1,cc.tween(this.mask.getComponent(cc.Sprite)).to(this.cd,{fillRange:0}).call(()=>{this.mask.active=!1}).start()}setId(e){this.id=e;const t=i.default.instance.getBundleRes("BundleTexture","PlantIcon/p_"+e,cc.SpriteFrame),a=this.icon.getComponent(cc.Sprite);return a.sizeMode=cc.Sprite.SizeMode.RAW,a.trim=!1,a.spriteFrame=t,this.costLabel.string=""+l.default.instance().getPlant(e).cost,this}};n([c(cc.Node)],d.prototype,"bg",void 0),n([c(cc.Node)],d.prototype,"icon",void 0),n([c(cc.Node)],d.prototype,"mask",void 0),n([c(cc.Label)],d.prototype,"costLabel",void 0),n([c(cc.Node)],d.prototype,"costMask",void 0),n([c(cc.Node)],d.prototype,"new",void 0),d=n([r],d),a.default=d,cc._RF.pop()},{"../Manager/BundleManager":"BundleManager","../Manager/DataManager":"DataManager","../Manager/PlantMgr":"PlantMgr","../Manager/UserDataManager":"UserDataManager"}],Car:[function(e,t,a){"use strict";cc._RF.push(t,"a860c5SEnVN+7AKv/0byX8e","Car");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const i=e("../Manager/AudioManager"),s=e("../Manager/DataManager"),l=e("../scene_stage/SceneStage"),o=e("../utils/KDefine"),{ccclass:r}=cc._decorator;let c=class extends cc.Component{constructor(){super(...arguments),this.isLaunch=!1}onCollisionEnter(e,t){this.isLaunch||(this.isLaunch=!0,l.default.instance.ballPlantID.length>=1&&l.default.instance.ballPlant<2&&l.default.instance.canCreateBall&&0!=s.default.instance.level&&2!=s.default.instance.level&&l.default.instance.createBall(),this.node.getChildByName("Effect").active=!0,this.node.getChildByName("Effect2").active=!0,this.node.getChildByName("Effect").getComponent(sp.Skeleton).setAnimation(0,"newAnimation1",!1),this.node.getChildByName("Effect2").getComponent(sp.Skeleton).setAnimation(0,"newAnimation1",!1),this.node.getChildByName("Effect").getComponent(sp.Skeleton).setCompleteListener(()=>{this.node.getChildByName("Effect").getComponent(sp.Skeleton).setCompleteListener(null),this.node.getChildByName("Effect").getComponent(sp.Skeleton).setAnimation(0,"newAnimation2",!0),this.scheduleOnce(()=>{this.node.getChildByName("Effect2").getComponent(sp.Skeleton).setAnimation(0,"newAnimation2",!0)},.05)}),i.default.instance.playEffect(o.AudioName.CarEff),cc.tween(this.node).to(3,{x:1070}).call(()=>{this.node.destroy()}).start())}};c=n([r],c),a.default=c,cc._RF.pop()},{"../Manager/AudioManager":"AudioManager","../Manager/DataManager":"DataManager","../scene_stage/SceneStage":"SceneStage","../utils/KDefine":"KDefine"}],ChipTipUI:[function(e,t,a){"use strict";cc._RF.push(t,"77788yJT5tGVbMsLtLS/Dlm","ChipTipUI");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const i=e("../ADManager/ADManager"),s=e("../Manager/UIManager"),{ccclass:l,property:o}=cc._decorator;let r=class extends cc.Component{onLoad(){i.default.instance.sdkType==i.SDK_TYPE.WeChat&&i.default.instance.showBanner()}onClickShop(){s.default.instance.openUI("ShopUI"),s.default.instance.closeUI("UpgradeUI"),s.default.instance.closeUI("ChipTipUI")}onClickDraw(){s.default.instance.openUI("DrawUI"),s.default.instance.closeUI("UpgradeUI"),s.default.instance.closeUI("ChipTipUI")}onClickCloseBtn(){s.default.instance.closeUI("ChipTipUI")}onDestroy(){i.default.instance.sdkType==i.SDK_TYPE.WeChat&&i.default.instance.hideBanner()}};r=n([l],r),a.default=r,cc._RF.pop()},{"../ADManager/ADManager":"ADManager","../Manager/UIManager":"UIManager"}],Common:[function(e,t,a){"use strict";cc._RF.push(t,"c72c1wLTCZG3a2qsoR2RJVK","Common"),Object.defineProperty(a,"__esModule",{value:!0});const n=e("./entity/Plant/Plant10"),i=e("./entity/Plant/Plant2"),s=e("./entity/Plant/Plant21"),l=e("./entity/Plant/Plant3"),o=e("./entity/Plant/Plant4"),r=e("./entity/Plant/Plant5"),c=e("./entity/Plant/Plant6"),d=e("./entity/Plant/Plant8"),h=e("./entity/Plant/Plant9"),u=e("./entity/Plant/PlantBase"),g=e("./entity/Zombie/Zombie"),p=e("./entity/Zombie/Zombie2");a.default=class{static addPlantComponent(e,t){switch(e){case 2:case 12:t.addComponent(i.default);break;case 3:case 13:t.addComponent(l.default);break;case 4:case 7:case 14:case 17:t.addComponent(o.default);break;case 5:case 15:t.addComponent(r.default);break;case 6:case 16:t.addComponent(c.default);break;case 8:case 18:t.addComponent(d.default);break;case 9:case 19:t.addComponent(h.default);break;case 10:case 20:t.addComponent(n.default);break;case 21:case 22:t.addComponent(s.default);break;default:t.addComponent(u.default)}}static addZombieComponent(e,t){switch(e){case 2:t.addComponent(p.default);break;default:t.addComponent(g.default)}}},cc._RF.pop()},{"./entity/Plant/Plant10":"Plant10","./entity/Plant/Plant2":"Plant2","./entity/Plant/Plant21":"Plant21","./entity/Plant/Plant3":"Plant3","./entity/Plant/Plant4":"Plant4","./entity/Plant/Plant5":"Plant5","./entity/Plant/Plant6":"Plant6","./entity/Plant/Plant8":"Plant8","./entity/Plant/Plant9":"Plant9","./entity/Plant/PlantBase":"PlantBase","./entity/Zombie/Zombie":"Zombie","./entity/Zombie/Zombie2":"Zombie2"}],DataManager:[function(e,t,a){"use strict";cc._RF.push(t,"bdc12r0tFtJYYDW5cddt+Ea","DataManager"),Object.defineProperty(a,"__esModule",{value:!0});const n=e("./ExcelManager"),i=e("./UserDataManager");class s{constructor(){this.row=5,this.col=9,this.groudStartPo=cc.v2(-360,-320),this.blockArr=new Array,this.blockWidth=80.5,this.blockHeight=93,this.groudYArr=new Array,this.selectPlantID=[],this.rare1Array=[],this.rare2Array=[],this.rare3Array=[],this.rare4Array=[],this.rare5Array=[],this.rareArray=[1,3,4,5],this.plantArray=[],this.newPlant=[],this.tryPlant=[],this.lockPlant=0,this.focus=!1,this.level=1,this.newChapter=!1,this.drawWeight1=[],this.drawWeight2=[],this.drawGuide=!1,this.bossGuide=!1,this.maxWeight1=0,this.maxWeight2=0,this.bossLevel=0,this.extraGold=0,this.maxPlantID=0,this.beforeLevel=1,this.rarePrice1=[0,0],this.rarePrice2=[0,0],this.rarePrice3=[0,0],this.rarePrice4=[0,0],this.rarePrice5=[0,0],this.rareColor=[cc.color(255,255,255,255),cc.color(163,233,15,255),cc.color(62,205,249,255),cc.color(202,110,243,255),cc.color(255,199,3,255)]}static get instance(){return this._instance||(this._instance=new s),this._instance}init(){this.initBlockPos(),this.initPlantArr(),this.initDrawWeight(),this.initPrice(),this.level=i.default.instance.level}initPrice(){this.rarePrice1[0]=n.ExcelMgr.instance.GetExcelObject(n.TableName.priceTable)[1].coinCost,this.rarePrice1[1]=n.ExcelMgr.instance.GetExcelObject(n.TableName.priceTable)[1].diamondCost,this.rarePrice3[0]=n.ExcelMgr.instance.GetExcelObject(n.TableName.priceTable)[2].coinCost,this.rarePrice3[1]=n.ExcelMgr.instance.GetExcelObject(n.TableName.priceTable)[2].diamondCost,this.rarePrice4[0]=n.ExcelMgr.instance.GetExcelObject(n.TableName.priceTable)[3].coinCost,this.rarePrice4[1]=n.ExcelMgr.instance.GetExcelObject(n.TableName.priceTable)[3].diamondCost,this.rarePrice5[0]=n.ExcelMgr.instance.GetExcelObject(n.TableName.priceTable)[4].coinCost,this.rarePrice5[1]=n.ExcelMgr.instance.GetExcelObject(n.TableName.priceTable)[4].diamondCost}initDrawWeight(){let e=n.ExcelMgr.instance.GetExcelObject(n.TableName.lotteryTable),t=Object.keys(e);for(let a=0;a<t.length;a++){let n=e[t[a]].weight1,i=e[t[a]].weight2;this.maxWeight1+=n,this.maxWeight2+=i,this.drawWeight1.push(this.maxWeight1),this.drawWeight2.push(this.maxWeight2)}}initPlantArr(){for(let e=0;e<n.ExcelMgr.instance.GetExcelArray(n.TableName.plantTable).length;e++)this.plantArray.push(n.ExcelMgr.instance.GetExcelArray(n.TableName.plantTable)[e].id);for(let e=0;e<this.plantArray.length;e++)switch(n.ExcelMgr.instance.GetExcelObject(n.TableName.plantTable)[this.plantArray[e]].rare){case 1:this.rare1Array.push(this.plantArray[e]);break;case 2:this.rare2Array.push(this.plantArray[e]);break;case 3:this.rare3Array.push(this.plantArray[e]);break;case 4:this.rare4Array.push(this.plantArray[e]);break;case 5:this.rare5Array.push(this.plantArray[e])}}initBlockPos(){for(let e=0;e<this.row;e++)for(let t=0;t<this.col;t++)this.blockArr[e]||(this.blockArr[e]=new Array),this.blockArr[e][t]=[cc.v2(this.groudStartPo.x+this.blockWidth*(t+.5),this.groudStartPo.y+this.blockHeight*(e+.5)),null];for(let e=0;e<this.blockArr.length;e++)this.groudYArr.push(this.blockArr[e][0][0].y+40);console.log("bl---",this.blockArr)}clearTempData(){0!=s.instance.maxPlantID&&(i.default.instance.setPlantLevel(s.instance.maxPlantID,s.instance.beforeLevel,!0),s.instance.beforeLevel=1,s.instance.maxPlantID=0),s.instance.tryPlant=[]}}a.default=s,s._instance=null,cc._RF.pop()},{"./ExcelManager":"ExcelManager","./UserDataManager":"UserDataManager"}],Debug:[function(e,t,a){"use strict";cc._RF.push(t,"0cbb0L37XxAQq6GhT7VVW4u","Debug");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(e,t)},function(e,t){function a(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}),s=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});var l=cc._decorator,o=l.ccclass,r=l.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bt1_label=null,t.isPause=!1,t}return i(t,e),t.prototype.pauseOrResume=function(){this.isPause?(cc.director.resume(),this.bt1_label.string="\u6682\u505c",this.isPause=!this.isPause):(cc.director.pause(),this.bt1_label.string="\u7ee7\u7eed",this.isPause=!this.isPause)},t.prototype.speedUp=function(){},t.prototype.speedDown=function(){},s([r(cc.Label)],t.prototype,"bt1_label",void 0),s([o],t)}(cc.Component);a.default=c,cc._RF.pop()},{}],DrawUI:[function(e,t,a){"use strict";cc._RF.push(t,"eb86fSBOapDuJkSlUKHmARO","DrawUI");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const i=e("../ADlibs/Hts"),s=e("../ADManager/AD/WeChat/WeChatConstant"),l=e("../ADManager/ADManager"),o=e("../Manager/AudioManager"),r=e("../Manager/DataManager"),c=e("../Manager/ExcelManager"),d=e("../Manager/UIManager"),h=e("../Manager/UserDataManager"),u=e("../TaSdk/TaSdk"),g=e("../utils/MyUtils"),p=e("./MenuUI"),f=e("./NoCoinUI"),m=e("./RewardUI"),{ccclass:y,property:C}=cc._decorator;let b=class extends cc.Component{constructor(){super(...arguments),this.btn1=null,this.btn2=null,this.btn3=null,this.btn4=null,this.ball=null,this.ball2=null,this.guidePanel=null,this.goldDraw=null,this.diamondDraw=null,this.canDraw=!0,this.guideString=["\u91d1\u5e01\u62bd\u5956\u5927\u6982\u7387\u5f97\u5230\u7a00\u6709\u690d\u7269\u788e\u7247","\u94bb\u77f3\u62bd\u5956\u4e0d\u4ec5\u80fd\u83b7\u5f97\u9ad8\u7ea7\u690d\u7269\u788e\u7247\uff0c\u8fd8\u6709\u6982\u7387\u5f97\u5230\u5b8c\u6574\u7684\u690d\u7269"],this.rewardArr=[],this.maxRare=0,this.highLight=null,this.guideFinger=null,this.guideStep=-1}onLoad(){u.default.instance.postEvent("System",{system:"\u690d\u7269\u5347\u7ea7"}),this.btn1.on(cc.Node.EventType.TOUCH_START,this.onClickStart,this),this.btn1.on(cc.Node.EventType.TOUCH_END,this.onClickEnd,this),this.btn1.on(cc.Node.EventType.TOUCH_CANCEL,this.onClickEnd,this),this.btn2.on(cc.Node.EventType.TOUCH_START,this.onClickStart,this),this.btn2.on(cc.Node.EventType.TOUCH_END,this.onClickEnd,this),this.btn2.on(cc.Node.EventType.TOUCH_CANCEL,this.onClickEnd,this),this.btn3.on(cc.Node.EventType.TOUCH_START,this.onClickStart,this),this.btn3.on(cc.Node.EventType.TOUCH_END,this.onClickEnd,this),this.btn3.on(cc.Node.EventType.TOUCH_CANCEL,this.onClickEnd,this),this.btn4.on(cc.Node.EventType.TOUCH_START,this.onClickStart,this),this.btn4.on(cc.Node.EventType.TOUCH_END,this.onClickEnd,this),this.btn4.on(cc.Node.EventType.TOUCH_CANCEL,this.onClickEnd,this),this.guidePanel.zIndex=99,this.initPlatform(),this.registerEvent()}registerEvent(){this.node.on("draw",this.draw,this),this.node.on("onClickCloseBtn",this.onClickCloseBtn,this)}showGuideToast(e){this.guidePanel.active=!0,this.guidePanel.getComponentInChildren(cc.Label).string=e}onClickStart(e){this.canDraw&&cc.tween(e.currentTarget).to(.15,{y:5}).start()}onClickEnd(e){this.canDraw&&(cc.Tween.stopAllByTarget(e.currentTarget),e.currentTarget.y=15,this.draw(e.currentTarget.name))}draw(e){switch(this.canDraw=!1,this.rewardArr=[],this.maxRare=0,e){case"btn1":if(h.default.instance.gold<2e3)return i.default.instance.eventReport("\u91d1\u5e01\u5355\u62bd\u5931\u8d25"),d.default.instance.openUI("NoCoinUI",50).getComponent(f.default).init(0),void(this.canDraw=!0);i.default.instance.eventReport("\u91d1\u5e01\u5355\u62bd\u6210\u529f"),u.default.instance.postEvent("Luckychest",{Type_chest:1,Type_num:1}),o.default.instance.playEffect("LotteryEff"),h.default.instance.gold-=2e3,this.getReward(0),this.goldAni();break;case"btn2":if(h.default.instance.gold<18e3)return this.canDraw=!0,i.default.instance.eventReport("\u91d1\u5e01\u5341\u8fde\u5931\u8d25"),void d.default.instance.openUI("NoCoinUI",50).getComponent(f.default).init(0);i.default.instance.eventReport("\u91d1\u5e01\u5341\u8fde\u6210\u529f"),u.default.instance.postEvent("Luckychest",{Type_chest:1,Type_num:10});for(let e=0;e<10;e++)this.getReward(0);o.default.instance.playEffect("LotteryEff"),h.default.instance.gold-=18e3,this.goldAni();break;case"btn3":if(h.default.instance.diamond<40)return this.canDraw=!0,d.default.instance.openUI("NoCoinUI",50).getComponent(f.default).init(1),void i.default.instance.eventReport("\u94bb\u77f3\u5355\u62bd\u5931\u8d25");i.default.instance.eventReport("\u94bb\u77f3\u5355\u62bd\u6210\u529f"),u.default.instance.postEvent("Luckychest",{Type_chest:2,Type_num:1}),h.default.instance.diamond-=40,o.default.instance.playEffect("LotteryEff"),r.default.instance.drawGuide?(this.rewardArr.push({rewardType:"a",rare:1,number:20,plantID:11}),this.maxRare=4,h.default.instance.setPlantChip(11,20)):this.getReward(1),this.diamondAni();break;case"btn4":if(h.default.instance.diamond<360)return this.canDraw=!0,d.default.instance.openUI("NoCoinUI",50).getComponent(f.default).init(1),void i.default.instance.eventReport("\u94bb\u77f3\u5341\u8fde\u5931\u8d25");i.default.instance.eventReport("\u94bb\u77f3\u5341\u8fde\u6210\u529f"),u.default.instance.postEvent("Luckychest",{Type_chest:2,Type_num:10}),o.default.instance.playEffect("LotteryEff"),h.default.instance.diamond-=360;for(let e=0;e<10;e++)this.getReward(1);this.diamondAni()}}goldAni(){this.goldDraw.setAnimation(0,"choujiang",!1);let e=this.maxRare;e>1&&e--,this.goldDraw.setCompleteListener(()=>{this.goldDraw.setAnimation(0,"chujiang"+e,!1),this.goldDraw.setCompleteListener(()=>{this.ball.active=!0,this.goldDraw.setCompleteListener(null),this.ball.getComponent(sp.Skeleton).setAnimation(0,"kaiqiu"+e,!1),this.goldDraw.setAnimation(0,"daiji",!0),this.ball.getComponent(sp.Skeleton).setCompleteListener(()=>{d.default.instance.openUI("RewardUI",30).getComponent(m.default).init(this.rewardArr),this.ball.getComponent(sp.Skeleton).setCompleteListener(null),this.ball.active=!1,this.canDraw=!0})})})}diamondAni(){this.diamondDraw.setAnimation(0,"choujiang",!1);let e=this.maxRare;e>1&&e--,this.diamondDraw.setCompleteListener(()=>{this.diamondDraw.setAnimation(0,"chujiang"+e,!1),this.diamondDraw.setCompleteListener(()=>{this.ball2.active=!0,this.diamondDraw.setCompleteListener(null),this.ball2.getComponent(sp.Skeleton).setAnimation(0,"kaiqiu"+e,!1),this.diamondDraw.setAnimation(0,"daiji",!0),this.ball2.getComponent(sp.Skeleton).setCompleteListener(()=>{d.default.instance.openUI("RewardUI",30).getComponent(m.default).init(this.rewardArr),this.ball2.getComponent(sp.Skeleton).setCompleteListener(null),this.ball2.active=!1,this.canDraw=!0})})})}getReward(e){let t,a,n=0,i={rewardType:"a",rare:0,number:0,plantID:0};for(0==e?(t=g.MyUtils.getRandomInt(1,r.default.instance.maxWeight1+1),a=r.default.instance.drawWeight1):(t=g.MyUtils.getRandomInt(1,r.default.instance.maxWeight2+1),a=r.default.instance.drawWeight2);t>a[n];)n++;n++,console.log("ran===",t),i.rewardType=c.ExcelMgr.instance.GetExcelObject(c.TableName.lotteryTable)[n].rewardType,i.rare=c.ExcelMgr.instance.GetExcelObject(c.TableName.lotteryTable)[n].rare,i.rare>this.maxRare&&(this.maxRare=i.rare);let s=g.MyUtils.getRandomInt(c.ExcelMgr.instance.GetExcelObject(c.TableName.lotteryTable)[n].rewardNumber[0],c.ExcelMgr.instance.GetExcelObject(c.TableName.lotteryTable)[n].rewardNumber[1]+1);i.number=s;let l=g.MyUtils.getArrRandomValue(r.default.instance["rare"+i.rare+"Array"]);i.plantID=l,"a"==i.rewardType?h.default.instance.setPlantChip(l,s):h.default.instance.getPlant(l),this.rewardArr.push(i)}onClickCloseBtn(){r.default.instance.drawGuide?d.default.instance.showToast("\u8bf7\u5148\u5b8c\u6210\u5f15\u5bfc"):(d.default.instance.closeUI("DrawUI"),d.default.instance.uiList.MenuUI.getComponent(p.default).showNode(),l.default.instance.sdkType==l.SDK_TYPE.WeChat&&(g.MyUtils.probability(s.default.mainInster)&&l.default.instance.showInsert(),l.default.instance.hideNative(1),l.default.instance.showNative(0)))}initPlatform(){switch(l.default.instance.sdkType){case l.SDK_TYPE.WeChat:l.default.instance.hideNative(0),l.default.instance.showNative(1)}}};n([C(cc.Node)],b.prototype,"btn1",void 0),n([C(cc.Node)],b.prototype,"btn2",void 0),n([C(cc.Node)],b.prototype,"btn3",void 0),n([C(cc.Node)],b.prototype,"btn4",void 0),n([C(cc.Node)],b.prototype,"ball",void 0),n([C(cc.Node)],b.prototype,"ball2",void 0),n([C(cc.Node)],b.prototype,"guidePanel",void 0),n([C(sp.Skeleton)],b.prototype,"goldDraw",void 0),n([C(sp.Skeleton)],b.prototype,"diamondDraw",void 0),b=n([y],b),a.default=b,cc._RF.pop()},{"../ADManager/AD/WeChat/WeChatConstant":"WeChatConstant","../ADManager/ADManager":"ADManager","../ADlibs/Hts":"Hts","../Manager/AudioManager":"AudioManager","../Manager/DataManager":"DataManager","../Manager/ExcelManager":"ExcelManager","../Manager/UIManager":"UIManager","../Manager/UserDataManager":"UserDataManager","../TaSdk/TaSdk":"TaSdk","../utils/MyUtils":"MyUtils","./MenuUI":"MenuUI","./NoCoinUI":"NoCoinUI","./RewardUI":"RewardUI"}],ExcelManager:[function(e,t,a){"use strict";cc._RF.push(t,"81cb0AL8cVFX4BFFASrW/Jv","ExcelManager"),Object.defineProperty(a,"__esModule",{value:!0}),a.ExcelMgr=a.TableName=void 0;const n=e("./../3rd/CSVParser");(function(e){e.levelTable="levelTable",e.plantTable="plantTable",e.zombieTable="zombieTable",e.bulletTable="bulletTable",e.lotteryTable="lotteryTable",e.shopTable="shopTable",e.priceTable="priceTable",e.guideTable="guideTable"})(a.TableName||(a.TableName={}));class i{constructor(){this.csvTableForArr=[],this.tableCast={},this.tableComment={},this.csvTables={}}static get instance(){return this._instance||(this._instance=new i),this._instance}AddExcelArrTable(e,t){var a={},i=[];n.default.parse(t,{header:!0},function(e,t){a[e[t]]=e,i.push(e)}),this.tableCast[e]=n.default.opts.cast,this.tableComment[e]=n.default.opts.comment,this.csvTableForArr[e]=i,window[e+"Arr"]=i}AddExcelTable(e,t){if(!this.csvTables[e]){var a={};n.default.parse(t,{header:!0},function(e,t){a[e[t]]=e}),this.tableCast[e]=n.default.opts.cast,this.tableComment[e]=n.default.opts.comment,this.csvTables[e]=a,window[e]=a}}GetExcelObject(e){return this.csvTables[e]}GetExcelArray(e){return this.csvTableForArr[e]}}a.ExcelMgr=i,i._instance=null,cc._RF.pop()},{"./../3rd/CSVParser":"CSVParser"}],FailUI:[function(e,t,a){"use strict";cc._RF.push(t,"9184f/zpTJLNqamm+I6pKfl","FailUI");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const i=e("../ADManager/AD/Byte/ByteConstant"),s=e("../ADManager/AD/WeChat/WeChatConstant"),l=e("../ADManager/ADManager"),o=e("../Manager/AudioManager"),r=e("../Manager/DataManager"),c=e("../Manager/UIManager"),d=e("../utils/KDefine"),h=e("../utils/MyUtils"),u=e("./SharePanelUI"),{ccclass:g,property:p}=cc._decorator;let f=class extends cc.Component{onLoad(){r.default.instance.clearTempData(),o.default.instance.playMusic(d.AudioName.FailBgm),this.initPlatform()}initPlatform(){switch(l.default.instance.sdkType){case l.SDK_TYPE.Byte:h.MyUtils.probability(i.default.resultInster)&&l.default.instance.showInsert(),l.default.instance.recorderStop(),r.default.instance.level>3&&r.default.instance.level%2==0&&c.default.instance.openUI("SharePanelUI").getComponent(u.default).init(1);break;case l.SDK_TYPE.WeChat:this.scheduleOnce(()=>{c.default.instance.showUI("MoreGameUI",999)},s.default.juZhenDelay),l.default.instance.showNative(1),l.default.instance.showNative(2),l.default.instance.showNative(3)}}onClickRestartBtn(){c.default.instance.closeUI("FailUI"),20!=r.default.instance.level?c.default.instance.openUI("MainUI"):c.default.instance.openUI("BossUI")}onClickBackHomeBtn(){c.default.instance.closeUI("FailUI"),c.default.instance.openUI("MenuUI")}onClickUpgradeBtn(){c.default.instance.closeUI("FailUI"),c.default.instance.openUI("MenuUI").opacity=0,c.default.instance.openUI("UpgradeUI")}onDestroy(){l.default.instance.hideNative(1),l.default.instance.hideNative(2),l.default.instance.hideNative(3)}};f=n([g],f),a.default=f,cc._RF.pop()},{"../ADManager/AD/Byte/ByteConstant":"ByteConstant","../ADManager/AD/WeChat/WeChatConstant":"WeChatConstant","../ADManager/ADManager":"ADManager","../Manager/AudioManager":"AudioManager","../Manager/DataManager":"DataManager","../Manager/UIManager":"UIManager","../utils/KDefine":"KDefine","../utils/MyUtils":"MyUtils","./SharePanelUI":"SharePanelUI"}],FirstPanelUI:[function(e,t,a){"use strict";cc._RF.push(t,"998ffUYxt5Kf7VvgZjBpqFq","FirstPanelUI");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const i=e("../ADManager/ADManager"),s=e("../ADManager/Privacy_UserView"),{ccclass:l,property:o}=cc._decorator;let r=class extends cc.Component{constructor(){super(...arguments),this.privacy=null,this.title=null}onLoad(){i.default.instance.init(),i.default.instance.sdkType==i.SDK_TYPE.XiaoMi&&(this.title.string="\u5357\u4eac\u5929\u8c46\u4e92\u52a8\u7f51\u7edc\u79d1\u6280\u6709\u9650\u516c\u53f8")}onClickReject(){i.default.instance.exitGame()}onClickUser(e,t){let a=cc.instantiate(this.privacy);a.getComponent(s.default).init(t),a.parent=cc.find("Canvas")}onClickSure(){cc.director.loadScene("LoadScene")}};n([o(cc.Prefab)],r.prototype,"privacy",void 0),n([o(cc.Label)],r.prototype,"title",void 0),r=n([l],r),a.default=r,cc._RF.pop()},{"../ADManager/ADManager":"ADManager","../ADManager/Privacy_UserView":"Privacy_UserView"}],FrameAnimComponent:[function(e,t,a){"use strict";cc._RF.push(t,"65e6bqRApRNVLMnRjtz9XG/","FrameAnimComponent");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(e,t)},function(e,t){function a(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}),s=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});var l=e("./FrameAnim"),o=cc._decorator,r=o.ccclass,c=(o.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.update=function(e){this.updateFrame(e)},s([r],t)}(l.default));a.default=c,cc._RF.pop()},{"./FrameAnim":"FrameAnim"}],FrameAnim:[function(e,t,a){"use strict";cc._RF.push(t,"4e0a5ElFpNFCroC4uwoOj2N","FrameAnim");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(e,t)},function(e,t){function a(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}),s=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});var l=cc._decorator,o=l.ccclass,r=l.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.spriteFrames=[],t.duration=.1,t.loop=!1,t.playOnload=!1,t.endCallback=null,t.isPlaying=!1,t.playTime=0,t.spriteLen=0,t.spriteIndex=0,t}return i(t,e),t.prototype.onLoad=function(){this.sprite||(this.sprite=this.node.getComponent(cc.Sprite),this.spriteLen=this.spriteFrames.length),this.sprite?(this.sprite.sizeMode=cc.Sprite.SizeMode.RAW,this.sprite.trim=!1,this.playOnload&&this.play()):console.error("====[ERR]FrameAnim, \u672a\u914d\u7f6esprite")},t.prototype.setFrames=function(e){this.spriteFrames=e,this.spriteLen=this.spriteFrames.length,this.node.getComponent(cc.Sprite).spriteFrame=e[0]},t.prototype.setLoop=function(e){return this.loop=e,this},t.prototype.setEndFn=function(e){return this.endCallback=e,this},t.prototype.play=function(){return this.spriteLen<=0?(console.error("====[ERR]FrameAnim, spriteLen\u4e3a\u7a7a"),this):(this.isPlaying=!0,this)},t.prototype.stop=function(){return this.isPlaying=!1,this},t.prototype.reset=function(){this.spriteIndex=0,this.playTime=0,this.sprite.spriteFrame=this.spriteFrames[0]},t.prototype.updateFrame=function(e){if(this.isPlaying&&(this.playTime+=e,!(this.playTime<this.duration))){if(this.spriteIndex++,this.playTime=0,this.spriteIndex>=this.spriteLen){if(!this.loop)return this.isPlaying=!1,void(this.endCallback&&this.endCallback());this.spriteIndex=0}this.sprite.spriteFrame=this.spriteFrames[this.spriteIndex]}},s([r({type:[cc.SpriteFrame]})],t.prototype,"spriteFrames",void 0),s([r({tooltip:"\u6bcf\u4e00\u5e27\u65f6\u957f"})],t.prototype,"duration",void 0),s([r()],t.prototype,"loop",void 0),s([r()],t.prototype,"playOnload",void 0),s([o],t)}(cc.Component);a.default=c,cc._RF.pop()},{}],GMap:[function(e,t,a){"use strict";cc._RF.push(t,"ff9acTrMCdP/oYmscviI8ht","GMap");var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(e,t)},function(e,t){function a(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}),s=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});var l=cc._decorator,o=l.ccclass,r=l.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.label=null,t.text="hello",t}return i(t,e),t.prototype.start=function(){},s([r(cc.Label)],t.prototype,"label",void 0),s([r],t.prototype,"text",void 0),s([o],t)}(cc.Component);a.default=c,cc._RF.pop()},{}],GameSwitch:[function(e,t,a){"use strict";cc._RF.push(t,"14c02NQAL5A250s7RlfPPZQ","GameSwitch"),Object.defineProperty(a,"__esModule",{value:!0});const n=e("../../Manager/UserDataManager"),i=e("../AD/Byte/ByteConstant"),s=e("../AD/WeChat/WeChatConstant"),l=e("../AD/WeChat/WeChatTime"),o=e("../ADManager");class r{static requestHttpGetGameSwitch(){let e=this,t="",a=0;switch(o.default.instance.sdkType){case o.SDK_TYPE.Byte:t="62eb85d57a6efc2a5c27dbc2";break;case o.SDK_TYPE.WeChat:t="62f310d616f15e45c2b0f26c",window.wx&&0==(a=n.default.instance.scene)&&(a=wx.getLaunchOptionsSync().scene,n.default.instance.scene=a);break;case o.SDK_TYPE.Oppo:t="6295ad1c1b8d9b425a056305";break;case o.SDK_TYPE.IOS:t="629d79001b8d9b425a070465";break;case o.SDK_TYPE.ViVo:t="625fa58c3509b153b38a1e21"}const c={id:t,sid:a};console.log("sid==",a);const d=new XMLHttpRequest;d.open("POST","https://ga.gametdd.com/adCtrl/agd/conf",!0),d.setRequestHeader("Content-Type","application/json; charset=utf-8");const h=JSON.stringify(c);d.send(h),d.onload=function(){if(200==d.status){const t=JSON.parse(d.responseText);if(t.data)switch(r.version=t.data.p1,o.default.instance.sdkType){case o.SDK_TYPE.Byte:i.default.resultInster=parseFloat(t.data.p1),i.default.gameBanner=parseFloat(t.data.p2),i.default.tryPanel=parseFloat(t.data.p3);break;case o.SDK_TYPE.WeChat:s.default.btnDelay=parseFloat(t.data.p1),s.default.tryPanel=parseFloat(t.data.p2),s.default.mainInster=parseFloat(t.data.p3),s.default.noOperation=parseFloat(t.data.p4),s.default.firstJuzhen=0!=parseFloat(t.data.p5),s.default.juZhenDelay=parseFloat(t.data.p6),s.default.showIcon=0!=parseFloat(t.data.p7),s.default.showJuzhen=0!=parseFloat(t.data.p8),0!=s.default.noOperation&&(e.videoNode=new cc.Node,cc.game.addPersistRootNode(e.videoNode),e.videoNode.addComponent(l.default))}console.log(t)}else console.error("\u8bf7\u6c42api\u5931\u8d25!"+d.status)}}}a.default=r,r.version="",cc._RF.pop()},{"../../Manager/UserDataManager":"UserDataManager","../AD/Byte/ByteConstant":"ByteConstant","../AD/WeChat/WeChatConstant":"WeChatConstant","../AD/WeChat/WeChatTime":"WeChatTime","../ADManager":"ADManager"}],GoldManager:[function(e,t,a){"use strict";cc._RF.push(t,"ae4d1oOBGlKCJ3iguuqNhuu","GoldManager"),Object.defineProperty(a,"__esModule",{value:!0});const n=e("./BundleManager"),i=e("../entity/Gold");class s{constructor(){this.itemPoolSize=50,this.itemPool=new cc.NodePool}static get instance(){return s._instance||(s._instance=new s),s._instance}init(){for(let e=0;e<this.itemPoolSize;e++){let e=cc.instantiate(n.default.instance.getBundleRes("Prefab","Object/Gold"));this.itemPool.put(cc.instantiate(e))}}getItem(e,t,a,s){let l=null;return(l=this.itemPool.size()>0?this.itemPool.get():cc.instantiate(n.default.instance.getBundleRes("Prefab","Object/Gold"))).getComponent(i.default).init(e,t,a,s),l}putItem(e){this.itemPool.put(e)}}a.default=s,s._instance=null,cc._RF.pop()},{"../entity/Gold":"Gold","./BundleManager":"BundleManager"}],Gold:[function(e,t,a){"use strict";cc._RF.push(t,"7522aFkgrpJNYOtQBQCnpMX","Gold");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const i=e("../Manager/AudioManager"),s=e("../Manager/DataManager"),l=e("../Manager/GoldManager"),o=e("../scene_stage/SceneStage"),r=e("../utils/KDefine"),c=e("../utils/MyUtils"),{ccclass:d}=cc._decorator;let h=class extends cc.Component{constructor(){super(...arguments),this.gold=50}init(e,t,a,n){this.node.x=e,this.node.y=t,this.node.zIndex=999;let i=c.MyUtils.getRandomInt(-1,2);this.gold=Math.floor(n);let r=cc.tween;r(this.node).parallel(r().by(.25,{x:50*i}),r().by(.25,{y:50}).to((t+30-s.default.instance.groudYArr[a])/200,{y:s.default.instance.groudYArr[a]-30})).call(()=>{this.scheduleOnce(()=>{l.default.instance.putItem(this.node)},10)}).start(),this.node.on(cc.Node.EventType.TOUCH_END,this.onClickGold,this),o.default.instance.autoPick&&this.scheduleOnce(()=>{this.onClickGold()},2)}onClickGold(){this.unscheduleAllCallbacks(),i.default.instance.playEffect(r.AudioName.PickSunEff);let e=c.MyUtils.getDis(214,316,this.node.x,this.node.y);cc.tween(this.node).to(e/1e3,{x:-515,y:310}).call(()=>{l.default.instance.putItem(this.node),o.default.instance.goldNums+=this.gold}).start()}onDisable(){cc.Tween.stopAllByTarget(this.node)}};h=n([d],h),a.default=h,cc._RF.pop()},{"../Manager/AudioManager":"AudioManager","../Manager/DataManager":"DataManager","../Manager/GoldManager":"GoldManager","../scene_stage/SceneStage":"SceneStage","../utils/KDefine":"KDefine","../utils/MyUtils":"MyUtils"}],GuideUI2:[function(e,t,a){"use strict";cc._RF.push(t,"6f1f2RDgJRK34kZRXadJ8Hb","GuideUI2");var n,i=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const s=e("../ADlibs/Hts"),l=e("../entity/Ball"),o=e("../entity/Boss"),r=e("../entity/Plant/PlantBase"),c=e("../entity/Zombie/Zombie"),d=e("../Manager/AudioManager"),h=e("../Manager/BundleManager"),u=e("../Manager/DataManager"),g=e("../Manager/ExcelManager"),p=e("../Manager/UIManager"),f=e("../Manager/UserDataManager"),m=e("../Manager/ZombieMgr"),y=e("../scene_stage/SceneStage"),C=e("../TaSdk/TaSdk"),{ccclass:b,property:P}=cc._decorator;let v=n=class extends cc.Component{constructor(){super(...arguments),this.step=0,this.clickBall2=!1,this.clickBall3=!1}static get instance(){return this._instance}onLoad(){n._instance=this,this.guidePanel=this.node.getChildByName("GuidePanel"),this.highLight=this.node.getChildByName("HighLight"),this.finger=this.node.getChildByName("GuideFinger"),this.block=this.node.getChildByName("Block"),this.mask=this.node.getChildByName("Mask"),this.boss=this.node.getChildByName("Boss").getComponent(sp.Skeleton),this.ball1=this.node.getChildByName("plantBall1"),this.ball2=this.node.getChildByName("plantBall2"),this.ball3=this.node.getChildByName("plantBall3"),this.ball4=this.node.getChildByName("plantBall4"),this.boss.node.zIndex=-1,this.guideTable=g.ExcelMgr.instance.GetExcelObject(g.TableName.guideTable),this.node.on("init",this.init,this),this.node.on("nextStep",this.nextStep,this)}init(e){this.step=0,this.type=e,this.nextStep()}guide1(){switch(this.step){case 1:C.default.instance.postEvent("Tutorial",{tutorial_step:1}),s.default.instance.eventReport("\u8fdb\u5165\u65b0\u624b\u4f53\u9a8c\u5173"),u.default.instance.selectPlantID=[1,21],y.default.instance.play(),y.default.instance.node.getChildByName("PauseBtn").active=!1,y.default.instance.node.getChildByName("shovelPanel").active=!1,y.default.instance.cardPanel.x=-1e3,y.default.instance.plantPanel.x=-1e3,this.node.getChildByName("Boss").active=!0,this.nextStep();break;case 2:this.scheduleOnce(()=>{y.default.instance.cardPanel.x=-586,y.default.instance.plantPanel.x=-586,y.default.instance.cardPanel.children[0].x=-300,y.default.instance.plantPanel.children[0].x=-300,y.default.instance.cardPanel.children[1].x=-300,y.default.instance.plantPanel.children[1].x=-300,this.showToast(this.guideTable[2].res,this.guideTable[2].talk),C.default.instance.postEvent("Tutorial",{tutorial_step:2}),s.default.instance.eventReport("\u6234\u592b\u9996\u6b21\u52a8\u753b")},10);break;case 3:cc.tween(y.default.instance.cardPanel.children[0]).to(1,{x:0}).call(()=>{this.nextStep()}).start(),cc.tween(y.default.instance.plantPanel.children[0]).to(1,{x:0}).start(),this.hideToast();break;case 4:y.default.instance.goldNums+=500,this.showHighLight(-585,240,120,80);break;case 5:y.default.instance.cardPanel.children[0].getChildByName("HighLight").active=!0,this.showHighLight(-320,130,81,93);break;case 6:y.default.instance.goldNums-=500,y.default.instance.cardPanel.children[0].getChildByName("HighLight").active=!1;let e=y.default.instance.plantPanel.children[0];for(let s=0;s<5;s++){let t=u.default.instance.blockArr[s][0][0],a=cc.instantiate(e);a.parent=y.default.instance.groudNode,a.opacity=255,a.setPosition(t),a.getComponent(r.default).reset(1,!0),a.getComponent(r.default).play(s,0),a.getChildByName("PlantEffect").active=!0,u.default.instance.blockArr[s][0][1]=a}this.hideHighLight(),this.nextStep();break;case 7:this.scheduleOnce(()=>{this.showToast(this.guideTable[4].res,this.guideTable[4].talk),C.default.instance.postEvent("Tutorial",{tutorial_step:3}),s.default.instance.eventReport("\u5f15\u5bfc\u79cd\u690d\u575a\u679c")},g.ExcelMgr.instance.GetExcelObject(g.TableName.levelTable)[0].waveTime[0]+g.ExcelMgr.instance.GetExcelObject(g.TableName.levelTable)[0].bigGap[1]-3);break;case 8:this.hideToast(),cc.tween(y.default.instance.cardPanel.children[1]).to(1,{x:0}).call(()=>{this.nextStep()}).start(),cc.tween(y.default.instance.plantPanel.children[1]).to(1,{x:0}).start();break;case 9:y.default.instance.goldNums+=500,this.showHighLight(-585,165,120,80);break;case 10:y.default.instance.cardPanel.children[1].getChildByName("HighLight").active=!0,this.showHighLight(163.5,130,81,93);break;case 11:y.default.instance.goldNums-=500,y.default.instance.cardPanel.children[1].getChildByName("HighLight").active=!1;let t=y.default.instance.plantPanel.children[1];for(let s=0;s<5;s++){let e=u.default.instance.blockArr[s][6][0],a=cc.instantiate(t);a.parent=y.default.instance.groudNode,a.opacity=255,a.setPosition(e),a.getComponent(r.default).reset(21,!0),a.getComponent(r.default).play(s,6),a.getChildByName("PlantEffect").active=!0,u.default.instance.blockArr[s][6][1]=a}this.hideHighLight(),this.nextStep();break;case 12:this.boss.node.getComponent(o.default).addBoss(),this.scheduleOnce(()=>{let e=y.default.instance.node.getChildByName("Begin").getComponent(sp.Skeleton).setAnimation(0,"boss",!1);y.default.instance.node.getChildByName("Begin").getComponent(sp.Skeleton).setTrackEventListener(e,(e,t)=>{"boss"==t.data.name&&d.default.instance.playEffect("boss")}),y.default.instance.node.getChildByName("Begin").getComponent(sp.Skeleton).setCompleteListener(()=>{this.boss.node.x=720,this.boss.setAnimation(0,"1ruchang",!1),this.boss.setCompleteListener(()=>{this.boss.setCompleteListener(null),this.boss.setAnimation(0,"1daiji",!0),this.nextStep()}),cc.tween(this.node.getChildByName("Born")).to(1,{opacity:255}).call(()=>{m.default.instance().newPos=!0}).start()})},g.ExcelMgr.instance.GetExcelObject(g.TableName.levelTable)[0].waveTime[1]+g.ExcelMgr.instance.GetExcelObject(g.TableName.levelTable)[0].bigGap[2]-3);break;case 13:this.showToast(this.guideTable[7].res,this.guideTable[7].talk),C.default.instance.postEvent("Tutorial",{tutorial_step:4}),s.default.instance.eventReport("Boss\u51fa\u73b0");break;case 14:this.showToast(this.guideTable[8].res,this.guideTable[8].talk,!1);break;case 15:this.hideToast(),this.boss.setAnimation(0,"1houchebu",!1),this.boss.setCompleteListener(()=>{this.boss.node.y=150,this.boss.setCompleteListener(()=>{this.boss.setCompleteListener(null),this.boss.setAnimation(0,"1daij2",!1),this.scheduleOnce(()=>{this.boss.setCompleteListener(()=>{this.boss.setCompleteListener(null),this.boss.setAnimation(0,"1daij2",!1),this.scheduleOnce(()=>{this.boss.setCompleteListener(()=>{this.boss.node.y=-45,this.boss.setCompleteListener(()=>{this.boss.setCompleteListener(null),this.boss.setAnimation(0,"1daiji",!0)}),this.boss.setAnimation(0,"1ruchang",!1)}),this.boss.setAnimation(0,"1chuhua",!1)},1)}),this.scheduleOnce(()=>{for(let e=0;e<u.default.instance.row;e++)for(let t=0;t<u.default.instance.col;t++)u.default.instance.blockArr[e][t][1]&&u.default.instance.blockArr[e][t][1].getComponent(r.default).hurt(9999);this.scheduleOnce(()=>{this.showToast(this.guideTable[9].res,this.guideTable[9].talk)},1)},.5),this.boss.setAnimation(0,"1gongji",!1)},1)}),this.boss.setAnimation(0,"1ruchang2",!1)});break;case 16:this.hideToast(),this.ball1.getComponent(l.default).init(11),this.scheduleOnce(()=>{cc.Tween.stopAllByTarget(this.ball1),this.showToast(this.guideTable[10].res,this.guideTable[10].talk)},5);break;case 17:this.hideToast(),this.showHighLight(this.ball1.x,this.ball1.y+40,250,250);break;case 18:this.ball1.getComponent(l.default).onClick(),this.hideHighLight(),this.scheduleOnce(()=>{this.showToast(this.guideTable[12].res,this.guideTable[12].talk),C.default.instance.postEvent("Tutorial",{tutorial_step:5}),s.default.instance.eventReport("\u79cd\u690d\u8c4c\u8c46\u5c11\u5973")},1.5);break;case 19:this.hideToast(),y.default.instance.goldNums+=1250,this.showHighLight(-585,81,120,80);break;case 20:y.default.instance.cardPanel.children[2].getChildByName("HighLight").active=!0,this.showHighLight(-320,130,81,93);break;case 21:y.default.instance.goldNums-=1250,y.default.instance.cardPanel.children[2].getChildByName("HighLight").active=!1;let a=y.default.instance.plantPanel.children[2];for(let s=0;s<5;s++){let e=u.default.instance.blockArr[s][0][0],t=cc.instantiate(a);t.parent=y.default.instance.groudNode,t.opacity=255,t.setPosition(e),t.getComponent(r.default).reset(11,!0),t.getComponent(r.default).play(s,0),t.getChildByName("PlantEffect").active=!0,u.default.instance.blockArr[s][0][1]=t}this.hideHighLight(),this.nextStep();break;case 22:this.scheduleOnce(()=>{this.showToast(this.guideTable[14].res,this.guideTable[14].talk,!1)},g.ExcelMgr.instance.GetExcelObject(g.TableName.levelTable)[0].waveTime[2]+g.ExcelMgr.instance.GetExcelObject(g.TableName.levelTable)[0].bigGap[3]-14);break;case 23:this.scheduleOnce(()=>{this.showToast(this.guideTable[15].res,this.guideTable[15].talk,!0)},3),this.hideToast();break;case 24:C.default.instance.postEvent("Tutorial",{tutorial_step:6}),s.default.instance.eventReport("\u79cd\u690d\u6fc0\u5149\u5c11\u5973"),this.hideToast(),this.ball2.getComponent(l.default).init(22),this.ball3.getComponent(l.default).init(18),this.scheduleOnce(()=>{this.clickBall2||(this.jianguoToast(),this.ball2.getComponent(l.default).onClick())},6.5),this.scheduleOnce(()=>{this.clickBall3||(this.jiguangToast(),this.ball3.getComponent(l.default).onClick())},6);break;case 25:cc.director.resume(),this.hideToast();break;case 26:cc.director.resume(),this.hideToast(),this.scheduleOnce(()=>{y.default.instance.goldNums+=2e3,this.showHighLight(-585,0,120,80)},2);break;case 27:y.default.instance.cardPanel.children[3].getChildByName("HighLight").active=!0,this.showHighLight(-239.5,130,81,93);break;case 28:y.default.instance.cardPanel.children[3].getChildByName("HighLight").active=!1,y.default.instance.goldNums-=2e3;let n=y.default.instance.plantPanel.children[3];for(let s=0;s<5;s++){let e=u.default.instance.blockArr[s][1][0],t=cc.instantiate(n);t.parent=y.default.instance.groudNode,t.opacity=255,t.setPosition(e),t.getComponent(r.default).reset(18,!0),t.getComponent(r.default).play(s,1),t.getChildByName("PlantEffect").active=!0,u.default.instance.blockArr[s][1][1]=t}this.nextStep();break;case 29:y.default.instance.goldNums+=1e3,this.showHighLight(-585,-80,120,80);break;case 30:y.default.instance.cardPanel.children[4].getChildByName("HighLight").active=!0,this.showHighLight(-78.5,130,81,93);break;case 31:y.default.instance.goldNums-=1e3,y.default.instance.cardPanel.children[4].getChildByName("HighLight").active=!1;let i=y.default.instance.plantPanel.children[4];for(let s=0;s<5;s++){let e=u.default.instance.blockArr[s][3][0],t=cc.instantiate(i);t.parent=y.default.instance.groudNode,t.opacity=255,t.setPosition(e),t.getComponent(r.default).reset(22,!0),t.getComponent(r.default).play(s,3),t.getChildByName("PlantEffect").active=!0,u.default.instance.blockArr[s][3][1]=t}this.nextStep(),this.hideHighLight();break;case 32:this.scheduleOnce(()=>{this.showToast(this.guideTable[19].res,this.guideTable[19].talk,!0)},g.ExcelMgr.instance.GetExcelObject(g.TableName.levelTable)[0].waveTime[3]+g.ExcelMgr.instance.GetExcelObject(g.TableName.levelTable)[0].bigGap[4]-3);break;case 33:this.hideToast(),this.ball4.getComponent(l.default).init(20),this.scheduleOnce(()=>{cc.director.pause(),this.showToast(this.guideTable[20].res,this.guideTable[20].talk,!0),C.default.instance.postEvent("Tutorial",{tutorial_step:7}),s.default.instance.eventReport("\u79cd\u690d\u706b\u7130\u82b1\u5973\u7687"),this.ball4.getComponent(l.default).onClick()},5);break;case 34:cc.director.resume(),this.hideToast(),this.scheduleOnce(()=>{y.default.instance.goldNums+=2500,this.showHighLight(-585,-160,120,80)},1.5);break;case 35:y.default.instance.cardPanel.children[5].getChildByName("HighLight").active=!0,this.showHighLight(-159,130,81,93);break;case 36:y.default.instance.goldNums-=2500,y.default.instance.cardPanel.children[5].getChildByName("HighLight").active=!1;let c=y.default.instance.plantPanel.children[5];for(let s=0;s<5;s++){let e=u.default.instance.blockArr[s][2][0],t=cc.instantiate(c);t.parent=y.default.instance.groudNode,t.opacity=255,t.setPosition(e),t.getComponent(r.default).reset(20,!0),t.getComponent(r.default).play(s,2),t.getChildByName("PlantEffect").active=!0,u.default.instance.blockArr[s][2][1]=t}this.hideHighLight();break;case 37:this.scheduleOnce(()=>{this.showToast(this.guideTable[22].res,this.guideTable[22].talk,!1)},2);break;case 38:s.default.instance.eventReport("\u4f53\u9a8c\u5173\u7ed3\u675f"),C.default.instance.postEvent("Tutorial",{tutorial_step:8}),m.default.instance().newPos=!1,this.hideToast(),this.boss.setAnimation(0,"1houchebu",!1),this.boss.setCompleteListener(()=>{this.scheduleOnce(()=>{p.default.instance.closeUI("MainUI"),p.default.instance.closeUI("GuideUI2"),p.default.instance.openUI("SuccessUI")},2)})}}guide2(){switch(this.step){case 1:s.default.instance.eventReport("\u8fdb\u5165\u690d\u7269\u754c\u9762"),C.default.instance.postEvent("Tutorial",{tutorial_step:9}),this.showToast(this.guideTable[25].res,this.guideTable[25].talk);break;case 2:this.showToast(this.guideTable[26].res,this.guideTable[26].talk);break;case 3:this.hideToast(),this.showHighLight(-358,-290,150,150);break;case 4:p.default.instance.uiList.MenuUI.emit("onClickUpgradeBtn"),this.showHighLight(343,-65,150,150);break;case 5:p.default.instance.uiList.UpgradeUI.emit("onClickBuyBtn"),p.default.instance.uiList.UpgradeUI.emit("onClickBuyBtn"),p.default.instance.uiList.UpgradeUI.emit("onClickBuyBtn"),s.default.instance.eventReport("\u70b9\u51fb\u5347\u7ea7\u6309\u94ae"),C.default.instance.postEvent("Tutorial",{tutorial_step:10}),this.hideHighLight(),this.showToast(this.guideTable[29].res,this.guideTable[29].talk);break;case 6:this.hideToast(),this.showHighLight(445,245,150,150);break;case 7:f.default.instance.upGradeGuide=!0,p.default.instance.closeUI("GuideUI2"),p.default.instance.uiList.UpgradeUI.emit("onClickCloseBtn"),s.default.instance.eventReport("\u5347\u7ea7\u5f15\u5bfc\u7ed3\u675f")}}guide3(){switch(this.step){case 1:u.default.instance.selectPlantID=[1,2,21],this.showHighLight(-80,150,150,150);break;case 2:u.default.instance.level=2,p.default.instance.openUI("MainUI"),p.default.instance.closeUI("MenuUI"),s.default.instance.eventReport("\u8fdb\u5165\u7b2c\u4e8c\u5173"),C.default.instance.postEvent("Tutorial",{tutorial_step:11}),this.hideHighLight();break;case 3:this.showToast(this.guideTable[32].res,this.guideTable[32].talk);break;case 4:this.hideToast(),this.showHighLight(-255,-170,120,80);break;case 5:p.default.instance.uiList.PrepareCards.emit("guideSelect"),this.hideHighLight(),this.showToast(this.guideTable[34].res,this.guideTable[34].talk),s.default.instance.eventReport("\u70b9\u51fb\u8c4c\u8c46\u5c11\u5973"),C.default.instance.postEvent("Tutorial",{tutorial_step:12});break;case 6:this.hideToast(),this.showHighLight(322,-255,200,100);break;case 7:p.default.instance.closeUI("PrepareCards"),y.default.instance.play(),p.default.instance.closeUI("GuideUI2"),f.default.instance.levelGuide=!0,s.default.instance.eventReport("\u5173\u5361\u5f15\u5bfc\u7ed3\u675f")}}guide4(){switch(this.step){case 1:f.default.instance.diamond+=40,this.showToast(this.guideTable[42].res,this.guideTable[42].talk);break;case 2:this.hideToast(),this.showHighLight(-230,-290,150,150);break;case 3:s.default.instance.eventReport("\u8fdb\u5165\u62bd\u5956"),C.default.instance.postEvent("Tutorial",{tutorial_step:15}),p.default.instance.uiList.MenuUI.emit("onClickDrawBtn"),this.hideHighLight(),this.showToast(this.guideTable[44].res,this.guideTable[44].talk);break;case 4:this.hideToast(),this.showHighLight(200,-255,150,150);break;case 5:p.default.instance.uiList.DrawUI.emit("draw","btn3"),this.hideHighLight();break;case 6:this.showToast(this.guideTable[46].res,this.guideTable[46].talk);break;case 7:this.hideToast(),this.showHighLight(-580,300,150,150);break;case 8:u.default.instance.drawGuide=!1,f.default.instance.drawGuide=!0,p.default.instance.closeUI("GuideUI2"),p.default.instance.uiList.DrawUI.emit("onClickCloseBtn"),s.default.instance.eventReport("\u62bd\u5956\u5f15\u5bfc\u7ed3\u675f")}}guide5(){switch(this.step){case 1:this.showHighLight(-358,-290,150,150);break;case 2:s.default.instance.eventReport("\u7b2c\u4e8c\u6b21\u8fdb\u5165\u690d\u7269\u5347\u7ea7"),C.default.instance.postEvent("Tutorial",{tutorial_step:16}),p.default.instance.uiList.MenuUI.emit("onClickUpgradeBtn"),this.showHighLight(343,-65,150,150);break;case 3:s.default.instance.eventReport("\u7b2c\u4e8c\u6b21\u70b9\u51fb\u5347\u7ea7\u6309\u94ae"),C.default.instance.postEvent("Tutorial",{tutorial_step:17}),p.default.instance.uiList.UpgradeUI.emit("onClickBuyBtn"),this.hideHighLight(),this.showToast(this.guideTable[50].res,this.guideTable[50].talk);break;case 4:this.showToast(this.guideTable[51].res,this.guideTable[51].talk);break;case 5:f.default.instance.upGradeGuide2=!0,p.default.instance.closeUI("GuideUI2"),s.default.instance.eventReport("\u788e\u7247\u5347\u7ea7\u5f15\u5bfc\u7ed3\u675f")}}guide6(){switch(this.step){case 1:s.default.instance.eventReport("\u9ec4\u74dc\u70b8\u5f39\u5f15\u5bfc"),C.default.instance.postEvent("Tutorial",{tutorial_step:13}),this.showToast(this.guideTable[37].res,this.guideTable[37].talk);break;case 2:this.showToast(this.guideTable[38].res,this.guideTable[38].talk);break;case 3:y.default.instance.bombNums++,this.hideToast(),y.default.instance.showBomb(),this.showHighLight(0,-290,150,150);break;case 4:this.hideHighLight(),y.default.instance.onClickBomb();break;case 5:this.showToast(this.guideTable[40].res,this.guideTable[40].talk);break;case 6:this.hideToast(),f.default.instance.huangGuaGuide=!0,p.default.instance.closeUI("GuideUI2"),s.default.instance.eventReport("\u9ec4\u74dc\u70b8\u5f39\u5f15\u5bfc\u7ed3\u675f")}}nextStep(){switch(this.step++,this.type){case 1:this.guide1();break;case 2:this.guide2();break;case 3:this.guide3();break;case 4:this.guide4();break;case 5:this.guide5();break;case 6:this.guide6()}}jiguangToast(){cc.director.pause(),this.clickBall3=!0,this.showToast(this.guideTable[16].res,this.guideTable[16].talk,!0)}jianguoToast(){cc.director.pause(),this.clickBall2=!0,this.showToast(this.guideTable[17].res,this.guideTable[17].talk,!0)}showToast(e,t,a=!0){switch(a?(this.guidePanel.x=-200,this.guidePanel.scaleY=1,this.guidePanel.getChildByName("Label").scaleX=1):(this.guidePanel.x=200,this.guidePanel.scaleY=-1,this.guidePanel.getChildByName("Label").scaleX=-1),this.mask.active=!0,this.guidePanel.active=!0,this.guidePanel.getComponentInChildren(cc.Label).string=t,e){case"\u6234\u592b":this.guidePanel.getComponentInChildren(cc.Sprite).spriteFrame=h.default.instance.getBundleRes("BundleTexture","GuideUI/p1",cc.SpriteFrame);break;case"\u706b\u7130\u82b1\u5973\u7687":this.guidePanel.getComponentInChildren(cc.Sprite).spriteFrame=h.default.instance.getBundleRes("BundleTexture","GuideUI/p2",cc.SpriteFrame);break;case"\u8c4c\u8c46\u5c11\u5973":this.guidePanel.getComponentInChildren(cc.Sprite).spriteFrame=h.default.instance.getBundleRes("BundleTexture","GuideUI/p3",cc.SpriteFrame);break;case"\u50f5\u5c38\u535a\u58eb":this.guidePanel.getComponentInChildren(cc.Sprite).spriteFrame=h.default.instance.getBundleRes("BundleTexture","GuideUI/p4",cc.SpriteFrame);break;case"\u575a\u679c\u5c11\u5973":this.guidePanel.getComponentInChildren(cc.Sprite).spriteFrame=h.default.instance.getBundleRes("BundleTexture","GuideUI/p5",cc.SpriteFrame);break;case"\u6fc0\u5149\u5c11\u5973":this.guidePanel.getComponentInChildren(cc.Sprite).spriteFrame=h.default.instance.getBundleRes("BundleTexture","GuideUI/p6",cc.SpriteFrame)}this.gamePause()}hideToast(){this.gameResume(),this.mask.active=!1,this.guidePanel.active=!1}showHighLight(e,t,a=150,n=150){this.mask.active=!1,this.finger.active=!0,this.highLight.active=!0,this.highLight.x=e,this.highLight.y=t,this.highLight.width=a,this.highLight.height=n,this.finger.x=e,this.finger.y=t,this.block.active=!0,this.gamePause()}hideHighLight(){this.gameResume(),this.finger.active=!1,this.highLight.active=!1,this.block.active=!1}gamePause(){if(1==this.type||6==this.type){m.default.instance().isPlay=!1,y.default.instance.isGuide=!0;for(let e=0;e<u.default.instance.row;e++)for(let t=0;t<u.default.instance.col;t++)u.default.instance.blockArr[e][t][1]&&(u.default.instance.blockArr[e][t][1].getComponent(r.default).isPause=!0);for(let e=0;e<[...m.default.instance().zombieSet.values()].length;e++)[...m.default.instance().zombieSet.values()][e].getComponent(c.default)&&([...m.default.instance().zombieSet.values()][e].getComponent(c.default).time=0,[...m.default.instance().zombieSet.values()][e].getComponent(c.default).dragon.timeScale=0)}}gameResume(){if(1==this.type||6==this.type){m.default.instance().isPlay=!0,y.default.instance.isGuide=!1;for(let e=0;e<u.default.instance.row;e++)for(let t=0;t<u.default.instance.col;t++)u.default.instance.blockArr[e][t][1]&&(u.default.instance.blockArr[e][t][1].getComponent(r.default).isPause=!1);for(let e=0;e<[...m.default.instance().zombieSet.values()].length;e++)[...m.default.instance().zombieSet.values()][e]&&[...m.default.instance().zombieSet.values()][e].getComponent(c.default)&&([...m.default.instance().zombieSet.values()][e].getComponent(c.default).time=1,[...m.default.instance().zombieSet.values()][e].getComponent(c.default).dragon.timeScale=1)}}};v._instance=null,v=n=i([b],v),a.default=v,cc._RF.pop()},{"../ADlibs/Hts":"Hts","../Manager/AudioManager":"AudioManager","../Manager/BundleManager":"BundleManager","../Manager/DataManager":"DataManager","../Manager/ExcelManager":"ExcelManager","../Manager/UIManager":"UIManager","../Manager/UserDataManager":"UserDataManager","../Manager/ZombieMgr":"ZombieMgr","../TaSdk/TaSdk":"TaSdk","../entity/Ball":"Ball","../entity/Boss":"Boss","../entity/Plant/PlantBase":"PlantBase","../entity/Zombie/Zombie":"Zombie","../scene_stage/SceneStage":"SceneStage"}],GuideUI:[function(e,t,a){"use strict";cc._RF.push(t,"db238tWWBNDYqLKwWKXX3/a","GuideUI");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const i=e("../ADlibs/Hts"),s=e("../entity/Gold"),l=e("../entity/Plant/Plant10"),o=e("../entity/Plant/Plant2"),r=e("../entity/Plant/Plant21"),c=e("../entity/Plant/PlantBase"),d=e("../entity/Zombie/Zombie"),h=e("../Manager/AudioManager"),u=e("../Manager/BundleManager"),g=e("../Manager/DataManager"),p=e("../Manager/UIManager"),f=e("../Manager/ZombieMgr"),m=e("../scene_stage/SceneStage"),y=e("../TaSdk/TaSdk"),C=e("../utils/KDefine"),{ccclass:b,property:P}=cc._decorator;let v=class extends m.default{constructor(){super(...arguments),this.step=-1}onLoad(){m.default._instance=this,i.default.instance.eventReport("\u8fdb\u5165\u6559\u5b66"),h.default.instance.playMusic(C.AudioName.MainBgm,!0),cc.find("Canvas/Bg").getComponent(cc.Sprite).spriteFrame=u.default.instance.getBundleRes("BundleTexture","ui/Bg2",cc.SpriteFrame),cc.find("Canvas/Bg").x=81,this.guidePanel=this.node.getChildByName("Guide"),this.headImg=this.guidePanel.getChildByName("GuidePanel").getChildByName("Head").getComponent(cc.Sprite),this.zombiePanel=this.node.getChildByName("ZombieNode"),this.zombiePanel2=this.node.getChildByName("ZombieNode2"),this.plantPanel=this.node.getChildByName("PlantNode"),this.init()}start(){y.default.instance.postEvent("Loading",{loading_step:5}),this.nextStep()}init(){f.default.instance().zombieNums=10;for(let e=0;e<g.default.instance.row;e++)f.default.instance().zombieInRow[e]=new Set;for(let e=0;e<this.zombiePanel.childrenCount;e++)2!=e?this.zombiePanel.children[e].getComponent(d.default).reset(1):this.zombiePanel.children[e].getComponent(d.default).reset(4),this.zombiePanel.children[e].getComponent(d.default).row=4-e,f.default.instance().zombieInRow[4-e].add(this.zombiePanel.children[e].getComponent(d.default)),f.default.instance().zombieSet.add(this.zombiePanel.children[e].getComponent(d.default)),this.zombiePanel.children[e].getComponent(d.default).setState(C.State.move),this.zombiePanel.children[e].getComponent(d.default).inUse=!0;for(let e=0;e<this.zombiePanel2.childrenCount;e++)2!=e?this.zombiePanel2.children[e].getComponent(d.default).reset(3):this.zombiePanel2.children[e].getComponent(d.default).reset(12),this.zombiePanel2.children[e].getComponent(d.default).row=4-e,this.zombiePanel2.children[e].getComponent(d.default).setState(C.State.move),this.zombiePanel2.children[e].getComponent(d.default).speed=0,this.zombiePanel2.children[e].getComponent(d.default).inUse=!0;for(let e=0;e<this.plantPanel.childrenCount;e++)"wandou"==this.plantPanel.children[e].name?(this.plantPanel.children[e].addComponent(c.default),this.plantPanel.children[e].getComponent(c.default).reset(1,!0),this.plantPanel.children[e].getComponent(c.default).play(e,1)):"jianguo"==this.plantPanel.children[e].name?(this.plantPanel.children[e].addComponent(r.default),this.plantPanel.children[e].getComponent(r.default).reset(21,!0),this.plantPanel.children[e].getComponent(c.default).play(e-5,3)):"nianghuawandou"==this.plantPanel.children[e].name?(this.plantPanel.children[e].addComponent(c.default).reset(11,!0),this.plantPanel.children[e].getComponent(c.default).damage=28):"huoyanhua"==this.plantPanel.children[e].name&&(this.plantPanel.children[e].addComponent(l.default).reset(20,!0),this.plantPanel.children[e].getComponent(l.default).damage=210);this.goldNums=0}nextStep(){switch(this.step++,this.step){case 0:this.scheduleOnce(()=>{this.nextStep()},2);break;case 1:this.guidePanel.getChildByName("Mask").active=!0,this.node.getChildByName("PlantNode").getChildByName("xrk").addComponent(o.default).reset(2),this.node.getChildByName("PlantNode").getChildByName("xrk").getComponent(o.default).play(3,0),this.scheduleOnce(()=>{cc.tween(this.node.getChildByName("TipPanel")).to(.5,{opacity:0}).start()},1),this.scheduleOnce(()=>{this.node.getChildByName("PlantNode").getChildByName("xrk").getComponent(o.default).isPause=!0,this.nextStep()},2);break;case 2:this.guidePanel.active=!0,this.showFinger("\u6536\u96c6\u9633\u5149",this.sunParent.getChildByName("Gold").getPosition()),this.sunParent.getChildByName("Gold").getComponent(s.default).unscheduleAllCallbacks();break;case 3:this.sunParent.getChildByName("Gold").getComponent(s.default).onClickGold(),this.hideFinger(),this.scheduleOnce(()=>{this.cardPanel.children[1].getChildByName("Cost").active=!1},.5),this.scheduleOnce(this.nextStep,2);break;case 4:this.headImg.spriteFrame=u.default.instance.getBundleRes("BundleTexture","GuideUI/p1",cc.SpriteFrame),this.showFinger("\u79cd\u690d\u4e00\u4e2a\u5411\u65e5\u8475",new cc.Vec2(-602,148));break;case 5:this.cardPanel.children[1].getChildByName("HighLight").active=!0,this.guidePanel.getChildByName("GuideFinger").getComponent(sp.Skeleton).skeletonData=u.default.instance.getBundleRes("Spine","guide/yindao3/yindao3",sp.SkeletonData),this.guidePanel.getChildByName("GuideFinger").getComponent(sp.Skeleton).setAnimation(0,"daoda0",!0),this.headImg.spriteFrame=u.default.instance.getBundleRes("BundleTexture","GuideUI/p1",cc.SpriteFrame),this.showFinger("\u70b9\u51fb\u8fd9\u91cc\u79cd\u4e0b\u5411\u65e5\u8475",new cc.Vec2(-320,-145));break;case 6:this.cardPanel.children[1].getChildByName("HighLight").active=!1,this.cardPanel.children[1].getChildByName("Cost").active=!0,this.goldNums-=50,this.node.getChildByName("PlantNode").getChildByName("xrk2").active=!0,this.scheduleOnce(this.nextStep,(500-300*this.zombiePanel.children[2].getComponent(d.default).speed)/(50*this.zombiePanel.children[2].getComponent(d.default).speed)),this.hideFinger();break;case 7:this.goldNums+=300,this.cardPanel.children[3].active=!0,this.guidePanel.getChildByName("GuideFinger").getComponent(sp.Skeleton).skeletonData=u.default.instance.getBundleRes("Spine","guide/yindao/yindao",sp.SkeletonData),this.guidePanel.getChildByName("GuideFinger").getComponent(sp.Skeleton).setAnimation(0,"xunhuan",!0),this.headImg.spriteFrame=u.default.instance.getBundleRes("BundleTexture","GuideUI/p3",cc.SpriteFrame),this.showFinger("\u8f6e\u5230\u6211\u4e0a\u573a\u4e86",new cc.Vec2(-602,-10));break;case 8:this.guidePanel.getChildByName("GuideFinger").getComponent(sp.Skeleton).skeletonData=u.default.instance.getBundleRes("Spine","guide/yindao3/yindao3",sp.SkeletonData),this.guidePanel.getChildByName("GuideFinger").getComponent(sp.Skeleton).setAnimation(0,"daoda0",!0),this.headImg.spriteFrame=u.default.instance.getBundleRes("BundleTexture","GuideUI/p3",cc.SpriteFrame),this.showFinger("\u8d76\u5feb\u5c06\u6211\u79cd\u4e0b\uff0c\u50f5\u5c38\u8981\u653b\u8fc7\u6765\u4e86",new cc.Vec2(-320,-60)),i.default.instance.eventReport("\u653e\u4e0b\u8c4c\u8c46\u5a18");break;case 9:this.goldNums-=300,this.cardPanel.children[3].getChildByName("Cost").active=!0,this.hideFinger(),this.plantPanel.getChildByName("nianghuawandou").active=!0,this.plantPanel.getChildByName("nianghuawandou").getComponent(c.default).play(2,0),this.scheduleOnce(()=>{this.nextStep()},7);break;case 10:this.guidePanel.getChildByName("Mask").active=!1,this.node.getChildByName("TipPanel").opacity=255,this.node.getChildByName("TipPanel").getComponentInChildren(cc.Label).string="\u6700\u540e\u4e00\u6ce2\u50f5\u5c38\u5373\u5c06\u6765\u4e34\uff01",this.headImg.spriteFrame=u.default.instance.getBundleRes("BundleTexture","GuideUI/p1",cc.SpriteFrame),h.default.instance.playEffect("FinalZombieEff"),this.scheduleOnce(()=>{this.nextStep()},2);break;case 11:this.zombiePanel2.active=!0,cc.tween(this.node.getChildByName("TipPanel")).to(.5,{opacity:0}).start(),this.guidePanel.getChildByName("GuidePanel").active=!1,this.guidePanel.getChildByName("NextStep").active=!1;for(let e=0;e<this.zombiePanel2.childrenCount;e++)this.zombiePanel2.children[e].getComponent(d.default).speed=.5,f.default.instance().zombieInRow[4-e].add(this.zombiePanel2.children[e].getComponent(d.default)),f.default.instance().zombieSet.add(this.zombiePanel2.children[e].getComponent(d.default));this.scheduleOnce(this.nextStep,180/(50*this.zombiePanel2.children[2].getComponent(d.default).speed));break;case 12:this.goldNums+=300,this.cardPanel.children[4].active=!0,this.guidePanel.getChildByName("GuideFinger").getComponent(sp.Skeleton).skeletonData=u.default.instance.getBundleRes("Spine","guide/yindao/yindao",sp.SkeletonData),this.guidePanel.getChildByName("GuideFinger").getComponent(sp.Skeleton).setAnimation(0,"xunhuan",!0),this.headImg.spriteFrame=u.default.instance.getBundleRes("BundleTexture","GuideUI/p2",cc.SpriteFrame),this.showFinger("\u53c8\u6765\u4e86\u4e00\u5927\u6ce2\u50f5\u5c38\uff0c\u8ba9\u6211\u6765\u5e2e\u4f60\u5427",new cc.Vec2(-602,-90));break;case 13:f.default.instance().zombieFinish=!0,this.guidePanel.getChildByName("GuideFinger").getComponent(sp.Skeleton).skeletonData=u.default.instance.getBundleRes("Spine","guide/yindao3/yindao3",sp.SkeletonData),this.guidePanel.getChildByName("GuideFinger").getComponent(sp.Skeleton).setAnimation(0,"daoda0",!0),this.headImg.spriteFrame=u.default.instance.getBundleRes("BundleTexture","GuideUI/p2",cc.SpriteFrame),this.showFinger("\u5c06\u6211\u79cd\u5728\u8fd9\u91cc",new cc.Vec2(-155,-57)),i.default.instance.eventReport("\u653e\u4e0b\u706b\u7130\u82b1");break;case 14:this.goldNums-=300,this.cardPanel.children[4].getChildByName("Cost").active=!0,this.hideFinger(),this.plantPanel.getChildByName("huoyanhua").active=!0,this.plantPanel.getChildByName("huoyanhua").getComponent(c.default).play(2,2)}}showFinger(e,t){this.gamePause(),this.guidePanel.getChildByName("Mask").active=!1,this.guidePanel.getChildByName("GuidePanel").active=!0,this.guidePanel.getChildByName("GuidePanel").getComponentInChildren(cc.Label).string=e,this.guidePanel.getChildByName("NextStep").active=!1,this.guidePanel.getChildByName("GuideFinger").active=!0,this.guidePanel.getChildByName("GuideFinger").setPosition(t),this.guidePanel.getChildByName("HighLight").active=!0,this.guidePanel.getChildByName("HighLight").setPosition(t)}hideFinger(){this.gameResume(),this.guidePanel.getChildByName("GuideFinger").active=!1,this.guidePanel.getChildByName("GuidePanel").active=!1,this.guidePanel.getChildByName("HighLight").active=!1,this.guidePanel.getChildByName("Mask").active=!0}gamePause(){for(let e=0;e<this.plantPanel.childrenCount;e++)-1==this.plantPanel.children[e].name.indexOf("xrk")&&(this.plantPanel.children[e].getComponent(c.default).isPause=!0);for(let e=0;e<this.zombiePanel.childrenCount;e++)this.zombiePanel.children[e].getComponent(d.default).time=0,this.zombiePanel.children[e].getComponent(d.default).dragon.timeScale=0;for(let e=0;e<this.zombiePanel2.childrenCount;e++)this.zombiePanel2.children[e].getComponent(d.default).time=0,this.zombiePanel2.children[e].getComponent(d.default).dragon.timeScale=0}gameResume(){for(let e=0;e<this.plantPanel.childrenCount;e++)-1==this.plantPanel.children[e].name.indexOf("xrk")&&(this.plantPanel.children[e].getComponent(c.default).isPause=!1);for(let e=0;e<this.zombiePanel.childrenCount;e++)this.zombiePanel.children[e].getComponent(d.default).time=1,this.zombiePanel.children[e].getComponent(d.default).dragon.timeScale=1;for(let e=0;e<this.zombiePanel2.childrenCount;e++)this.zombiePanel2.children[e].getComponent(d.default).time=1,this.zombiePanel2.children[e].getComponent(d.default).dragon.timeScale=1}win(){this.scheduleOnce(()=>{p.default.instance.closeUI("GuideUI"),p.default.instance.openUI("SuccessUI"),i.default.instance.eventReport("\u5f15\u5bfc\u7ed3\u675f")},2)}};v=n([b],v),a.default=v,cc._RF.pop()},{"../ADlibs/Hts":"Hts","../Manager/AudioManager":"AudioManager","../Manager/BundleManager":"BundleManager","../Manager/DataManager":"DataManager","../Manager/UIManager":"UIManager","../Manager/ZombieMgr":"ZombieMgr","../TaSdk/TaSdk":"TaSdk","../entity/Gold":"Gold","../entity/Plant/Plant10":"Plant10","../entity/Plant/Plant2":"Plant2","../entity/Plant/Plant21":"Plant21","../entity/Plant/PlantBase":"PlantBase","../entity/Zombie/Zombie":"Zombie","../scene_stage/SceneStage":"SceneStage","../utils/KDefine":"KDefine"}],Hts:[function(e,t,a){"use strict";cc._RF.push(t,"3d7078Ed8tOGZKGENMasO1b","Hts"),Object.defineProperty(a,"__esModule",{value:!0}),a.hts=void 0;const n=e("../ADManager/ADManager"),i=e("./htSdk");class s{constructor(){this.htSdk=i.default}static get instance(){return s.me?s.me:(s.me=new s,s.me)}getUid(){return this.htSdk.getUid()}init(e,t){let a;if(!n.default.instance.isTest){switch(n.default.instance.sdkType){case n.SDK_TYPE.Byte:a="62e779e07a6efc2a5c2543a4";break;case n.SDK_TYPE.WeChat:a="62f080c37a6efc2a5c288550"}this.htSdk.init(a,e,t)}}getBox(e,t){this.htSdk.getBox(e,t)}jumpFrom(e){this.htSdk.jumpFrom(e)}jumpTo(e,t){this.htSdk.jumpTo(e,t)}jumpFail(e,t){this.htSdk.jumpFail(e,t)}navigateToMiniProgram(e,t){this.htSdk.navigateToMiniProgram(e,t)}bindOpenId(e,t){this.htSdk.bindOpenId(e,t)}codeForOpenId(e,t){this.htSdk.codeForOpenId(e,t)}stageStart(e,t){this.htSdk.stageStart(e,t)}stageFail(e,t){this.htSdk.stageFail(e,t)}stageComplet(e,t){this.htSdk.stageComplet(e,t)}stageLog(e,t,a){this.htSdk.stageLog(e,t,a)}userUpdate(e){this.htSdk.userUpdate(e)}eventReport(e,t,a){n.default.instance.isTest?console.log(e):this.htSdk.eventReport(e,t,a)}sceneReport(e,t,a){this.htSdk.sceneReport(e,t,a)}getSharePic(e,t){this.htSdk.getSharePic(e,t)}shareTo(e){this.htSdk.shareTo(e)}shareFrom(e){this.htSdk.shareFrom(e)}jreq(e,t,a){this.htSdk.jreq(e,t,a)}}a.default=s,a.hts=s.instance,cc._RF.pop()},{"../ADManager/ADManager":"ADManager","./htSdk":"htSdk"}],HuaWeiAD:[function(e,t,a){"use strict";cc._RF.push(t,"dff1eJgO6JFXYO4yJoO4S+o","HuaWeiAD");var n,i=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const s=e("../Interface/ADInterface"),l=e("./HuaWeiConstant"),{ccclass:o,property:r}=cc._decorator;let c=n=class extends s.default{constructor(){super(...arguments),this.nativeTime=0,this.lastClickTime=0,this.isShare=!1}initAd(){this.creatBanner(),this.createVideo()}static login(){qg.gameLoginWithReal({forceLogin:1,appid:"106538773",success:e=>{n.isLogin=!0,console.log("playerid===",e)},fail:(e,t)=>{n.isLogin=!1,qg.showToast({title:"\u767b\u9646\u5931\u8d25"}),console.log("data==",e),console.log("code==",t)}})}creatNative(e){let t=qg.getSystemInfoSync().windowWidth,a=qg.getSystemInfoSync().windowHeight;switch(console.log("type===1",e),e){case 0:this.customAd1=qg.createCustomAd({adUnitId:l.default.POSID_NativeAD[0],style:{left:0,top:a/2-720*t/1280+100}}),this.customAd1.onError(e=>{console.log("\u534e\u4e3a\u539f\u751f err:",JSON.stringify(e))})}}showNative(e){if((new Date).getTime()-this.nativeTime<6e4)console.log("\u95f4\u9694\u65f6\u95f4\u4e0d\u8db3");else switch(e||(e=0),this.hideNative(),this.creatNative(e),console.log("shownative==="),e){case 0:this.customAd1.show().then(()=>{console.log("\u539f\u751f\u5e7f\u544a\u52a0\u8f7d\u6210\u529f"),this.nativeTime=(new Date).getTime()}).catch(e=>{console.log("\u539f\u751f\u5e7f\u544a\u5c55\u793a\u5931\u8d25222:"+JSON.stringify(e))})}}hideNative(){this.customAd1&&this.customAd1.destroy(),this.customAd2&&this.customAd2.destroy()}creatInsert(){this.insertAd=qg.createInterstitialAd({adUnitId:l.default.POSID_InsertAD})}createVideo(){this.rewardVideoAd=qg.createRewardedVideoAd({adUnitId:l.default.POSID_VedioAD}),this.rewardVideoAd.load()}showVideo(e){null!=this.rewardVideoAd&&null!=this.rewardVideoAd?this.isFastClick()||(cc.game.pause(),this.rewardVideoAd.offClose(),this.rewardVideoAd.show(),this.rewardVideoAd.load(),this.rewardVideoAd.offError(),this.rewardVideoAd.onError(()=>{this.showToast("\u6682\u65e0\u5e7f\u544a"),cc.game.resume()}),this.rewardVideoAd.onClose(t=>{t&&t.isEnded||void 0===t?(e&&e(),this.showToast("\u5956\u52b1\u9886\u53d6\u6210\u529f"),cc.game.resume()):(this.showToast("\u64ad\u653e\u4e2d\u9014\u9000\u51fa"),cc.game.resume())})):this.createVideo()}showToast(e){qg.showToast({title:e})}static canShowInsert(){return(new Date).getTime()-this.insertIntervalTime<6e4?(console.log("\u63d2\u5c4f\u663e\u793a\u95f4\u9694\u65f6\u95f4\u4e0d\u8db3"),!1):(console.log("\u53ef\u4ee5\u663e\u793a\u63d2\u5c4f"),this.insertIntervalTime=(new Date).getTime(),!0)}showInsert(){this.creatInsert();let e=this;this.insertAd.load(),this.insertAd.onLoad(()=>{e.insertAd.show()}),this.insertAd.onError(function(t){e.log("\u63d2\u5c4f\u5e7f\u544a\u52a0\u8f7d\u51fa\u9519\uff1a "+JSON.stringify(t)),e.insertAd&&(e.insertAd.destroy(),e.insertAd=null)}),this.insertAd.onClose(function(t){e.log("\u63d2\u5c4f\u5e7f\u544a\u5173\u95ed:"+t),e.insertAd&&e.insertAd.destroy()})}isFastClick(){return 0!==this.lastClickTime&&(new Date).getTime()-this.lastClickTime<500||(this.lastClickTime=(new Date).getTime(),!1)}creatBanner(){qg.getSystemInfoSync().screenWidth;let e=qg.getSystemInfoSync().screenHeight;this.bannerAd=qg.createBannerAd({adUnitId:l.default.POSID_BannerAD,style:{top:e-57,left:0,width:360,height:57},adIntervals:30}),this.bannerAd.onError(e=>{this.bannerAd=null,console.log("initBanner err==:"),console.log(e.errMsg),console.log(e.errCode)})}requestSubscribeSystemMessage(e){}onAddToFavorites(){}showBanner(){console.log("banner===="),this.bannerAd||this.creatBanner(),this.bannerAd.show().then(()=>{console.log("banner\u52a0\u8f7d\u6210\u529f")}).catch(e=>{console.log("showBanner err:"+JSON.stringify(e))})}hideBanner(){null!=this.bannerAd&&this.bannerAd.hide()}recorderStart(){}recorderStop(){}share(e){}canShare(){return!((new Date).getTime()-this.shareTime<3e3||(this.shareTime=(new Date).getTime(),0))}addShortcut(){}exitGame(){qg.exitApplication({})}log(e){console.log("WeChatAD:"+e)}};c.insertIntervalTime=0,c.isLogin=!1,c=n=i([o],c),a.default=c,cc._RF.pop()},{"../Interface/ADInterface":"ADInterface","./HuaWeiConstant":"HuaWeiConstant"}],HuaWeiConstant:[function(e,t,a){"use strict";cc._RF.push(t,"0c5ceUuonFGrpnsvy+1tQwQ","HuaWeiConstant"),Object.defineProperty(a,"__esModule",{value:!0});class n{}a.default=n,n.POSID_NativeAD=[""],n.POSID_BannerAD="e73nhr0b8i",n.POSID_InsertAD="j44xqybujo",n.POSID_VedioAD="r8wwrj1pwh",n.appId="105554091",cc._RF.pop()},{}],IOSConstant:[function(e,t,a){"use strict";cc._RF.push(t,"3b55amDz5xFkpYIHG/O3Pxu","IOSConstant"),Object.defineProperty(a,"__esModule",{value:!0});class n{}a.default=n,n.hideLevel=!0,cc._RF.pop()},{}],KDefine:[function(e,t,a){"use strict";cc._RF.push(t,"422adCvz45KUY78AzFNMHUf","KDefine"),Object.defineProperty(a,"__esModule",{value:!0}),a.AudioName=a.ZIndex=a.AimType=a.ZombieType=a.Tag=a.State=a.DragonArmature=a.BulletId=void 0,function(e){e.b1="01_wandousheshou",e.b2="02_caiwen",e.b3="03_hanbingsheshou",e.b4="04_juanxincai",e.b5="05_huixuanbiao",e.b6="06_shandianluwei",e.b7="07_dapengu",e.b8="08_qiangsuanningmeng",e.b9="feijian",e.b10="10_xiangrikui",e.b11="11_huoyansheshou",e.b12="12_yangguanggu",e.b13="13_maoweicao",e.b14="14_hongzhenhua",e.b15="15_xiguatoushou",e.b16="16_jiguangdou",e.b17="17_huochaihuaquanshou",e.b18="18_bianshenqiezi",e.b19="19_duyinggu",e.b20="20_chaonenghuacai",e.b21="21_anyingsheshou",e.b22="22_dianliuculi1",e.b23="23_youmutoushou",e.b24="24_jiqiangwandou",e.b25="25_meiguijianke",e.b26="26_huoyanhuanvwang",e.b27="27_bingxianzi",e.b28="28_moshugu",e.b29="29_dianlongcao",e.b30="30_xiongguojiupao"}(a.BulletId||(a.BulletId={})),function(e){e.move="move",e.gongji="gongji",e.qianjing="qianjing",e.dead="dead",e.death="death",e.daiji="daiji",e.attack="attack",e.kenyao="kenyao",e.siwang="siwang"}(a.DragonArmature||(a.DragonArmature={})),function(e){e.idle="idle",e.init="init",e.normal="normal",e.move="move",e.moveing="moveing",e.wait="wait",e.waiting="waiting",e.attack="attack",e.attacking="attacking",e.play="play",e.stop="stop",e.pause="pause",e.hurt="hurt",e.hurting="hurting",e.dead="dead",e.deading="deading",e.lock="lock"}(a.State||(a.State={})),function(e){e[e.plant=1]="plant",e[e.bullet=2]="bullet",e[e.zombie=3]="zombie",e[e.car=4]="car",e[e.bossLeg=5]="bossLeg",e[e.bossHead=6]="bossHead"}(a.Tag||(a.Tag={})),function(e){e[e.normal=0]="normal",e[e.boss=1]="boss",e[e.bigBoss=2]="bigBoss"}(a.ZombieType||(a.ZombieType={})),function(e){e[e.right=0]="right",e[e.left=1]="left",e[e.bezierRight=2]="bezierRight",e[e.bezierLeft=3]="bezierLeft",e[e.rightRemote=4]="rightRemote"}(a.AimType||(a.AimType={})),function(e){e[e.map=0]="map",e[e.dropItem=10]="dropItem",e[e.teasure=20]="teasure",e[e.plant=100]="plant",e[e.enemy=200]="enemy",e[e.boss=250]="boss",e[e.bullet=300]="bullet",e[e.damageTxt=400]="damageTxt",e[e.ui=500]="ui",e[e.ui_popup=600]="ui_popup"}(a.ZIndex||(a.ZIndex={})),function(e){e.MenuBgm="MenuBgm",e.MainBgm="MainBgm",e.FailBgm="FailBgm",e.SuccessBgm="SuccessBgm",e.UpgradeEff="UpgradeEff",e.ZombieAttackEff="ZombieAttackEff",e.CarEff="CarEff",e.PickSunEff="PickSunEff",e.PutPlantEff="PutPlantEff",e.ZombieArriveEff="ZombieArriveEff",e.ShovelEff="ShovelEff",e.FinalZombieEff="FinalZombieEff",e.BossBgm="BossBgm"}(a.AudioName||(a.AudioName={})),cc._RF.pop()},{}],KuangDian:[function(e,t,a){"use strict";cc._RF.push(t,"b5cfcKGZo5J+raaam2UWMRk","KuangDian");var n,i=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const s=e("../../../Manager/UIManager"),l=e("../../ADManager"),o=e("./WeChatTime"),{ccclass:r,property:c}=cc._decorator;let d=n=class extends cc.Component{constructor(){super(...arguments),this.prog=null,this.isShowBanner=!1}static get instance(){return this._instance}onLoad(){console.log("kuangdian=="),n._instance=this,l.default.instance.hideNative(),l.default.instance.hideBanner()}onClickBtn(){this.prog.progress+=.1}update(e){o.default.videoTime=0,this.prog.progress-=.1*e,this.prog.progress<0?this.prog.progress=0:this.prog.progress>1&&(this.prog.progress=1,l.default.instance.hideBanner(),this.node.destroy())}onDestroy(){l.default.instance.showBanner(),s.default.instance.uiList[s.UIName.LevelUI]&&(l.default.instance.showNative(1),l.default.instance.showNative(2))}};d._instance=null,i([c(cc.ProgressBar)],d.prototype,"prog",void 0),d=n=i([r],d),a.default=d,cc._RF.pop()},{"../../../Manager/UIManager":"UIManager","../../ADManager":"ADManager","./WeChatTime":"WeChatTime"}],LoadScene:[function(e,t,a){"use strict";cc._RF.push(t,"dfcdcApr/5K1K/Yll9um8zS","LoadScene");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const i=e("../ADlibs/Hts"),s=e("../ADManager/AD/WeChat/WeChatConstant"),l=e("../ADManager/ADManager"),o=e("../ADManager/SwitchNet/GameSwitch"),r=e("../Manager/AudioManager"),c=e("../Manager/BundleManager"),d=e("../Manager/DataManager"),h=e("../Manager/ExcelManager"),u=e("../Manager/UserDataManager"),g=e("../TaSdk/TaSdk"),{ccclass:p,property:f}=cc._decorator;let m=class extends cc.Component{constructor(){super(...arguments),this.progress=null,this.loading=null,this.step=-1,this.bundleCount=12,this.bundleLoad=0,this.preloadCount=4,this.preloadFinish=0,this.progressNumber1=0,this.progressNumber2=0,this.progressNumber3=0,this.progressNumber4=0,this.length=0,this.dataName=[h.TableName.bulletTable,h.TableName.levelTable,h.TableName.plantTable,h.TableName.zombieTable,h.TableName.lotteryTable,h.TableName.guideTable]}onLoad(){cc.dynamicAtlasManager.maxFrameSize=1024,cc.director.getCollisionManager().enabled=!0,l.default.instance.init(),g.default.instance.init(),this.initUserData(),g.default.instance.setSuperProperties({channel:l.default.instance.sdkType,gameversion:l.default.instance.version,gameid:5053}),g.default.instance.userSetOnce({tracetime:Date.now(),channel:l.default.instance.sdkType,gameversion:l.default.instance.version,gameid:5053}),o.default.requestHttpGetGameSwitch(),cc.director.preloadScene("MainScene"),i.default.instance.init(void 0,(e,t)=>{console.log("err===",e),console.log("re===1",t),i.default.instance.eventReport("\u8fdb\u5165\u6e38\u620f"),l.default.instance.sdkType==l.SDK_TYPE.WeChat&&i.default.instance.bindOpenId(s.default.openID,()=>{})}),g.default.instance.postEvent("Loading",{loading_step:1}),this.str="\u52a0\u8f7d\u4e2d......",this.nextStep(),this.schedule(()=>{this.length++,this.length=this.length%6,this.loading.string=this.str.slice(0,this.length+3)},.5)}onClickAgePanel(){this.node.getChildByName("AgePanel").active=!0}nextStep(){switch(this.step++,this.step){case 0:let e=()=>{this.bundleLoad++,this.bundleLoad==this.bundleCount&&this.nextStep()};c.default.instance.loadBundle("Spine").then(e),c.default.instance.loadBundle("Audio").then(e),c.default.instance.loadBundle("Prefab").then(e),c.default.instance.loadBundle("BundleTexture").then(e),c.default.instance.loadBundle("Data").then(()=>{c.default.instance.loadBundleRes("Data","./bullet",cc.TextAsset,(t,a)=>{h.ExcelMgr.instance.AddExcelTable(h.TableName.bulletTable,a.text),e()}),c.default.instance.loadBundleRes("Data","./level",cc.TextAsset,(t,a)=>{h.ExcelMgr.instance.AddExcelTable(h.TableName.levelTable,a.text),e()}),c.default.instance.loadBundleRes("Data","./plant",cc.TextAsset,(t,a)=>{h.ExcelMgr.instance.AddExcelTable(h.TableName.plantTable,a.text),h.ExcelMgr.instance.AddExcelArrTable(h.TableName.plantTable,a.text),e()}),c.default.instance.loadBundleRes("Data","./zombie",cc.TextAsset,(t,a)=>{h.ExcelMgr.instance.AddExcelTable(h.TableName.zombieTable,a.text),e()}),c.default.instance.loadBundleRes("Data","./lottery",cc.TextAsset,(t,a)=>{h.ExcelMgr.instance.AddExcelTable(h.TableName.lotteryTable,a.text),e()}),c.default.instance.loadBundleRes("Data","./shop",cc.TextAsset,(t,a)=>{h.ExcelMgr.instance.AddExcelTable(h.TableName.shopTable,a.text),e()}),c.default.instance.loadBundleRes("Data","./price",cc.TextAsset,(t,a)=>{h.ExcelMgr.instance.AddExcelTable(h.TableName.priceTable,a.text),e()}),c.default.instance.loadBundleRes("Data","./guide",cc.TextAsset,(t,a)=>{h.ExcelMgr.instance.AddExcelTable(h.TableName.guideTable,a.text),e()})});break;case 1:g.default.instance.postEvent("Loading",{loading_step:2});let t=()=>{this.preloadFinish++,this.preloadCount==this.preloadFinish&&this.nextStep()};c.default.instance.preLoadBundleDir("Spine","",null,(e,t)=>{this.progressNumber1=e/(t*this.preloadCount),this.updateProgress()},()=>{t()}),c.default.instance.preLoadBundleDir("Prefab","",null,(e,t)=>{this.progressNumber2=e/(t*this.preloadCount),this.updateProgress()},()=>{t()}),c.default.instance.preLoadBundleDir("BundleTexture","",cc.SpriteFrame,(e,t)=>{this.progressNumber3=e/(t*this.preloadCount),this.updateProgress()},()=>{t()}),c.default.instance.preLoadBundleDir("Audio","",cc.AudioClip,(e,t)=>{this.progressNumber4=e/(t*this.preloadCount),this.updateProgress()},()=>{t()});break;case 2:g.default.instance.postEvent("Loading",{loading_step:3}),g.default.instance.setUserData(),cc.Button.prototype._onTouchEnded=function(e){r.default.instance.playEffect("BtnClick"),this.interactable&&this.enabledInHierarchy&&(this._pressed&&(cc.Component.EventHandler.emitEvents(this.clickEvents,e),this.node.emit("click",this)),this._pressed=!1,this._updateState(),e.stopPropagation())},this.nextStep();break;case 3:d.default.instance.init(),u.default.instance.isNewDay(),this.nextStep();break;default:i.default.instance.eventReport("\u6e38\u620f\u4e3b\u9875"),cc.director.loadScene("MainScene")}}updateProgress(){let e=this.progressNumber1+this.progressNumber2+this.progressNumber3+this.progressNumber4;this.progress.progress=e,this.progress.node.getChildByName("j001").x=1200*e}initUserData(){let e=cc.sys.localStorage.getItem(u.default.instance._userDataKey);console.log("initUserData2222 \u672c\u5730\u6570\u636e====>>",e),e?(console.log("\u672c\u5730\u6570\u636e====>>"),u.default.instance._userData=JSON.parse(e),g.default.instance.postEvent("login",{is_new:0}),u.default.instance.is_new=!1):(console.log("\u6ca1\u6709\u672c\u5730\u6570\u636e!"),g.default.instance.postEvent("login",{is_new:1}),u.default.instance.is_new=!0,u.default.instance.init(),u.default.instance.writeStorage()),g.default.instance.setSuperProperties({is_new:u.default.instance.is_new})}};n([f({type:cc.ProgressBar,displayName:"\u8fdb\u5ea6\u6761"})],m.prototype,"progress",void 0),n([f(cc.Label)],m.prototype,"loading",void 0),m=n([p],m),a.default=m,cc._RF.pop()},{"../ADManager/AD/WeChat/WeChatConstant":"WeChatConstant","../ADManager/ADManager":"ADManager","../ADManager/SwitchNet/GameSwitch":"GameSwitch","../ADlibs/Hts":"Hts","../Manager/AudioManager":"AudioManager","../Manager/BundleManager":"BundleManager","../Manager/DataManager":"DataManager","../Manager/ExcelManager":"ExcelManager","../Manager/UserDataManager":"UserDataManager","../TaSdk/TaSdk":"TaSdk"}],MainScene:[function(e,t,a){"use strict";cc._RF.push(t,"9413871xNFBToZ3vxq0NNjH","MainScene");var n,i=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const s=e("../ADlibs/Hts"),l=e("../ADManager/AD/WeChat/WeChatConstant"),o=e("../ADManager/ADManager"),r=e("../Manager/BulletMgr"),c=e("../Manager/DataManager"),d=e("../Manager/UIManager"),h=e("../Manager/UserDataManager"),u=e("../Manager/ZombieMgr"),g=e("../TaSdk/TaSdk"),p=e("../utils/kc"),{ccclass:f,property:m}=cc._decorator;let y=n=class extends cc.Component{constructor(){super(...arguments),this.playTime=0}static get instance(){return this._instance}onLoad(){this.schedule(()=>{this.playTime++,s.default.instance.eventReport("\u6e38\u620f"+this.playTime+"\u5206\u949f")},60,19),g.default.instance.postEvent("Loading",{loading_step:4}),this.schedule(()=>{h.default.instance.onlineNum<=2&&h.default.instance.onlineTime++},1),console.log("------"),n._instance=this,p.default.init(),r.default.instance().init(),u.default.instance().initPool(),o.default.instance.sdkType==o.SDK_TYPE.WeChat&&l.default.firstJuzhen&&d.default.instance.openUI("MoreGameUI",999),h.default.instance.newUser?(c.default.instance.level=0,d.default.instance.openUI("MainUI")):d.default.instance.openUI("MenuUI")}};y._instance=null,y=n=i([f],y),a.default=y,cc._RF.pop()},{"../ADManager/AD/WeChat/WeChatConstant":"WeChatConstant","../ADManager/ADManager":"ADManager","../ADlibs/Hts":"Hts","../Manager/BulletMgr":"BulletMgr","../Manager/DataManager":"DataManager","../Manager/UIManager":"UIManager","../Manager/UserDataManager":"UserDataManager","../Manager/ZombieMgr":"ZombieMgr","../TaSdk/TaSdk":"TaSdk","../utils/kc":"kc"}],MenuUI:[function(e,t,a){"use strict";cc._RF.push(t,"65138u6/nJLT7JXCZUCkMFZ","MenuUI");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const i=e("../ADlibs/Hts"),s=e("../ADManager/ADManager"),l=e("../Manager/AudioManager"),o=e("../Manager/BundleManager"),r=e("../Manager/DataManager"),c=e("../Manager/PlantMgr"),d=e("../Manager/UIManager"),h=e("../Manager/UserDataManager"),u=e("../TaSdk/TaSdk"),g=e("../utils/KDefine"),{ccclass:p,property:f}=cc._decorator;let m=class extends cc.Component{constructor(){super(...arguments),this.guideString=["\u70b9\u51fb\u8fd9\u91cc\u8fdb\u5165\u5173\u5361","\u70b9\u51fb\u8fd9\u91cc\u6765\u62bd\u5956\u5427","\u70b9\u51fb\u8fd9\u91cc\u53ef\u4ee5\u8fdb\u884cboss\u6311\u6218\uff0c\u73b0\u5728\u5b9e\u529b\u8fd8\u4e0d\u591f\u54e6\uff0c\u83b7\u5f97\u66f4\u591a\u5f3a\u529b\u690d\u7269\u518d\u6765\u6311\u6218\u5427\uff01"]}onLoad(){if(this.registerEvent(),l.default.instance.playMusic(g.AudioName.MenuBgm,!0),r.default.instance.clearTempData(),cc.find("Canvas/Bg").getComponent(cc.Sprite).spriteFrame=o.default.instance.getBundleRes("BundleTexture","MenuUI/Bg1",cc.SpriteFrame),cc.find("Canvas/Bg").x=0,d.default.instance.showUI("MoneyPanelUI",30),this.guidePanel=this.node.getChildByName("GuidePanel"),this.guidePanel.zIndex=90,this.bg1=this.node.getChildByName("BgPanel").getChildByName("Bg1"),this.bg2=this.node.getChildByName("BgPanel").getChildByName("Bg2"),this.bg3=this.node.getChildByName("BgPanel").getChildByName("Bg3"),this.bg2.on(cc.Node.EventType.TOUCH_MOVE,this.bg2Move,this),this.effectPanel=this.bg1.getChildByName("EffectPanel"),this.btnPanel=this.bg1.getChildByName("BtnPanel"),this.playAnimation(),this.initBtnPanel(),this.showNode(),h.default.instance.newUser&&(h.default.instance.newUser=!1),r.default.instance.focus)if(h.default.instance.level>2)h.default.instance.level>3&&(this.bg1.x-=this.btnPanel.children[h.default.instance.level-2].x,this.bg2.x=(this.bg1.x+667.5)/2-667.5,this.bg3.x=(this.bg1.x+667.5)/4-667.5),cc.tween(this.bg1).delay(.5).by(1,{x:-(this.btnPanel.children[h.default.instance.level-1].x-this.btnPanel.children[h.default.instance.level-2].x)}).call(()=>{r.default.instance.focus=!1,this.btnPanel.children[h.default.instance.level-1].getChildByName("Bg").getComponent(cc.Sprite).spriteFrame=o.default.instance.getBundleRes("BundleTexture","MenuUI/z002",cc.SpriteFrame);let e=cc.instantiate(o.default.instance.getBundleRes("Prefab","Object/BtnEffect"));this.btnPanel.children[h.default.instance.level-1].addChild(e),e.getComponentInChildren(sp.Skeleton).setAnimation(0,"FX",!1),e.getComponentInChildren(sp.Skeleton).setCompleteListener(()=>{e.getComponentInChildren(sp.Skeleton).setCompleteListener(null),e.getComponentInChildren(sp.Skeleton).setAnimation(0,"FX1",!0)})}).start(),cc.tween(this.bg2).delay(.5).by(1,{x:-(this.btnPanel.children[h.default.instance.level-1].x-this.btnPanel.children[h.default.instance.level-2].x)}).start(),cc.tween(this.bg3).delay(.5).by(1,{x:-(this.btnPanel.children[h.default.instance.level-1].x-this.btnPanel.children[h.default.instance.level-2].x)}).start();else{r.default.instance.focus=!1,this.btnPanel.children[h.default.instance.level-1].getChildByName("Bg").getComponent(cc.Sprite).spriteFrame=o.default.instance.getBundleRes("BundleTexture","MenuUI/z002",cc.SpriteFrame);let e=cc.instantiate(o.default.instance.getBundleRes("Prefab","Object/BtnEffect"));this.btnPanel.children[h.default.instance.level-1].addChild(e),e.getComponentInChildren(sp.Skeleton).setAnimation(0,"FX",!1),e.getComponentInChildren(sp.Skeleton).setCompleteListener(()=>{e.getComponentInChildren(sp.Skeleton).setCompleteListener(null),e.getComponentInChildren(sp.Skeleton).setAnimation(0,"FX1",!0)})}else this.initBg();0!=r.default.instance.lockPlant?d.default.instance.openUI("UnLockPlantUI"):h.default.instance.upGradeGuide||d.default.instance.openUI("GuideUI2",99).emit("init",2),r.default.instance.newChapter?this.newChapter():this.node.getChildByName("Title").getComponent(cc.RichText).string=`<color=#FFBD00>\u8ddd\u79bb\u7b2c</color><color=#FFFFFF><b><size=50> ${h.default.instance.chapter+1} </size></b></color><color=#FFBD00>\u5929\u8fd8\u6709</color><color=#FFFFFF><b><size=50> ${21-h.default.instance.level} </size></b></color><color=#FFBD00>\u5173</color>`,r.default.instance.drawGuide&&d.default.instance.openUI("GuideUI2",99).emit("init",4),h.default.instance.bossGuide||(this.node.getChildByName("BtnPanel").getChildByName("BossBtn").active=!1),r.default.instance.bossGuide&&this.bossGuide(),this.initPlatform(),this.schedule(()=>{this.refreshOnlineBtn()},1)}registerEvent(){this.node.on("onClickUpgradeBtn",this.onClickUpgradeBtn,this),this.node.on("onClickDrawBtn",this.onClickDrawBtn,this)}bossGuide(){let e=cc.instantiate(o.default.instance.getBundleRes("Prefab","Object/GuideFinger",cc.Prefab));this.node.getChildByName("BtnPanel").getChildByName("BossBtn").active=!0,this.node.getChildByName("BtnPanel").getChildByName("BossBtn").addChild(e),e.x=0,e.y=13,this.guideToast(this.guideString[2])}newChapter(){r.default.instance.newChapter=!1,this.node.getChildByName("Cloud").active=!0,this.node.getChildByName("Cloud").getComponent(cc.Animation).play(),this.node.getChildByName("Title").getComponent(cc.RichText).string=`<color=#FFBD00>\u8ddd\u79bb\u7b2c</color><color=#FFFFFF><b><size=50> ${h.default.instance.chapter+1} </size></b></color><color=#FFBD00>\u5929\u8fd8\u6709</color><color=#FFFFFF><b><size=50>1 </size></b></color><color=#FFBD00>\u5173</color>`,h.default.instance.level=1,h.default.instance.chapter++,this.scheduleOnce(()=>{this.initBtnPanel(),this.bg1.x=-667.5,this.bg2.x=-667.5,this.bg3.x=-667.5},.8),this.node.getChildByName("Cloud").getComponent(cc.Animation).on("stop",()=>{this.node.getChildByName("Title").getComponent(cc.RichText).string=`<color=#FFBD00>\u8ddd\u79bb\u7b2c</color><color=#FFFFFF><b><size=50> ${h.default.instance.chapter+1} </size></b></color><color=#FFBD00>\u5929\u8fd8\u6709</color><color=#FFFFFF><b><size=50> ${21-h.default.instance.level} </size></b></color><color=#FFBD00>\u5173</color>`})}showNode(){this.node.opacity=255,this.refreshSignBtn(),this.refreshUpgradeBtn(),this.refreshOnlineBtn(),!h.default.instance.levelGuide&&h.default.instance.upGradeGuide&&d.default.instance.openUI("GuideUI2",99).emit("init",3),h.default.instance.drawGuide&&!h.default.instance.upGradeGuide2&&d.default.instance.openUI("GuideUI2",99).emit("init",5)}refreshSignBtn(){0==h.default.instance.signTimes?this.node.getChildByName("BtnPanel").getChildByName("SignBtn").getChildByName("Tip").active||(this.node.getChildByName("BtnPanel").getChildByName("SignBtn").getChildByName("Tip").active=!0,this.node.getChildByName("BtnPanel").getChildByName("SignBtn").getComponent(cc.Animation).play()):this.node.getChildByName("BtnPanel").getChildByName("SignBtn").getChildByName("Tip").active&&(this.node.getChildByName("BtnPanel").getChildByName("SignBtn").getChildByName("Tip").active=!1,this.node.getChildByName("BtnPanel").getChildByName("SignBtn").getComponent(cc.Animation).stop(),this.node.getChildByName("BtnPanel").getChildByName("SignBtn").angle=0,this.node.getChildByName("BtnPanel").getChildByName("SignBtn").scale=1)}refreshOnlineBtn(){h.default.instance.onlineTime>=300&&h.default.instance.onlineNum<=2?this.node.getChildByName("BtnPanel").getChildByName("onlineBtn").getChildByName("Tip").active||(this.node.getChildByName("BtnPanel").getChildByName("onlineBtn").getChildByName("Tip").active=!0,this.node.getChildByName("BtnPanel").getChildByName("onlineBtn").getComponent(cc.Animation).play()):this.node.getChildByName("BtnPanel").getChildByName("onlineBtn").getChildByName("Tip").active&&(this.node.getChildByName("BtnPanel").getChildByName("onlineBtn").getChildByName("Tip").active=!1,this.node.getChildByName("BtnPanel").getChildByName("onlineBtn").getComponent(cc.Animation).stop(),this.node.getChildByName("BtnPanel").getChildByName("onlineBtn").angle=0,this.node.getChildByName("BtnPanel").getChildByName("onlineBtn").scale=1)}initPlatform(){switch(s.default.instance.sdkType){case s.SDK_TYPE.WeChat:s.default.instance.showNative(0)}}onClickTestBtn(){s.default.instance.isTest&&(this.node.getChildByName("TestBtn").active?this.node.getChildByName("TestBtn").active=!1:this.node.getChildByName("TestBtn").active=!0)}guideToast(e){this.guidePanel.active=!0,this.guidePanel.getComponentInChildren(cc.Label).string=e}refreshUpgradeBtn(){for(let e=0;e<r.default.instance.plantArray.length;e++){if(!h.default.instance.plantLock.includes(r.default.instance.plantArray[e])&&h.default.instance.getPlantChip(r.default.instance.plantArray[e])>=20)return this.node.getChildByName("BtnPanel").getChildByName("UpgradeBtn").getChildByName("Tip").active=!0,void this.node.getChildByName("BtnPanel").getChildByName("UpgradeBtn").getComponent(cc.Animation).play();if(h.default.instance.plantLock.includes(r.default.instance.plantArray[e])&&h.default.instance.getPlantChip(r.default.instance.plantArray[e])>=c.default.instance().getPlant(r.default.instance.plantArray[e]).costChip[h.default.instance.getPlantLevel(r.default.instance.plantArray[e])-1][1]&&h.default.instance.gold>=c.default.instance().getPlant(r.default.instance.plantArray[e]).costGold[h.default.instance.getPlantLevel(r.default.instance.plantArray[e])-1][1])return this.node.getChildByName("BtnPanel").getChildByName("UpgradeBtn").getChildByName("Tip").active=!0,void this.node.getChildByName("BtnPanel").getChildByName("UpgradeBtn").getComponent(cc.Animation).play()}this.node.getChildByName("BtnPanel").getChildByName("UpgradeBtn").getChildByName("Tip").active=!1,this.node.getChildByName("BtnPanel").getChildByName("UpgradeBtn").getComponent(cc.Animation).stop(),this.node.getChildByName("BtnPanel").getChildByName("UpgradeBtn").angle=0,this.node.getChildByName("BtnPanel").getChildByName("UpgradeBtn").scale=1}bg2Move(){this.bg2.x=(this.bg1.x+667.5)/2-667.5,this.bg3.x=(this.bg1.x+667.5)/4-667.5}initBg(){h.default.instance.level>2&&(this.bg1.x=-667.5-this.btnPanel.children[h.default.instance.level-1].x,this.bg2.x=(this.bg1.x+667.5)/2-667.5,this.bg3.x=(this.bg1.x+667.5)/4-667.5)}initBtnPanel(){for(let e=0;e<this.btnPanel.childrenCount;e++){if(e<h.default.instance.level-1)this.btnPanel.children[e].getChildByName("Bg").getComponent(cc.Sprite).spriteFrame=o.default.instance.getBundleRes("BundleTexture","MenuUI/z002",cc.SpriteFrame),this.btnPanel.children[e].getChildByName("Star").getComponent(cc.Sprite).spriteFrame=o.default.instance.getBundleRes("BundleTexture","MenuUI/z007",cc.SpriteFrame);else if(e!=h.default.instance.level-1||r.default.instance.focus)this.btnPanel.children[e].getChildByName("Bg").getComponent(cc.Sprite).spriteFrame=o.default.instance.getBundleRes("BundleTexture","MenuUI/z003",cc.SpriteFrame),this.btnPanel.children[e].getChildByName("Star").getComponent(cc.Sprite).spriteFrame=o.default.instance.getBundleRes("BundleTexture","MenuUI/z008",cc.SpriteFrame);else{this.btnPanel.children[e].getChildByName("Bg").getComponent(cc.Sprite).spriteFrame=o.default.instance.getBundleRes("BundleTexture","MenuUI/z002",cc.SpriteFrame);let t=cc.instantiate(o.default.instance.getBundleRes("Prefab","Object/BtnEffect"));this.btnPanel.children[e].addChild(t)}let t=cc.instantiate(o.default.instance.getBundleRes("Prefab","Object/LevelNum"));this.btnPanel.children[e].addChild(t),t.getComponent(cc.Label).string=e+1+""}}playAnimation(){for(let e=0;e<this.effectPanel.childrenCount;e++)cc.tween(this.effectPanel.children[e].children[0]).to(2,{x:this.effectPanel.children[e].width}).call(()=>{this.effectPanel.children[e].children[0].x=0}).union().repeatForever().start(),cc.tween(this.effectPanel.children[e].children[1]).to(5,{x:this.effectPanel.children[e].width}).call(()=>{this.effectPanel.children[e].children[1].x=0}).union().repeatForever().start()}onClickStartBtn(e){h.default.instance.level<parseInt(e.currentTarget.name)||(r.default.instance.bossGuide&&(r.default.instance.bossGuide=!1,h.default.instance.bossGuide=!0),r.default.instance.level=parseInt(e.currentTarget.name),20!=r.default.instance.level?(d.default.instance.openUI("MainUI"),d.default.instance.closeUI("MenuUI")):(r.default.instance.bossLevel=2,d.default.instance.openUI("BossUI"),d.default.instance.closeUI("MenuUI")))}onClickShopBtn(){r.default.instance.bossGuide&&(r.default.instance.bossGuide=!1,h.default.instance.bossGuide=!0,this.guidePanel.active=!1,this.node.getChildByName("BtnPanel").getChildByName("BossBtn").getChildByName("GuideFinger")&&this.node.getChildByName("BtnPanel").getChildByName("BossBtn").getChildByName("GuideFinger").destroy()),d.default.instance.openUI("ShopUI",20),this.node.opacity=0}onClickDrawBtn(){r.default.instance.bossGuide&&(r.default.instance.bossGuide=!1,h.default.instance.bossGuide=!0,this.hideGuide()),d.default.instance.openUI("DrawUI",20),this.node.opacity=0}onClickSignBtn(){r.default.instance.bossGuide&&(r.default.instance.bossGuide=!1,h.default.instance.bossGuide=!0,this.hideGuide()),d.default.instance.openUI("SignUI",20),this.node.opacity=0}onClickUpgradeBtn(){r.default.instance.bossGuide&&(r.default.instance.bossGuide=!1,h.default.instance.bossGuide=!0,this.hideGuide()),d.default.instance.openUI("UpgradeUI",20),this.node.opacity=0}hideGuide(){this.guidePanel.active=!1,this.node.getChildByName("BtnPanel").getChildByName("BossBtn").getChildByName("GuideFinger")&&this.node.getChildByName("BtnPanel").getChildByName("BossBtn").getChildByName("GuideFinger").destroy()}onClickBossBtn(){r.default.instance.bossGuide&&(r.default.instance.bossGuide=!1,h.default.instance.bossGuide=!0,this.hideGuide()),u.default.instance.postEvent("System",{system:"Boss\u6311\u6218"}),i.default.instance.eventReport("\u70b9\u51fb\u6311\u6218BOSS\u6309\u94ae"),d.default.instance.openUI("BossSelectUI")}onClickOnlineBtn(){r.default.instance.bossGuide&&(r.default.instance.bossGuide=!1,h.default.instance.bossGuide=!0,this.hideGuide()),u.default.instance.postEvent("System",{system:"\u5728\u7ebf\u5956\u52b1"}),d.default.instance.openUI("OnlineRewardUI"),this.node.opacity=0}onClickGetPlant(){for(let e=1;e<23;e++)h.default.instance.getPlant(e),r.default.instance.newPlant.includes(e)||r.default.instance.newPlant.push(e)}onClickAddGold(){h.default.instance.gold+=5e3,d.default.instance.showToast("\u91d1\u5e01\u52a05000")}onClickLockLevel(){h.default.instance.level=20,this.initBtnPanel(),d.default.instance.showToast("\u5173\u5361\u5df2\u89e3\u9501")}onClickAddDiamond(){h.default.instance.diamond+=5e3,d.default.instance.showToast("\u94bb\u77f3\u52a05000")}onClearData(){d.default.instance.showToast("\u6570\u636e\u5df2\u6e05\u9664\uff0c\u91cd\u65b0\u8fdb\u6e38\u620f"),cc.sys.localStorage.clear(),cc.game.end()}update(e){this.node.getChildByName("BgPanel").getComponent(cc.ScrollView)._autoScrolling&&(this.bg2.x=(this.bg1.x+667.5)/2-667.5,this.bg3.x=(this.bg1.x+667.5)/4-667.5)}};m=n([p],m),a.default=m,cc._RF.pop()},{"../ADManager/ADManager":"ADManager","../ADlibs/Hts":"Hts","../Manager/AudioManager":"AudioManager","../Manager/BundleManager":"BundleManager","../Manager/DataManager":"DataManager","../Manager/PlantMgr":"PlantMgr","../Manager/UIManager":"UIManager","../Manager/UserDataManager":"UserDataManager","../TaSdk/TaSdk":"TaSdk","../utils/KDefine":"KDefine"}],MoneyPanelUI:[function(e,t,a){"use strict";cc._RF.push(t,"bd92340t99BSJjLvvOp+cXx","MoneyPanelUI");var n,i=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const s=e("../Manager/UIManager"),l=e("../Manager/UserDataManager"),o=e("./NoCoinUI"),{ccclass:r,property:c}=cc._decorator;let d=n=class extends cc.Component{constructor(){super(...arguments),this.diamondNum=null,this.goldNum=null}static get instance(){return this._instance}onLoad(){n._instance=this,this.refreshMoneyPanel()}refreshMoneyPanel(){this.diamondNum.string=l.default.instance.diamond,this.goldNum.string=l.default.instance.gold}onClickAddCoin(){s.default.instance.openUI("NoCoinUI",50).getComponent(o.default).init(0)}onClickAddDiamond(){s.default.instance.openUI("NoCoinUI",50).getComponent(o.default).init(1)}};d._instance=null,i([c(cc.Label)],d.prototype,"diamondNum",void 0),i([c(cc.Label)],d.prototype,"goldNum",void 0),d=n=i([r],d),a.default=d,cc._RF.pop()},{"../Manager/UIManager":"UIManager","../Manager/UserDataManager":"UserDataManager","./NoCoinUI":"NoCoinUI"}],MoreGameUI:[function(e,t,a){"use strict";cc._RF.push(t,"f0d2dcLRolNM6VID3vgvp6Q","MoreGameUI");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const i=e("../../../Manager/UIManager"),s=e("../../ADManager"),l=e("./WeChatConstant"),o=e("./WeChatTime"),{ccclass:r,property:c}=cc._decorator;let d=class extends cc.Component{constructor(){super(...arguments),this.showBanner=!1}onLoad(){l.default.showJuzhen?(this.node.getChildByName("Continue").y*=cc.view.getCanvasSize().height/cc.view.getCanvasSize().width/(1700/750),this.node.getChildByName("Title").y*=cc.view.getCanvasSize().height/cc.view.getCanvasSize().width/(1700/750),s.default.instance.hideBanner(),s.default.instance.showNative(4),this.schedule(()=>{o.default.videoTime=0},1)):i.default.instance.closeUI("MoreGameUI")}onClickClose(){console.log("close===1"),s.default.instance.hideNative(4),i.default.instance.closeUI("MoreGameUI")}};d=n([r],d),a.default=d,cc._RF.pop()},{"../../../Manager/UIManager":"UIManager","../../ADManager":"ADManager","./WeChatConstant":"WeChatConstant","./WeChatTime":"WeChatTime"}],MyUtils:[function(e,t,a){"use strict";cc._RF.push(t,"586e35GY5pDMazic+VoNySB","MyUtils"),Object.defineProperty(a,"__esModule",{value:!0}),a.MyUtils=void 0,function(e){e.getChildByName=function e(t,a){if(t.name==a)return t;const n=t.childrenCount;let i=null;for(let s=0;s<n&&!(i=e(t.children[s],a));++s);return i},e.probability=function(e){var t=Math.random();return Math.round(100*t)<=e},e.getDis=function(e,t,a,n){return Math.sqrt(Math.pow(e-a,2)+Math.pow(t-n,2))},e.getRandomInt=function(e,t){var a=t-e,n=Math.random();return e+Math.floor(n*a)},e.getRandomArr=function(t,a){let n=[];for(let i=0;i<t;i++)if(i==t-1)n.push(a);else{let t=e.getRandomInt(0,a+1);a-=t,n.push(t)}return e.upsetArray(n)},e.removeArrElement=function(e,t){for(var a=0;a<e.length;a++)e[a]==t&&(e.splice(a,1),a--);return e},e.upsetArray=function(e){return e.sort(()=>.5-Math.random()),e},e.randomArray=function(t,a){t=e.upsetArray(t);let n=[];for(let e=0;e<a;e++)n.push(t[e]);return n},e.GPSum=function(e,t,a){return t*(1-Math.pow(e,a))/(1-e)},e.GPN=function(e,t,a){return t*Math.pow(e,a-1)},e.sumPowN=function(e){return e*(e+1)*(2*e+1)/6},e.getAngleX=function(e){let t=e.x,a=e.y,n=t/Math.sqrt(Math.pow(t,2)+Math.pow(a,2)),i=Math.acos(n);return 180/Math.PI*i},e.getPositionbyNode=function(e,t){let a=e.convertToWorldSpace(cc.v2(0,0));return t.convertToNodeSpace(a)},e.getArrRandomValue=function(t){return t[e.getRandomInt(0,t.length)]}}(a.MyUtils||(a.MyUtils={})),cc._RF.pop()},{}],NoCoinUI:[function(e,t,a){"use strict";cc._RF.push(t,"812daBXII1JMLH0Cg33p6L1","NoCoinUI");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const i=e("../ADlibs/Hts"),s=e("../ADManager/ADManager"),l=e("../Manager/BundleManager"),o=e("../Manager/UIManager"),r=e("../Manager/UserDataManager"),c=e("../TaSdk/TaSdk"),{ccclass:d,property:h}=cc._decorator;let u=class extends cc.Component{constructor(){super(...arguments),this.title=null,this.title2=null,this.icon=null}init(e){this.type=e,0==e?(this.title.string="\u91d1\u5e01\u4e0d\u8db3\u662f\u5426\u89c2\u770b\u89c6\u9891\u83b7\u53d6",this.title2.string="\u91d1\u5e01X5000",this.icon.spriteFrame=l.default.instance.getBundleRes("BundleTexture","ui/a034",cc.SpriteFrame),c.default.instance.AdsExposure(c.VideoIndex.goldVideo),c.default.instance.postEvent("System",{system:"\u6dfb\u52a0\u91d1\u5e01"})):(this.title.string="\u94bb\u77f3\u4e0d\u8db3\u662f\u5426\u89c2\u770b\u89c6\u9891\u83b7\u53d6",this.title2.string="\u94bb\u77f3X50",this.icon.spriteFrame=l.default.instance.getBundleRes("BundleTexture","ui/a033",cc.SpriteFrame),c.default.instance.AdsExposure(c.VideoIndex.diamond),c.default.instance.postEvent("System",{system:"\u6dfb\u52a0\u94bb\u77f3"})),this.initPlatform()}initPlatform(){switch(s.default.instance.sdkType){case s.SDK_TYPE.WeChat:this.node.getChildByName("Panel").getChildByName("Bg").getChildByName("Bg2").getChildByName("VideoBtn").x=0,this.node.getChildByName("Panel").getChildByName("Bg").getChildByName("Bg2").getChildByName("CloseBtn").active=!1,this.node.getChildByName("Panel").getChildByName("Bg").getChildByName("Bg2").getChildByName("CloseBtn2").active=!0,s.default.instance.showNative(1),s.default.instance.hideNative(0),s.default.instance.showNative(2),s.default.instance.showNative(3),s.default.instance.showBanner()}}onClickGetReward(){let e,t,a;0==this.type?(e=()=>{r.default.instance.gold+=5e3,this.onClickCloseBtn(),i.default.instance.eventReport("\u9886\u53d6\u91d1\u5e01\u89c6\u9891\u89c2\u770b\u6210\u529f"),c.default.instance.AdsPlayRet(c.VideoIndex.goldVideo,0)},t=()=>{i.default.instance.eventReport("\u9886\u53d6\u91d1\u5e01\u89c6\u9891\u89c2\u770b\u53d6\u6d88"),c.default.instance.AdsPlayRet(c.VideoIndex.goldVideo,1)},a=()=>{c.default.instance.AdsPlayRet(c.VideoIndex.goldVideo,-1),i.default.instance.eventReport("\u9886\u53d6\u91d1\u5e01\u89c6\u9891\u52a0\u8f7d\u5931\u8d25")},c.default.instance.AdsButtonClick(c.VideoIndex.goldVideo)):(e=()=>{r.default.instance.diamond+=50,this.onClickCloseBtn(),c.default.instance.AdsPlayRet(c.VideoIndex.diamond,0),i.default.instance.eventReport("\u9886\u53d6\u94bb\u77f3\u89c6\u9891\u89c2\u770b\u6210\u529f")},t=()=>{c.default.instance.AdsPlayRet(c.VideoIndex.diamond,1),i.default.instance.eventReport("\u9886\u53d6\u94bb\u77f3\u89c6\u9891\u89c2\u770b\u53d6\u6d88")},a=()=>{c.default.instance.AdsPlayRet(c.VideoIndex.diamond,-1),i.default.instance.eventReport("\u9886\u53d6\u94bb\u77f3\u89c6\u9891\u52a0\u8f7d\u5931\u8d25")},c.default.instance.AdsButtonClick(c.VideoIndex.diamond)),s.default.instance.showVideo(e,t)}onClickCloseBtn(){o.default.instance.closeUI("NoCoinUI"),s.default.instance.hideBanner(),s.default.instance.hideNative(2),s.default.instance.hideNative(3),s.default.instance.showNative(0),s.default.instance.hideNative(1)}};n([h(cc.Label)],u.prototype,"title",void 0),n([h(cc.Label)],u.prototype,"title2",void 0),n([h(cc.Sprite)],u.prototype,"icon",void 0),u=n([d],u),a.default=u,cc._RF.pop()},{"../ADManager/ADManager":"ADManager","../ADlibs/Hts":"Hts","../Manager/BundleManager":"BundleManager","../Manager/UIManager":"UIManager","../Manager/UserDataManager":"UserDataManager","../TaSdk/TaSdk":"TaSdk"}],OnlineRewardUI:[function(e,t,a){"use strict";cc._RF.push(t,"ad3ea8bHkNGBqwk5//YVEbn","OnlineRewardUI");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const i=e("../ADlibs/Hts"),s=e("../ADManager/ADManager"),l=e("../Manager/BundleManager"),o=e("../Manager/PlantMgr"),r=e("../Manager/UIManager"),c=e("../Manager/UserDataManager"),d=e("../TaSdk/TaSdk"),h=e("./MenuUI"),{ccclass:u,property:g}=cc._decorator;let p=class extends cc.Component{constructor(){super(...arguments),this.onlineInfo=[],this.timePos=[-225,0,225]}onLoad(){d.default.instance.postEvent("System",{system:"\u5728\u7ebf\u793c\u5305"}),this.bg=this.node.getChildByName("Bg"),this.rewardUI=this.node.getChildByName("RewardUI"),this.plantCard=this.bg.getChildByName("PlantCard"),this.initPlantInfo(),this.initTitle(),c.default.instance.onlineNum<=2&&this.schedule(()=>{this.initTitle()},1)}initTitle(){if(c.default.instance.onlineNum<=2){c.default.instance.onlineTime>=300?(this.bg.getChildByName("Time").active=!1,this.plantCard.children[c.default.instance.onlineNum].getChildByName("Red").active=!0):this.bg.getChildByName("Time").active=!0;let e=Math.floor((300-c.default.instance.onlineTime)/60),t=Math.floor(300-c.default.instance.onlineTime-60*e);e="0"+e,t<10&&(t="0"+t),this.bg.getChildByName("Time").getComponentInChildren(cc.Label).string=e+":"+t}else this.bg.getChildByName("Time").active=!1}initPlantInfo(){this.bg.getChildByName("Time").x=this.timePos[c.default.instance.onlineNum];for(let e=0;e<3;e++){this.onlineInfo.push(c.default.instance.onlineInfo[e]);let t=c.default.instance.onlineInfo[e].id;this.plantCard.children[e].getComponentInChildren(sp.Skeleton).skeletonData=l.default.instance.getBundleRes("Spine","plant/"+o.default.instance().getPlant(t).dragonName+"/"+o.default.instance().getPlant(t).dragonName,sp.SkeletonData),this.plantCard.children[e].getComponentInChildren(sp.Skeleton).setAnimation(0,"daiji",!0),this.onlineInfo[e].get?(this.plantCard.children[e].getChildByName("Mask").active=!0,this.plantCard.children[e].getChildByName("Tip").active=!0,this.plantCard.children[e].getChildByName("Red").active=!1):(this.plantCard.children[e].getChildByName("Tip").active=!1,e>c.default.instance.onlineNum?(this.plantCard.children[e].getChildByName("Mask").active=!0,this.plantCard.children[e].getChildByName("Red").active=!1):this.plantCard.children[e].getChildByName("Mask").active=!1)}}onClickGetReward(){c.default.instance.getPlant(this.onlineInfo[c.default.instance.onlineNum].id),this.onlineInfo[c.default.instance.onlineNum].get=!0,c.default.instance.onlineNum++,c.default.instance.onlineTime=0,this.initPlantInfo(),this.initTitle(),this.node.getChildByName("RewardUI").active=!1}onClickCard(e){let t=e.currentTarget;t.getChildByName("Red").opacity=0,t.getComponent(cc.Animation).play(),t.getComponent(cc.Animation).on("stop",()=>{this.showReward()})}showReward(){let e=this.onlineInfo[c.default.instance.onlineNum].id;c.default.instance.plantLock.includes(e)?this.node.getChildByName("RewardUI").getChildByName("RewardSingle").getChildByName("TipLabel").active=!0:this.node.getChildByName("RewardUI").getChildByName("RewardSingle").getChildByName("TipLabel").active=!1,this.node.getChildByName("RewardUI").active=!0,this.node.getChildByName("RewardUI").getChildByName("RewardSingle").getChildByName("PlantAni").getComponent(sp.Skeleton).skeletonData=l.default.instance.getBundleRes("Spine","plant/"+o.default.instance().getPlant(e).dragonName+"/"+o.default.instance().getPlant(e).dragonName,sp.SkeletonData),this.node.getChildByName("RewardUI").getChildByName("RewardSingle").getChildByName("PlantAni").getComponent(sp.Skeleton).setAnimation(0,"daiji",!0)}onClickVideo(){d.default.instance.AdsButtonClick(d.VideoIndex.online),s.default.instance.showVideo(()=>{i.default.instance.eventReport("\u5728\u7ebf\u5956\u52b1\u89c6\u9891\u770b\u5b8c"),d.default.instance.AdsPlayRet(d.VideoIndex.online,0),c.default.instance.getPlant(this.onlineInfo[c.default.instance.onlineNum].id),c.default.instance.getPlant(this.onlineInfo[c.default.instance.onlineNum].id),this.onlineInfo[c.default.instance.onlineNum].get=!0,c.default.instance.onlineNum++,c.default.instance.onlineTime=0,this.node.getChildByName("RewardUI").active=!1,this.initPlantInfo(),this.initTitle()},()=>{i.default.instance.eventReport("\u5728\u7ebf\u5956\u52b1\u89c6\u9891\u53d6\u6d88"),d.default.instance.AdsPlayRet(d.VideoIndex.online,1)},()=>{d.default.instance.AdsPlayRet(d.VideoIndex.online,-1),i.default.instance.eventReport("\u5728\u7ebf\u5956\u52b1\u89c6\u9891\u52a0\u8f7d\u5931\u8d25")})}onClickCloseBtn(){r.default.instance.closeUI("OnlineRewardUI"),r.default.instance.uiList.MenuUI.getComponent(h.default).showNode()}};p=n([u],p),a.default=p,cc._RF.pop()},{"../ADManager/ADManager":"ADManager","../ADlibs/Hts":"Hts","../Manager/BundleManager":"BundleManager","../Manager/PlantMgr":"PlantMgr","../Manager/UIManager":"UIManager","../Manager/UserDataManager":"UserDataManager","../TaSdk/TaSdk":"TaSdk","./MenuUI":"MenuUI"}],OppoAD:[function(e,t,a){"use strict";cc._RF.push(t,"2b420FjkINPAYZyoIkVAMbB","OppoAD");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const i=e("../Interface/ADInterface"),s=e("./OppoConstant"),{ccclass:l,property:o}=cc._decorator;let r=class extends i.default{constructor(){super(...arguments),this.isShare=!1}initAd(){this.createVideo()}creatInsert(){this.insertAd=qg.createInterstitialAd({adUnitId:s.default.POSID_NativeAD_InsertAD})}createVideo(){this.rewardVideoAd=qg.createRewardedVideoAd({adUnitId:s.default.POSID_VedioAD})}showInsert(){}showToast(e){qg.showToast({title:e})}showVideo(e){null!=this.rewardVideoAd&&null!=this.rewardVideoAd||this.createVideo(),this.insertIntervalTime=(new Date).getTime(),this.rewardVideoAd.offClose(),this.rewardVideoAd.offError(),this.rewardVideoAd.offLoad(),cc.game.pause(),this.rewardVideoAd.onLoad(()=>{this.rewardVideoAd.show().then(()=>{console.log("\u5e7f\u544a\u663e\u793a\u6210\u529f")}).catch(e=>{cc.game.resume(),console.log("\u5e7f\u544a\u7ec4\u4ef6\u51fa\u73b0\u95ee\u9898",e)}),console.log("\u89c6\u9891\u52a0\u8f7d\u6210\u529f")}),this.rewardVideoAd.onError(()=>{cc.game.resume()}),this.rewardVideoAd.onClose(t=>{t&&t.isEnded||void 0===t?(e&&e(),this.showToast("\u5956\u52b1\u9886\u53d6\u6210\u529f"),cc.game.resume()):(this.showToast(" \u64ad\u653e\u4e2d\u9014\u9000\u51fa"),cc.game.resume())}),this.rewardVideoAd.load()}static creatorHutuiNine(){qg.getSystemInfoSync().platformVersionCode>=1076?this.gamePortalAd=qg.createGamePortalAd({adUnitId:s.default.GamePortalAd}):console.log("\u5feb\u5e94\u7528\u5e73\u53f0\u7248\u672c\u53f7\u4f4e\u4e8e1076\uff0c\u6682\u4e0d\u652f\u6301\u4e92\u63a8\u76d2\u5b50\u76f8\u5173 API"),this.gamePortalAd.load().then(function(){console.log("HutuiNine load success")}).catch(function(e){console.log("HutuiNine load fail with:"+e.errCode+","+e.errMsg)})}static showHutuiNine(){console.log("showHutuiNine"),this.creatorHutuiNine();let e=this;this.gamePortalAd.offLoad(),this.gamePortalAd.onLoad(function(){console.log("\u4e92\u63a8\u76d2\u5b50\u4e5d\u5bab\u683c\u5e7f\u544a\u52a0\u8f7d\u6210\u529f"),e.gamePortalAd.show().then(function(){console.log("HutuiNine show success")}).catch(function(e){console.log("HutuiNine show fail with:"+e.errCode+","+e.errMsg)}),console.log("HutuiNine show success")})}static hideHutuiNine(){this.gamePortalAd.destroy().then(function(){console.log("HutuiNine destroy success")}).catch(function(e){console.log("HutuiNine destroy fail with:"+e.errCode+","+e.errMsg)})}showBanner(){}hideBanner(){}addShortcut(){}exitGame(){console.log("\u63a8\u51fa"),qg.exitApplication({data:0})}log(e){console.log("WeChatAD:"+e)}};r.isSubscribe=!1,r=n([l],r),a.default=r,cc._RF.pop()},{"../Interface/ADInterface":"ADInterface","./OppoConstant":"OppoConstant"}],OppoConstant:[function(e,t,a){"use strict";cc._RF.push(t,"3095byhtMxAfrXImLdgyQSI","OppoConstant"),Object.defineProperty(a,"__esModule",{value:!0});class n{}a.default=n,n.POSID_NativeAD_Icon="537536",n.POSID_NativeAD_Banner="537427",n.POSID_BannerAD="",n.POSID_NativeAD_InsertAD="537430",n.POSID_VedioAD="537409",n.GamePortalAd="537426",n.appId="30788497",n.bannerRefresh=60,n.nativeDelay=1,n.autoVideo=1,n.popupWuchuPro=0,n.autoBannerAD=0,n.bannerWuchuPro=0,n.btnWuchuPro=0,n.btnWuchuPro2=0,n.btnWuchuPro3=0,n.showWatchVideo=0,cc._RF.pop()},{}],OppoNative:[function(e,t,a){"use strict";cc._RF.push(t,"24af3PZVGFHcrECBL1nEu/d","OppoNative");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const i=e("../../../utils/MyUtils"),s=e("../../ADManager"),l=e("./OppoConstant"),{ccclass:o,property:r}=cc._decorator,c=cc.Enum({Icon:0,Banner:1,Popup:2,Special:3});let d=class extends cc.Component{constructor(){super(...arguments),this.nativideType=null,this.image=null,this.title=null,this.desc=null,this.wuchuPro=0}getId(){let e;switch(this.nativideType){case c.Icon:e=l.default.POSID_NativeAD_InsertAD;break;case c.Banner:e=l.default.POSID_NativeAD_Banner;break;case c.Popup:e=l.default.POSID_NativeAD_InsertAD;break;case c.Special:e=l.default.POSID_NativeAD_Banner}return console.log("this.nativideType:"+this.nativideType+" + ad_Id:"+e),e}onLoad(){if(s.default.instance.sdkType!=s.SDK_TYPE.Oppo)return void this.node.destroy();if(s.default.instance.isTest)return;let e;switch(console.log("load="),this.createAD(),this.nativideType){case c.Icon:e=10;break;case c.Banner:e=l.default.bannerRefresh,this.wuchuPro=l.default.bannerWuchuPro;let t=0;this.schedule(()=>{++t==l.default.autoBannerAD&&(t=0,this.clickNativeAd())});break;case c.Special:e=l.default.bannerRefresh,this.wuchuPro=l.default.bannerWuchuPro;break;case c.Popup:return void(this.wuchuPro=l.default.popupWuchuPro)}this.schedule(()=>{this.createAD()},e)}start(){this.nativideType==c.Banner&&(console.log("y===",this.node.y),this.node.y=this.node.y*(cc.view.getCanvasSize().height/cc.view.getCanvasSize().width)/(1700/750),console.log("y2===",this.node.y))}createAD(){this.hideNode(),s.default.instance.isTest||this.creatNativeAD()}creatNativeAD(){console.log("create====12");let e=this;this._native=qg.createNativeAd({adUnitId:this.getId()}),this._native.offLoad(),this._native.offError(),this._native&&(console.log("naitve==="),this._native.onLoad(function(t){e._nativeCurrentAdList=t.adList.pop(),console.log("oppoNativeBanner icon: ",e._nativeCurrentAdList),e.showNativeAd()})),this._native.onError(function(t){console.log("oppoNativeBanner\uff1a \u539f\u751f\u5e7f\u544a\u52a0\u8f7d\u5931\u8d25\uff0c\u9519\u8bef\u7801\uff1a"+JSON.stringify(t)),e.hideNode()}),this._native.load()}showNativeAd(){let e;(e=this._nativeCurrentAdList.iconUrlList[0])||(e=this._nativeCurrentAdList.imgUrlList[0]),this.nativideType!=c.Icon&&(this.title.string=this._nativeCurrentAdList.title,this.desc.string=this._nativeCurrentAdList.desc),console.log("imgUrl",e);let t=".png";-1!=e.indexOf(".jpg")&&(t=".jpg"),e?cc.assetManager.loadRemote(e,{ext:t},(e,t)=>{if(e)return console.log("err==",e),void this.hideNode();let a=new cc.SpriteFrame(t);this.image.spriteFrame=a,console.log("adid==",this._nativeCurrentAdList.adId),this._native.reportAdShow({adId:this._nativeCurrentAdList.adId}),this.showNode()}):this.hideNode()}clickNativeAd(){console.log("clickad=="),this._native&&0!=this.node.opacity&&this._nativeCurrentAdList&&this._native.reportAdClick({adId:this._nativeCurrentAdList.adId})}onClickWuchu(){s.default.instance.sdkType==s.SDK_TYPE.Oppo&&i.MyUtils.probability(this.wuchuPro)&&(console.log("wuchu===="),this.clickNativeAd())}onClickWuchu2(e,t){if(s.default.instance.sdkType!=s.SDK_TYPE.Oppo)return;let a;switch(t){case 0:a=l.default.btnWuchuPro;break;case 1:a=l.default.btnWuchuPro2;break;case 2:a=l.default.btnWuchuPro3;break;default:a=0}i.MyUtils.probability(a)&&this.clickNativeAd()}showNode(){this.node.opacity=255}hideNode(){this.node.opacity=0}};n([r({type:cc.Enum(c)})],d.prototype,"nativideType",void 0),n([r(cc.Sprite)],d.prototype,"image",void 0),n([r(cc.Label)],d.prototype,"title",void 0),n([r(cc.Label)],d.prototype,"desc",void 0),d=n([o],d),a.default=d,cc._RF.pop()},{"../../../utils/MyUtils":"MyUtils","../../ADManager":"ADManager","./OppoConstant":"OppoConstant"}],PauseUI:[function(e,t,a){"use strict";cc._RF.push(t,"61e2fu+KzdDsr4xIqgW79su","PauseUI");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const i=e("../ADManager/ADManager"),s=e("../Manager/AudioManager"),l=e("../Manager/DataManager"),o=e("../Manager/UIManager"),{ccclass:r,property:c}=cc._decorator;let d=class extends cc.Component{constructor(){super(...arguments),this.audioPanel=null,this.effectPanel=null}start(){this.refreshPanel(),this.initPlatform(),cc.director.pause()}refreshPanel(){s.default.instance.muteBgm?(this.audioPanel.getChildByName("Open").children[0].active=!1,this.audioPanel.getChildByName("Close").children[0].active=!0):(this.audioPanel.getChildByName("Open").children[0].active=!0,this.audioPanel.getChildByName("Close").children[0].active=!1),s.default.instance.muteEffect?(this.effectPanel.getChildByName("Open").children[0].active=!1,this.effectPanel.getChildByName("Close").children[0].active=!0):(this.effectPanel.getChildByName("Open").children[0].active=!0,this.effectPanel.getChildByName("Close").children[0].active=!1)}initPlatform(){switch(i.default.instance.sdkType){case i.SDK_TYPE.WeChat:i.default.instance.showNative(1),i.default.instance.showNative(2),i.default.instance.showNative(3)}}onClickOpenMusic(){s.default.instance.muteBgm&&(s.default.instance.muteBgm=!1,s.default.instance.resumeBgm(),this.refreshPanel())}onClickCloseMusic(){s.default.instance.muteBgm||(s.default.instance.pauseBgm(),s.default.instance.muteBgm=!0,this.refreshPanel())}onClickOpenEffect(){s.default.instance.muteEffect&&(s.default.instance.muteEffect=!1,this.refreshPanel())}onClickCloseEffect(){s.default.instance.muteEffect||(s.default.instance.muteEffect=!0,this.refreshPanel())}onClickRestartBtn(){cc.director.resume(),o.default.instance.closeUI("PauseUI"),o.default.instance.closeUI("PrepareCards"),20!=l.default.instance.level?(o.default.instance.closeUI("MainUI"),o.default.instance.openUI("MainUI")):(o.default.instance.closeUI("BossUI"),o.default.instance.openUI("BossUI"))}onClickBackHomeBtn(){cc.director.resume(),o.default.instance.closeUI("PauseUI"),o.default.instance.closeUI("PrepareCards"),o.default.instance.closeUI("MainUI"),20!=l.default.instance.level?o.default.instance.closeUI("MainUI"):o.default.instance.closeUI("BossUI"),o.default.instance.openUI("MenuUI")}onClickContinueBtn(){cc.director.resume(),o.default.instance.closeUI("PauseUI")}onDestroy(){i.default.instance.hideNative(1),i.default.instance.hideNative(2),i.default.instance.hideNative(3)}};n([c(cc.Node)],d.prototype,"audioPanel",void 0),n([c(cc.Node)],d.prototype,"effectPanel",void 0),d=n([r],d),a.default=d,cc._RF.pop()},{"../ADManager/ADManager":"ADManager","../Manager/AudioManager":"AudioManager","../Manager/DataManager":"DataManager","../Manager/UIManager":"UIManager"}],PayInterface:[function(e,t,a){"use strict";cc._RF.push(t,"1b5b56GVrxHOKMAiy8gXaQj","PayInterface"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=class{},cc._RF.pop()},{}],Plant10:[function(e,t,a){"use strict";cc._RF.push(t,"05320iCvqNHzqnOHE1vmF/Z","Plant10");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const i=e("../../Manager/AudioManager"),s=e("../../Manager/BulletMgr"),l=e("../../Manager/BundleManager"),o=e("../../Manager/ZombieMgr"),r=e("../../scene_stage/SceneStage"),c=e("../../utils/KDefine"),d=e("../../utils/MyUtils"),h=e("../Bullet/BulletBase"),u=e("./PlantBase"),{ccclass:g}=cc._decorator;let p=class extends u.default{shoot(){let e=this;if(0==this.remainCD){let t=this.dragon.setAnimation(0,"dazhao",!0);this.dragon.setCompleteListener(()=>{e.setState(c.State.wait),this.attackTimes+=this.attackCD,this.remainCD=this.skillCD}),this.dragon.setTrackEventListener(t,(e,t)=>{"dazhao"==t.data.name&&this.attack(!0)})}else{let t=this.dragon.setAnimation(0,"gongji",!0),a=0;this.dragon.setCompleteListener(()=>{++a==this.attackNums&&e.setState(c.State.wait)}),this.dragon.setTrackEventListener(t,(t,a)=>{if("gongji"==a.data.name){let t=new cc.Vec2(this.node.getPosition().x+this.shootPo.x,this.node.getPosition().y+this.shootPo.y);i.default.instance.playEffect(this.shootSound,this.shootSoundVolume),s.default.shoot_to_right(r.default.instance.groudNode,t,e.bulletId,e.damage,e.attDistance,e.attackSpeed,this.hitSound,this.hitSoundVolume)}}),this.attackTimes+=this.attackCD}}attack(e=!1){if(!this.getZombie())return;let t,a=new cc.Vec2(this.getZombie().x-40,this.getZombie().y),n=new cc.Vec2(this.node.getPosition().x+this.skillPos.x,this.node.getPosition().y+this.skillPos.y),o=new cc.Vec2(n.x+(a.x-n.x)/2,n.y+600);e?(t=s.default.instance().getItem(this.skillbullet,this.damage,this.hitSound,this.hitSoundVolume).node,i.default.instance.playEffect(this.skillSound,this.skillSoundVolume)):(t=s.default.instance().getItem(this.bulletId,this.damage,this.hitSound,this.hitSoundVolume).node,i.default.instance.playEffect(this.shootSound,this.shootSoundVolume)),t.parent=r.default.instance.groudNode,t.getComponent(cc.CircleCollider).enabled=!1,t.setPosition(n),t.angle=90,t.zIndex=c.ZIndex.bullet,t.opacity=255,cc.tween(t).parallel(cc.tween(t).bezierTo(1.5/this.attackSpeed,n,o,a),cc.tween(t).to(1.5/this.attackSpeed,{angle:-45})).call(()=>{let e=t.getChildByName("bulletEffect").getComponent(sp.Skeleton);t.getComponent(cc.CircleCollider).enabled=!0,t.getChildByName("bulletEffect").active=!0,t.getComponent(sp.Skeleton).enabled=!1,t.angle=0,e.skeletonData=l.default.instance.getBundleRes("Spine","effect/"+t.getComponent(h.default).bulletEffect+"/"+t.getComponent(h.default).bulletEffect,sp.SkeletonData),e.setAnimation(0,"newAnimation",!1),e.setCompleteListener(()=>{t.getChildByName("bulletEffect").active=!1,s.default.instance().removeBullet(t.getComponent(h.default)),e.setCompleteListener(null)})}).start()}getZombie(){let e=[...o.default.instance().zombieSet.values()].length,t=d.MyUtils.getRandomInt(0,e);return[...o.default.instance().zombieSet.values()][t]?[...o.default.instance().zombieSet.values()][t].node.getPosition():null}checkTarget(){if(0==this.remainCD)return 0!=o.default.instance().zombieNums;{const e=o.default.instance().zombieInRow[this.row];if(e.size<=0)return!1;const t=e.values();let a=t.next();for(;!a.done;){const e=a.value;if(e.hp>0&&e.node.x>this.node.x)return!0;a=t.next()}return!1}}};p=n([g],p),a.default=p,cc._RF.pop()},{"../../Manager/AudioManager":"AudioManager","../../Manager/BulletMgr":"BulletMgr","../../Manager/BundleManager":"BundleManager","../../Manager/ZombieMgr":"ZombieMgr","../../scene_stage/SceneStage":"SceneStage","../../utils/KDefine":"KDefine","../../utils/MyUtils":"MyUtils","../Bullet/BulletBase":"BulletBase","./PlantBase":"PlantBase"}],Plant21:[function(e,t,a){"use strict";cc._RF.push(t,"382b2NZwudAUZHm0ZRN9Z0/","Plant21");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const i=e("../../Manager/BundleManager"),s=e("../../Manager/ExcelManager"),l=e("../../Manager/PlantMgr"),o=e("../../Manager/UserDataManager"),r=e("../../utils/KDefine"),c=e("./PlantBase"),{ccclass:d}=cc._decorator;let h=class extends c.default{onLoad(){this.regState(r.State.wait,this.stateWait),this.regState(r.State.waiting,this.stateWait),this.regState(r.State.hurt,this.stateHurt),this.regState(r.State.hurting,this.stateHurt),this.regState(r.State.dead,this.stateDead),this.regState(r.State.deading,this.stateDead),this.node.getComponent(cc.BoxCollider).enabled=!1}stateWait(e){this.state===r.State.wait&&(this.state=r.State.waiting,this.dragon.setAnimation(0,"daiji",!0))}stateHurt(e){this.state==r.State.hurt&&(this.state=r.State.hurting,21==this.id?this.dragon.setAnimation(0,"shouji",!0):(this.dragon.setAnimation(0,"shouji1",!1),this.dragon.setCompleteListener(()=>{this.dragon.setCompleteListener(null),this.dragon.setAnimation(0,"shouji2",!0)})))}onCollisionEnter(e,t){!this.inUse||this.hp<=0||e.tag==r.Tag.zombie&&this.setState(r.State.hurt)}onCollisionExit(e,t){!this.inUse||this.hp<=0||e.tag===r.Tag.zombie&&this.setState(r.State.wait)}reset(e,t){this.dragon=this.node.getChildByName("p01").getComponent(sp.Skeleton);let a=s.ExcelMgr.instance.GetExcelObject(s.TableName.plantTable)[e];this.inUse=!1,this.attDistance=a.attDistance,this.pTime=0,this.id=a.id,this.attackCD=a.attackCD,this.simpleDamage=a.simpleDamage,this.hitSound=a.hitSound,this.shootSound=a.shootSound,this.hp=a.damage[o.default.instance.getPlantLevel(this.id)-1][1]*this.simpleDamage,this.shootDelay=a.shootDelay,this.cost=a.cost[o.default.instance.getPlantLevel(this.id)-1][1],this.bulletId=a.bullet,this.dragonName=a.dragonName,this.skillCD=a.skillCD,this.remainCD=this.skillCD,this.shootPo=new cc.Vec2(a.shootPo[0],a.shootPo[1]),this.skillPos=new cc.Vec2(a.skillPos[0],a.skillPos[1]),this.attackNums=a.attackNums,this.skillNums=a.skillNums,this.attackSpeed=a.attackSpeed,this.skillDamage=a.skillDamage,this.skillbullet=a.skillbullet,t||(this.dragon.skeletonData=i.default.instance.getBundleRes("Spine",l.default.resPre+this.dragonName+"/"+this.dragonName,sp.SkeletonData)),this.scale=a.scale}checkTarget(){return!1}};h=n([d],h),a.default=h,cc._RF.pop()},{"../../Manager/BundleManager":"BundleManager","../../Manager/ExcelManager":"ExcelManager","../../Manager/PlantMgr":"PlantMgr","../../Manager/UserDataManager":"UserDataManager","../../utils/KDefine":"KDefine","./PlantBase":"PlantBase"}],Plant23:[function(e,t,a){"use strict";cc._RF.push(t,"2241bCDEJFBMqT3roJbQpPF","Plant23");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const i=e("../../scene_stage/SceneStage"),s=e("../../utils/KDefine"),l=e("./PlantBase"),{ccclass:o}=cc._decorator;let r=class extends l.default{constructor(){super(...arguments),this.ready=!1}stateWait(e){this.state===s.State.wait&&(this.state=s.State.waiting,this.dragon.setAnimation(0,"daiji",!0),this.scheduleOnce(()=>{this.ready=!0},5))}stateHurt(e){this.state==s.State.hurt&&(this.state=s.State.hurting,21==this.id?this.dragon.setAnimation(0,"shouji",!0):(this.dragon.setAnimation(0,"shouji1",!1),this.dragon.setCompleteListener(()=>{this.dragon.setCompleteListener(null),this.dragon.setAnimation(0,"shouji2",!0)})))}onCollisionStay(e,t){}stateDead(e){this.state===s.State.dead&&(this.state=s.State.deading,this.node.getChildByName("Effect").active=!0,cc.tween(this.node.getChildByName("p01")).to(.5,{opacity:0}).start(),this.node.getChildByName("Effect").getComponent(sp.Skeleton).setAnimation(0,"newAnimation",!1),this.node.getChildByName("Effect").getComponent(sp.Skeleton).setCompleteListener(()=>{this.node.destroy()}),i.default.instance.delPlantInBlckArr(this.row,this.col))}checkTarget(){return!1}};r=n([o],r),a.default=r,cc._RF.pop()},{"../../scene_stage/SceneStage":"SceneStage","../../utils/KDefine":"KDefine","./PlantBase":"PlantBase"}],Plant2:[function(e,t,a){"use strict";cc._RF.push(t,"85cb0wikQZBJ6mut0aWbGXx","Plant2");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const i=e("../../Manager/GoldManager"),s=e("../../scene_stage/SceneStage"),l=e("../../utils/KDefine"),o=e("./PlantBase"),{ccclass:r}=cc._decorator;let c=class extends o.default{checkTarget(){return!0}shoot(){if(0==this.remainCD){const e=this;let t=this.dragon.setAnimation(0,"dazhao",!0),a=0;this.dragon.setCompleteListener(()=>{++a==this.skillNums&&(e.setState(l.State.wait),this.attackTimes+=this.attackCD,this.remainCD=this.skillCD)}),this.dragon.setTrackEventListener(t,(e,t)=>{"dazhao"==t.data.name&&(i.default.instance.getItem(this.node.x+this.skillPos.x,this.node.y+this.skillPos.y,this.row,this.skillDamage*this.damage).parent=s.default.instance.sunParent)})}else{const e=this;let t=this.dragon.setAnimation(0,"shengchan",!1);this.dragon.setCompleteListener(()=>{e.setState(l.State.wait)}),this.dragon.setTrackEventListener(t,(e,t)=>{"shengchan"==t.data.name&&(i.default.instance.getItem(this.node.x+this.shootPo.x,this.node.y+this.shootPo.y,this.row,this.damage).parent=s.default.instance.sunParent)}),this.attackTimes+=this.attackCD}}};c=n([r],c),a.default=c,cc._RF.pop()},{"../../Manager/GoldManager":"GoldManager","../../scene_stage/SceneStage":"SceneStage","../../utils/KDefine":"KDefine","./PlantBase":"PlantBase"}],Plant3:[function(e,t,a){"use strict";cc._RF.push(t,"df515AJPkFKVLPPgDjbjz9P","Plant3");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const i=e("../../Manager/AudioManager"),s=e("../../Manager/BulletMgr"),l=e("../../Manager/ZombieMgr"),o=e("../../scene_stage/SceneStage"),r=e("../../utils/KDefine"),c=e("../../utils/MyUtils"),d=e("../Bullet/BulletBase"),h=e("./PlantBase"),{ccclass:u,property:g}=cc._decorator;let p=class extends h.default{shoot(){const e=this;if(0==this.remainCD){let t=this.dragon.setAnimation(0,"dazhao",!0),a=0;this.dragon.setCompleteListener(()=>{++a==this.skillNums&&(e.setState(r.State.wait),this.attackTimes+=this.attackCD,this.remainCD=this.skillCD)}),this.dragon.setTrackEventListener(t,(e,t)=>{"dazhao"==t.data.name&&this.attack(null,!0)})}else{this.dragon.setCompleteListener(()=>{e.setState(r.State.wait)});let t=this.getZombie();if(null==t)return void e.setState(r.State.wait);this.attackTimes+=this.attackCD;let a=this.dragon.setAnimation(0,"gongji",!1);this.dragon.setTrackEventListener(a,(e,a)=>{"gongji"==a.data.name&&this.attack(t)})}}attack(e,t=!1){let a,n=new cc.Vec2(this.node.getPosition().x+this.shootPo.x,this.node.getPosition().y+this.shootPo.y);if(t?(a=s.default.instance().getItem(this.skillbullet,this.damage*this.skillDamage,this.hitSound,this.hitSoundVolume).node,i.default.instance.playEffect(this.skillSound,this.skillSoundVolume)):(a=s.default.instance().getItem(this.bulletId,this.damage*this.simpleDamage,this.hitSound,this.hitSoundVolume).node,i.default.instance.playEffect(this.shootSound,this.shootSoundVolume)),a.angle=30,a.parent=o.default.instance.groudNode,a.setPosition(n),a.zIndex=r.ZIndex.bullet,e||(e=this.getZombie()),null==e)return;let l=new cc.Vec2(n.x+(e.x-n.x)/4,n.y+200),h=c.MyUtils.getDis(n.x,n.y,e.x,e.y);a.opacity=255,cc.tween(a).parallel(cc.tween(a).bezierTo((h+200)/(1300*this.attackSpeed),n,l,e),cc.tween(a).to((h+200)/(1300*this.attackSpeed),{angle:-45})).call(()=>{s.default.instance().removeBullet(a.getComponent(d.default))}).start()}getZombie(){let e=99999,t=null;for(let a=0;a<l.default.instance().zombieInRow.length;a++)l.default.instance().zombieInRow[a].size<=0||l.default.instance().zombieInRow[a].forEach(a=>{let n=c.MyUtils.getDis(this.node.x,this.node.y,a.node.x,a.node.y);n<e&&(e=n,t=a.node)});return null==t?null:t.getPosition()}checkTarget(){return 0!=l.default.instance().zombieNums}};p=n([u],p),a.default=p,cc._RF.pop()},{"../../Manager/AudioManager":"AudioManager","../../Manager/BulletMgr":"BulletMgr","../../Manager/ZombieMgr":"ZombieMgr","../../scene_stage/SceneStage":"SceneStage","../../utils/KDefine":"KDefine","../../utils/MyUtils":"MyUtils","../Bullet/BulletBase":"BulletBase","./PlantBase":"PlantBase"}],Plant4:[function(e,t,a){"use strict";cc._RF.push(t,"c8596bHKOtDvp7Eztx0dWsr","Plant4");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const i=e("../../Manager/AudioManager"),s=e("../../Manager/DataManager"),l=e("../../Manager/ZombieMgr"),o=e("../../utils/KDefine"),r=e("./PlantBase"),{ccclass:c,property:d}=cc._decorator;let h=class extends r.default{shoot(){if(0==this.remainCD){const e=this;let t=this.dragon.setAnimation(0,"dazhao",!1);i.default.instance.playEffect(this.skillSound,this.skillSoundVolume),this.dragon.setCompleteListener(()=>{e.setState(o.State.wait),this.attackTimes+=this.attackCD,this.remainCD=this.skillCD}),this.dragon.setTrackEventListener(t,(e,t)=>{if("dazhao"==t.data.name){i.default.instance.playEffect(this.hitSound,this.hitSoundVolume);const e=l.default.instance().zombieInRow[this.row].values();let t=e.next();for(;!t.done;){const a=t.value;a.hp>0&&a.node.x-this.node.x>0&&a.node.x-this.node.x<s.default.instance.blockWidth*(this.attDistance+.5)&&a.hurt(this.damage,this.bulletId,1),t=e.next()}}})}else{const e=this;let t=this.dragon.setAnimation(0,"gongji",!1);i.default.instance.playEffect(this.shootSound,this.shootSoundVolume),this.dragon.setCompleteListener(()=>{e.setState(o.State.wait)}),this.dragon.setTrackEventListener(t,(e,t)=>{if("gongji"==t.data.name){i.default.instance.playEffect(this.hitSound,this.hitSoundVolume);const e=l.default.instance().zombieInRow[this.row].values();let t=e.next();for(;!t.done;){const a=t.value;a.hp>0&&a.node.x-this.node.x>0&&a.node.x-this.node.x<s.default.instance.blockWidth*(this.attDistance+.5)&&a.hurt(this.damage,this.bulletId,1),t=e.next()}}}),this.attackTimes+=this.attackCD}}checkTarget(){const e=l.default.instance().zombieInRow[this.row];if(e.size<=0)return!1;const t=e.values();let a=t.next();for(;!a.done;){const e=a.value;if(e.hp>0&&e.node.x-this.node.x>0&&e.node.x-this.node.x<s.default.instance.blockWidth*(this.attDistance+.5))return!0;a=t.next()}return!1}};h=n([c],h),a.default=h,cc._RF.pop()},{"../../Manager/AudioManager":"AudioManager","../../Manager/DataManager":"DataManager","../../Manager/ZombieMgr":"ZombieMgr","../../utils/KDefine":"KDefine","./PlantBase":"PlantBase"}],Plant5:[function(e,t,a){"use strict";cc._RF.push(t,"6c3b5T3X6lPT4W44ml9lhLA","Plant5");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const i=e("../../Manager/AudioManager"),s=e("../../Manager/BulletMgr"),l=e("../../Manager/BundleManager"),o=e("../../Manager/ZombieMgr"),r=e("../../scene_stage/SceneStage"),c=e("../../utils/KDefine"),d=e("../../utils/MyUtils"),h=e("../Bullet/BulletBase"),u=e("./PlantBase"),{ccclass:g}=cc._decorator;let p=class extends u.default{shoot(){const e=this;let t=this.getZombie();if(null!=t)if(0==this.remainCD){let a=this.dragon.setAnimation(0,"dazhao",!1);this.dragon.setCompleteListener(()=>{e.setState(c.State.wait),this.attackTimes+=this.attackCD,this.remainCD=this.skillCD}),this.dragon.setTrackEventListener(a,(e,a)=>{"dazhao"==a.data.name&&this.attack(t,!0)})}else{this.dragon.setCompleteListener(()=>{e.setState(c.State.wait)}),this.attackTimes+=this.attackCD;let a=this.dragon.setAnimation(0,"gongji",!1);this.dragon.setTrackEventListener(a,(e,a)=>{"gongji"==a.data.name&&this.attack(t)})}else e.setState(c.State.wait)}attack(e,t=!1){let a,n,o=new cc.Vec2(this.node.getPosition().x+this.shootPo.x,this.node.getPosition().y+this.shootPo.y),d=new cc.Vec2(o.x+(e.x-o.x)/2,o.y+400);t?(i.default.instance.playEffect(this.skillSound,this.skillSoundVolume),a=s.default.instance().getItem(this.skillbullet,this.damage,this.hitSound,this.hitSoundVolume).node):(i.default.instance.playEffect(this.shootSound,this.shootSoundVolume),a=s.default.instance().getItem(this.bulletId,this.damage,this.hitSound,this.hitSoundVolume).node),a.angle=30,n=t?-30:720,a.getComponent(cc.CircleCollider).enabled=!1,a.parent=r.default.instance.groudNode,a.setPosition(o),a.zIndex=c.ZIndex.bullet,a.opacity=255,cc.tween(a).parallel(cc.tween(a).bezierTo(1.5/this.attackSpeed,o,d,e),cc.tween(a).to(1.5/this.attackSpeed,{angle:n})).call(()=>{let e=a.getChildByName("bulletEffect").getComponent(sp.Skeleton);a.getComponent(cc.CircleCollider).enabled=!0,a.getChildByName("bulletEffect").active=!0,a.getComponent(cc.Sprite).enabled=!1,e.skeletonData=l.default.instance.getBundleRes("Spine","effect/"+a.getComponent(h.default).bulletEffect+"/"+a.getComponent(h.default).bulletEffect,sp.SkeletonData),e.setAnimation(0,"newAnimation",!1),e.setCompleteListener(()=>{a.getChildByName("bulletEffect").active=!1,s.default.instance().removeBullet(a.getComponent(h.default)),e.setCompleteListener(null)})}).start()}getZombie(){let e=99999,t=null;return o.default.instance().zombieInRow[this.row].forEach(a=>{if(this.node.x<a.node.x){let n=d.MyUtils.getDis(this.node.x,this.node.y,a.node.x,a.node.y);n<e&&(e=n,t=a.node)}}),null==t?null:new cc.Vec2(t.getPosition().x-60,t.getPosition().y)}};p=n([g],p),a.default=p,cc._RF.pop()},{"../../Manager/AudioManager":"AudioManager","../../Manager/BulletMgr":"BulletMgr","../../Manager/BundleManager":"BundleManager","../../Manager/ZombieMgr":"ZombieMgr","../../scene_stage/SceneStage":"SceneStage","../../utils/KDefine":"KDefine","../../utils/MyUtils":"MyUtils","../Bullet/BulletBase":"BulletBase","./PlantBase":"PlantBase"}],Plant6:[function(e,t,a){"use strict";cc._RF.push(t,"65500I1raBGEIEFC1GQo7xX","Plant6");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const i=e("../../Manager/AudioManager"),s=e("../../Manager/BulletMgr"),l=e("../../Manager/BundleManager"),o=e("../../Manager/ZombieMgr"),r=e("../../scene_stage/SceneStage"),c=e("../../utils/KDefine"),d=e("../../utils/MyUtils"),h=e("../Bullet/BulletBase"),u=e("./PlantBase"),{ccclass:g}=cc._decorator;let p=class extends u.default{shoot(){const e=this;let t=this.getZombie();if(null!=t)if(0==this.remainCD){let a=this.dragon.setAnimation(0,"dazhao",!1),n=0;this.dragon.setCompleteListener(()=>{e.setState(c.State.wait),this.attackTimes+=this.attackCD,this.remainCD=this.skillCD}),this.dragon.setTrackEventListener(a,(e,a)=>{"dazhao"==a.data.name&&(t.x+=80*n,this.attack(t,!0))})}else{this.dragon.setCompleteListener(()=>{e.setState(c.State.wait)}),this.attackTimes+=this.attackCD;let a=this.dragon.setAnimation(0,"gongji",!1);this.dragon.setTrackEventListener(a,(e,a)=>{"gongji"==a.data.name&&this.attack(t)})}else e.setState(c.State.wait)}attack(e,t=!1){let a,n=new cc.Vec2(this.node.getPosition().x+this.shootPo.x,this.node.getPosition().y+this.shootPo.y),o=new cc.Vec2(n.x+(e.x-n.x)/2,n.y+400);t?(a=s.default.instance().getItem(this.skillbullet,this.damage,this.hitSound,this.hitSoundVolume).node,i.default.instance.playEffect(this.skillSound,this.skillSoundVolume)):(i.default.instance.playEffect(this.shootSound,this.shootSoundVolume),a=s.default.instance().getItem(this.bulletId,this.damage,this.hitSound,this.hitSoundVolume).node),a.angle=30,a.getComponent(cc.CircleCollider).enabled=!1,a.parent=r.default.instance.groudNode,a.setPosition(n),a.zIndex=c.ZIndex.bullet,a.opacity=255,cc.tween(a).parallel(cc.tween(a).bezierTo(1.5/this.attackSpeed,n,o,e),cc.tween(a).to(1.5/this.attackSpeed,{angle:720})).call(()=>{let e=a.getChildByName("bulletEffect").getComponent(sp.Skeleton);a.getComponent(cc.CircleCollider).enabled=!0,a.getChildByName("bulletEffect").active=!0,a.getComponent(cc.Sprite).enabled=!1,e.skeletonData=l.default.instance.getBundleRes("Spine","effect/"+a.getComponent(h.default).bulletEffect+"/"+a.getComponent(h.default).bulletEffect,sp.SkeletonData),e.setAnimation(0,"newAnimation",!1),e.setCompleteListener(()=>{a.getChildByName("bulletEffect").active=!1,s.default.instance().removeBullet(a.getComponent(h.default)),e.setCompleteListener(null)})}).start()}getZombie(){let e=99999,t=null;return o.default.instance().zombieInRow[this.row].forEach(a=>{if(this.node.x<a.node.x){let n=d.MyUtils.getDis(this.node.x,this.node.y,a.node.x,a.node.y);n<e&&(e=n,t=a.node)}}),null==t?null:new cc.Vec2(t.getPosition().x-60,t.getPosition().y)}};p=n([g],p),a.default=p,cc._RF.pop()},{"../../Manager/AudioManager":"AudioManager","../../Manager/BulletMgr":"BulletMgr","../../Manager/BundleManager":"BundleManager","../../Manager/ZombieMgr":"ZombieMgr","../../scene_stage/SceneStage":"SceneStage","../../utils/KDefine":"KDefine","../../utils/MyUtils":"MyUtils","../Bullet/BulletBase":"BulletBase","./PlantBase":"PlantBase"}],Plant8:[function(e,t,a){"use strict";cc._RF.push(t,"3cef6geB/RLg4m5MQfTJz/N","Plant8");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const i=e("../../Manager/AudioManager"),s=e("../../Manager/BulletMgr"),l=e("../../Manager/ZombieMgr"),o=e("../../utils/KDefine"),r=e("../Bullet/BulletBase"),c=e("./PlantBase"),{ccclass:d,property:h}=cc._decorator;let u=class extends c.default{shoot(){const e=this;if(0==this.remainCD){let t=this.dragon.setAnimation(0,"dazhao",!0),a=0;this.dragon.setCompleteListener(()=>{++a==this.skillNums&&(e.setState(o.State.wait),this.attackTimes+=this.attackCD,this.remainCD=this.skillCD)}),this.dragon.setTrackEventListener(t,(e,t)=>{"dazhao"==t.data.name&&this.attack(!0)})}else{let t=this.dragon.setAnimation(0,"gongji",!1);this.dragon.setCompleteListener(()=>{e.setState(o.State.wait)}),this.attackTimes+=this.attackCD,this.dragon.setTrackEventListener(t,(e,t)=>{"gongji"==t.data.name&&this.attack()})}}attack(e=!1){let t;e?(t=s.default.instance().getItem(this.skillbullet,this.damage,this.hitSound,this.hitSoundVolume).node,i.default.instance.playEffect(this.skillSound,this.skillSoundVolume)):(t=s.default.instance().getItem(this.bulletId,this.damage,this.hitSound,this.hitSoundVolume).node,i.default.instance.playEffect(this.shootSound,this.shootSoundVolume)),t.parent=this.node,t.setPosition(this.shootPo),t.zIndex=o.ZIndex.bullet,t.getComponent(cc.CircleCollider).enabled=!1,t.anchorX=0,cc.tween(t).call(()=>{t.opacity=255}).to(.05,{width:3e3}).call(()=>{const e=l.default.instance().zombieInRow[this.row].values();let a=e.next();for(;!a.done;){const n=a.value;n.hp>0&&n.node.x-this.node.x>0&&n.hurt(this.damage,t.getComponent(r.default).bulletEffect,t.getComponent(r.default).effectScale),a=e.next()}}).delay(.1).to(.05,{width:0}).call(()=>{t.width=38,t.getComponent(cc.CircleCollider).enabled=!0,t.anchorX=.5,s.default.instance().removeBullet(t.getComponent(r.default))}).start()}};u=n([d],u),a.default=u,cc._RF.pop()},{"../../Manager/AudioManager":"AudioManager","../../Manager/BulletMgr":"BulletMgr","../../Manager/ZombieMgr":"ZombieMgr","../../utils/KDefine":"KDefine","../Bullet/BulletBase":"BulletBase","./PlantBase":"PlantBase"}],Plant9:[function(e,t,a){"use strict";cc._RF.push(t,"156b4XSih9JOL9aZ2DU2eN3","Plant9");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const i=e("../../Manager/AudioManager"),s=e("../../Manager/BulletMgr"),l=e("../../Manager/BundleManager"),o=e("../../Manager/DataManager"),r=e("../../Manager/ZombieMgr"),c=e("../../scene_stage/SceneStage"),d=e("../../utils/KDefine"),h=e("../Bullet/BulletBase"),u=e("./PlantBase"),{ccclass:g,property:p}=cc._decorator;let f=class extends u.default{constructor(){super(...arguments),this.row2=9}shoot(){const e=this;if(null==this.getZombie())return void e.setState(d.State.wait);let t=this.getZombie().x-80,a=this.getZombie().y;if(0==this.remainCD){let n=this.dragon.setAnimation(0,"dazhao",!0),i=0;this.dragon.setCompleteListener(()=>{++i==this.skillNums&&(e.setState(d.State.wait),this.attackTimes+=this.attackCD,this.remainCD=this.skillCD)}),this.dragon.setTrackEventListener(n,(e,n)=>{if("dazhao"==n.data.name){let e=this.getZombie(2*i);null==e&&(e=new cc.Vec2(330,o.default.instance.groudYArr[2*i])),t=e.x,a=e.y,this.attack(t,a,!0)}})}else{this.dragon.setCompleteListener(()=>{e.setState(d.State.wait)}),this.attackTimes+=this.attackCD;let n=this.dragon.setAnimation(0,"gongji",!1);this.dragon.setTrackEventListener(n,(e,n)=>{"gongji"==n.data.name&&this.attack(t,a)})}}attack(e,t,a=!1){let n,o=new cc.Vec2(this.node.getPosition().x+this.shootPo.x,this.node.getPosition().y+this.shootPo.y);a?(n=s.default.instance().getItem(this.skillbullet,this.damage,this.hitSound,this.hitSoundVolume).node,i.default.instance.playEffect(this.skillSound,this.skillSoundVolume)):(n=s.default.instance().getItem(this.bulletId,this.damage,this.hitSound,this.hitSoundVolume).node,i.default.instance.playEffect(this.shootSound,this.shootSoundVolume)),n.angle=18,n.getComponent(cc.CircleCollider).enabled=!1,n.parent=c.default.instance.groudNode,n.setPosition(o),n.zIndex=d.ZIndex.bullet,n.opacity=255,cc.tween(n).by(1/(5*this.attackSpeed),{y:650}).delay(1/this.attackSpeed).call(()=>{n.x=e,n.angle=0}).to(1/this.attackSpeed,{y:t}).call(()=>{let e=n.getChildByName("bulletEffect").getComponent(sp.Skeleton);n.getComponent(cc.CircleCollider).enabled=!0,n.getChildByName("bulletEffect").active=!0,n.getComponent(cc.Sprite).enabled=!1,e.skeletonData=l.default.instance.getBundleRes("Spine","effect/"+n.getComponent(h.default).bulletEffect+"/"+n.getComponent(h.default).bulletEffect,sp.SkeletonData),e.setAnimation(0,"newAnimation",!1),e.setCompleteListener(()=>{n.getChildByName("bulletEffect").active=!1,s.default.instance().removeBullet(n.getComponent(h.default)),e.setCompleteListener(null)})}).start()}getZombie(e){let t=99999,a=null;for(let n=0;n<r.default.instance().zombieInRow.length;n++)n!=e&&e||r.default.instance().zombieInRow[n].size<=0||r.default.instance().zombieInRow[n].forEach(e=>{let i=e.node.x;i<t&&(t=i,a=e.node,this.row2=n)});return null==a?e?new cc.Vec2(330,o.default.instance.groudYArr[e]):null:a.getPosition()}checkTarget(){return 0!=r.default.instance().zombieNums}};f=n([g],f),a.default=f,cc._RF.pop()},{"../../Manager/AudioManager":"AudioManager","../../Manager/BulletMgr":"BulletMgr","../../Manager/BundleManager":"BundleManager","../../Manager/DataManager":"DataManager","../../Manager/ZombieMgr":"ZombieMgr","../../scene_stage/SceneStage":"SceneStage","../../utils/KDefine":"KDefine","../Bullet/BulletBase":"BulletBase","./PlantBase":"PlantBase"}],PlantBase:[function(e,t,a){"use strict";cc._RF.push(t,"1bf37JuVHtGa7BoRiRNvYbo","PlantBase");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const i=e("../../utils/KDefine"),s=e("../../utils/StateComponent"),l=e("../../Manager/BulletMgr"),o=e("../../Manager/PlantMgr"),r=e("../../Manager/BundleManager"),c=e("../../Manager/ExcelManager"),d=e("../../Manager/ZombieMgr"),h=e("../../scene_stage/SceneStage"),u=e("../../Manager/UserDataManager"),g=e("../../Manager/AudioManager"),{ccclass:p,property:f}=cc._decorator;let m=class extends s.default{constructor(){super(...arguments),this.dragon=null,this.id=1,this.hp=10,this.attackCD=.8,this.damage=1,this.shootDelay=.4,this.cost=0,this.dragonName=null,this.skillCD=0,this.remainCD=0,this.skillNums=1,this.attackNums=1,this.attackSpeed=1,this.scale=1,this.skillDamage=1,this.skillbullet=1,this.shootSound="",this.hitSound="",this.skillSound="",this.shootSoundVolume=1,this.hitSoundVolume=1,this.skillSoundVolume=1,this.inUse=!1,this.canMove=!1,this.isPause=!1,this.shootPo=cc.v2(29,17),this.skillPos=cc.v2(29,17),this.bulletId=1,this.row=-1,this.col=-1,this.checkTargetTime=.2,this.pTime=0,this.attackTimes=0}onLoad(){this.regState(i.State.wait,this.stateWait),this.regState(i.State.waiting,this.stateWait),this.regState(i.State.attack,this.stateAttack),this.regState(i.State.attacking,this.stateAttack),this.regState(i.State.dead,this.stateDead),this.regState(i.State.deading,this.stateDead),this.node.getComponent(cc.BoxCollider).enabled=!1}reset(e,t=!1){this.dragon=this.node.getChildByName("p01").getComponent(sp.Skeleton);let a=c.ExcelMgr.instance.GetExcelObject(c.TableName.plantTable)[e];this.inUse=!1,this.attDistance=a.attDistance,this.skillSound=a.skillSound,this.shootSoundVolume=a.shootSoundVolume,this.hitSoundVolume=a.hitSoundVolume,this.skillSoundVolume=a.skillSoundVolume,this.pTime=0,this.id=a.id,this.attackCD=a.attackCD,this.simpleDamage=a.simpleDamage,this.hitSound=a.hitSound,this.shootSound=a.shootSound,this.damage=a.damage[u.default.instance.getPlantLevel(this.id)-1][1]*this.simpleDamage,this.hp=a.hp,this.shootDelay=a.shootDelay,this.cost=a.cost[u.default.instance.getPlantLevel(this.id)-1][1],this.bulletId=a.bullet,this.dragonName=a.dragonName,this.skillCD=a.skillCD,this.remainCD=this.skillCD,this.shootPo=new cc.Vec2(a.shootPo[0],a.shootPo[1]),this.skillPos=new cc.Vec2(a.skillPos[0],a.skillPos[1]),this.attackNums=a.attackNums,this.skillNums=a.skillNums,this.attackSpeed=a.attackSpeed,this.skillDamage=a.skillDamage,this.skillbullet=a.skillbullet,t||(this.dragon.skeletonData=r.default.instance.getBundleRes("Spine",o.default.resPre+this.dragonName+"/"+this.dragonName,sp.SkeletonData)),this.scale=a.scale}play(e,t){this.inUse=!0,this.row=e,this.col=t,this.node.zIndex=i.ZIndex.enemy-e,this.node.scale=this.scale,this.node.getComponent(cc.BoxCollider).enabled=!0,0!=this.skillCD?this.schedule(()=>{this.remainCD--,this.remainCD<0&&(this.remainCD=0)},1):this.remainCD=1,this.setState(i.State.wait)}removeBullet(e){e.inUse=!1,cc.Tween.stopAllByTarget(e.node)}shoot(){const e=this;let t=new cc.Vec2(this.node.getPosition().x+this.shootPo.x,this.node.getPosition().y+this.shootPo.y);if(0==this.remainCD){let a=this.dragon.setAnimation(0,"dazhao",!0),n=0;this.dragon.setCompleteListener(()=>{++n==this.skillNums&&(e.setState(i.State.wait),this.attackTimes+=this.attackCD,this.remainCD=this.skillCD)}),this.dragon.setTrackEventListener(a,(a,n)=>{"dazhao"==n.data.name&&(g.default.instance.playEffect(this.skillSound,this.skillSoundVolume),l.default.shoot_to_right(h.default.instance.groudNode,t,e.bulletId,e.skillDamage*e.damage,e.attDistance,e.attackSpeed,this.hitSound,this.hitSoundVolume))})}else{let a=this.dragon.setAnimation(0,"gongji",!0),n=0;this.dragon.setCompleteListener(()=>{++n==this.attackNums&&e.setState(i.State.wait)}),this.dragon.setTrackEventListener(a,(a,n)=>{"gongji"==n.data.name&&(g.default.instance.playEffect(this.shootSound,this.shootSoundVolume),l.default.shoot_to_right(h.default.instance.groudNode,t,e.bulletId,e.damage,e.attDistance,e.attackSpeed,this.hitSound,this.hitSoundVolume))}),this.attackTimes+=this.attackCD}}hurt(e){this.inUse&&(this.hp<=0||(this.hp-=e,this.hp<=0&&this.setState(i.State.dead)))}stop(){this.inUse=!1,this.dragon.timeScale=0,this.setState(i.State.idle)}stateAttack(e){this.state===i.State.attack&&(this.state=i.State.attacking,this.shoot())}stateDead(e){this.state===i.State.dead&&(this.state=i.State.deading,this.node.getChildByName("Effect").active=!0,cc.tween(this.node.getChildByName("p01")).to(.5,{opacity:0}).start(),this.node.getChildByName("Effect").getComponent(sp.Skeleton).setAnimation(0,"newAnimation",!1),this.node.getChildByName("Effect").getComponent(sp.Skeleton).setCompleteListener(()=>{this.node.destroy()}),h.default.instance.delPlantInBlckArr(this.row,this.col))}stateWait(e){this.state===i.State.wait&&(this.state=i.State.waiting,this.dragon.setAnimation(0,"daiji",!0),this.dragon.setCompleteListener(null)),this.pTime+=e,this.pTime>this.checkTargetTime&&!this.isPause&&(this.pTime=0,this.attackTimes<=0&&this.checkTarget()&&this.setState(i.State.attack))}checkTarget(){const e=d.default.instance().zombieInRow[this.row];if(e.size<=0)return!1;const t=e.values();let a=t.next();for(;!a.done;){const e=a.value;if(e.hp>0&&e.node.x>this.node.x)return!0;a=t.next()}return!1}update(e){this.inUse&&(this.attackTimes>=0&&(this.attackTimes-=e),this.updateFrame(e))}};m=n([p],m),a.default=m,cc._RF.pop()},{"../../Manager/AudioManager":"AudioManager","../../Manager/BulletMgr":"BulletMgr","../../Manager/BundleManager":"BundleManager","../../Manager/ExcelManager":"ExcelManager","../../Manager/PlantMgr":"PlantMgr","../../Manager/UserDataManager":"UserDataManager","../../Manager/ZombieMgr":"ZombieMgr","../../scene_stage/SceneStage":"SceneStage","../../utils/KDefine":"KDefine","../../utils/StateComponent":"StateComponent"}],PlantMgr:[function(e,t,a){"use strict";cc._RF.push(t,"bb4ca4JH/xBX69kccAs1TdW","PlantMgr"),Object.defineProperty(a,"__esModule",{value:!0});const n=e("./ExcelManager");class i{constructor(){this.itemConf={},this.itemPoolSize=60,this.itemNode=null,this.cardNode=null,this.allCardsArr=[],this.sceneStage=null}static instance(){return i._me||(i._me=new i),i._me}getPlant(e){return n.ExcelMgr.instance.GetExcelObject(n.TableName.plantTable)[e]}getCard(e){return this.allCardsArr[e]}}a.default=i,i._me=null,i.resPre="plant/",i.cardPicResPre="scene_stage/img/prop/",i.dragonArmature="Armature",i.attackAni="gongji",i.waitAni="daiji",cc._RF.pop()},{"./ExcelManager":"ExcelManager"}],PoolManager:[function(e,t,a){"use strict";cc._RF.push(t,"e23c8KSdv5NibqP20OHiagj","PoolManager"),Object.defineProperty(a,"__esModule",{value:!0});const n=e("./BundleManager");class i{constructor(){this.poolMap=new Map}static get instance(){return this._instance||(this._instance=new i),this._instance}getPoolNode(e){let t=this.poolMap.get(e);return t||(t=new cc.NodePool,this.poolMap.set(e,t)),t.get()||cc.instantiate(n.default.instance.getBundleRes("Prefab","PoolNode/"+e,cc.Prefab))}putPoolNode(e){let t=this.poolMap.get(e.name);t||(t=new cc.NodePool,this.poolMap.set(e.name,t)),t.put(e)}}a.default=i,i._instance=null,cc._RF.pop()},{"./BundleManager":"BundleManager"}],PrepareCards:[function(e,t,a){"use strict";cc._RF.push(t,"34241DRWgVIK4M1XpspI9Cf","PrepareCards");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const i=e("../Manager/BundleManager"),s=e("../Manager/DataManager"),l=e("../Manager/ExcelManager"),o=e("../Manager/PlantMgr"),r=e("../Manager/UIManager"),c=e("../utils/MyUtils"),d=e("../entity/Card"),h=e("../scene_stage/SceneStage"),u=e("../Manager/UserDataManager"),g=e("../ADManager/ADManager"),p=e("../ADlibs/Hts"),f=e("../TaSdk/TaSdk"),{ccclass:m,property:y}=cc._decorator;let C=class extends cc.Component{constructor(){super(...arguments),this.cards=null,this.plantIcon=null,this.info_icon=null,this.close_icon=null,this.info_name=null,this.info_desc=null,this.info_damage=null,this.info_cd=null,this.info_level=null,this.info_cost=null,this.cardList=null,this.atkIcon=null,this.levelNum=null,this.videoBtn=null,this.selectID=0,this.lastID=0,this.tryTimes=0,this.unLockPlantID=[]}onLoad(){this.node.on("guideSelect",()=>{this.selectCard(11,this.cards.getChildByName("11"))},this),s.default.instance.clearTempData(),s.default.instance.extraGold=0,u.default.instance.levelGuide||2!=s.default.instance.level||(this.node.getChildByName("DaiFu").active=!1);for(let e=0;e<s.default.instance.selectPlantID.length;e++)if(u.default.instance.plantLock.includes(s.default.instance.selectPlantID[e])){let t=cc.instantiate(i.default.instance.getBundleRes("Prefab","card/card_1",cc.Prefab));t.getComponent(d.default).init(s.default.instance.selectPlantID[e]),t.parent=this.cardList,t.on(cc.Node.EventType.TOUCH_END,()=>{c.MyUtils.removeArrElement(s.default.instance.selectPlantID,s.default.instance.selectPlantID[e]),s.default.instance.selectPlantID.length<=0&&(this.node.getChildByName("x").getComponent(cc.Button).interactable=!1),t.destroy(),this.refreshCardPanel()},this)}else c.MyUtils.removeArrElement(s.default.instance.selectPlantID,s.default.instance.selectPlantID[e]),e--;this.initCardPanel(),this.initSunPanel(),this.initDaiFuPanel(),this.refreshCardPanel(),s.default.instance.selectPlantID.length<=0?this.node.getChildByName("x").getComponent(cc.Button).interactable=!1:this.node.getChildByName("x").getComponent(cc.Button).interactable=!0}initDaiFuPanel(){let e=[];e=e.concat(s.default.instance.rare4Array,s.default.instance.rare5Array),s.default.instance.maxPlantID=c.MyUtils.getArrRandomValue(e),this.node.getChildByName("DaiFu").getChildByName("Bg").getChildByName("Reward2").getComponentInChildren(sp.Skeleton).skeletonData=i.default.instance.getBundleRes("Spine","plant/"+o.default.instance().getPlant(s.default.instance.maxPlantID).dragonName+"/"+o.default.instance().getPlant(s.default.instance.maxPlantID).dragonName,sp.SkeletonData),this.node.getChildByName("DaiFu").getChildByName("Bg").getChildByName("Reward2").getComponentInChildren(sp.Skeleton).setAnimation(0,"daiji",!0),this.node.getChildByName("DaiFu").getChildByName("Bg").getChildByName("Reward2").getChildByName("PlantName").getComponent(cc.Label).string=o.default.instance().getPlant(s.default.instance.maxPlantID).name+"(\u6ee1\u7ea7)"}onClickCloseDaiFu(){this.node.getChildByName("DaiFu").active=!1}onClickDaiFuVideo(e,t){g.default.instance.showVideo(()=>{let a=e.currentTarget;switch(a.getComponent(cc.Button).interactable=!1,a.getChildByName("videoWhite").active=!1,a.getComponentInChildren(cc.Label).string="\u5df2\u9886\u53d6",a.getChildByName("Label").x=0,t){case"1":h.default.instance.bombNums++;break;case"2":this.cards.getChildByName(s.default.instance.maxPlantID+"").zIndex=-1,s.default.instance.beforeLevel=u.default.instance.getPlantLevel(s.default.instance.maxPlantID),u.default.instance.setPlantLevel(s.default.instance.maxPlantID,10,!0),s.default.instance.tryPlant.push(s.default.instance.maxPlantID),this.cards.getChildByName(s.default.instance.maxPlantID+"").getComponent(d.default).init(s.default.instance.maxPlantID),this.cards.getChildByName(s.default.instance.maxPlantID+"").getChildByName("Lock").active=!1,this.selectCard(s.default.instance.maxPlantID,null,!1);break;case"3":s.default.instance.extraGold=2e3,this.initSunPanel()}p.default.instance.eventReport("\u6234\u592b\u5b9d\u85cf\u89c6\u9891\u770b\u5b8c"),f.default.instance.AdsPlayRet(f.VideoIndex.daifu,0)},()=>{p.default.instance.eventReport("\u6234\u592b\u5b9d\u85cf\u89c6\u9891\u53d6\u6d88"),f.default.instance.AdsPlayRet(f.VideoIndex.daifu,1)},()=>{p.default.instance.eventReport("\u6234\u592b\u5b9d\u85cf\u89c6\u9891\u52a0\u8f7d\u5931\u8d25"),f.default.instance.AdsPlayRet(f.VideoIndex.daifu,-1)})}initSunPanel(){this.node.getChildByName("SunPanel").getComponentInChildren(cc.Label).string=l.ExcelMgr.instance.GetExcelObject(l.TableName.levelTable)[s.default.instance.level].gold+s.default.instance.extraGold+""}initCardPanel(){let e=[];for(let t=0;t<s.default.instance.newPlant.length;t++)e.push(s.default.instance.newPlant[t]);for(let t=0;t<s.default.instance.plantArray.length;t++)s.default.instance.newPlant.includes(s.default.instance.plantArray[t])||e.push(s.default.instance.plantArray[t]);for(let t=0;t<e.length;t++){let a=cc.instantiate(i.default.instance.getBundleRes("Prefab","card/card_1",cc.Prefab));this.cards.addChild(a),a.getComponent(d.default).init(e[t]),u.default.instance.plantLock.includes(e[t])||(this.unLockPlantID.push(e[t]),a.getChildByName("Lock").getChildByName("Try").active=!0),a.name=e[t]+"",s.default.instance.newPlant.includes(e[t])&&(a.getChildByName("New").active=!0),a.on(cc.Node.EventType.TOUCH_END,()=>{this.selectCard(e[t],a)},this)}this.selectCard(1,null,!1)}refreshCardPanel(){for(let e=0;e<this.cards.childrenCount;e++)this.cards.children[e].opacity=255;for(let e=0;e<s.default.instance.selectPlantID.length;e++)this.cards.getChildByName(s.default.instance.selectPlantID[e]+"").opacity=144}onClickStart(){s.default.instance.selectPlantID.length>0&&(r.default.instance.closeUI("PrepareCards"),h.default.instance.play())}selectCard(e,t,a=!0){if(this.selectID=e,u.default.instance.plantLock.includes(e)||s.default.instance.tryPlant.includes(e)?this.videoBtn.active=!1:(this.videoBtn.active=!0,f.default.instance.AdsExposure(f.VideoIndex.tryPlant)),!s.default.instance.selectPlantID.includes(e)&&s.default.instance.selectPlantID.length<6&&a&&(u.default.instance.plantLock.includes(e)||s.default.instance.tryPlant.includes(e))&&t){s.default.instance.selectPlantID.push(e);let a=cc.instantiate(t);a.getChildByName("HighLight").active=!1,a.parent=this.node,this.node.getChildByName("x").getComponent(cc.Button).interactable=!0,cc.tween(a).to(.5,{x:-450,y:264-70*(s.default.instance.selectPlantID.length-1)}).call(()=>{a.parent=this.cardList,a.x=0,a.on(cc.Node.EventType.TOUCH_END,()=>{c.MyUtils.removeArrElement(s.default.instance.selectPlantID,e),s.default.instance.selectPlantID.length<=0&&(this.node.getChildByName("x").getComponent(cc.Button).interactable=!1),a.destroy(),this.refreshCardPanel()},this),this.refreshCardPanel()}).start()}if(this.selectID==this.lastID)return;s.default.instance.newPlant.includes(e)&&(c.MyUtils.removeArrElement(s.default.instance.newPlant,e),this.cards.getChildByName(e+"").getChildByName("New").active=!1),0!=this.lastID&&(this.cards.getChildByName(this.lastID+"").getChildByName("HighLight").active=!1),this.atkIcon.spriteFrame=2==e||12==e?i.default.instance.getBundleRes("BundleTexture","ui/card_info_cost",cc.SpriteFrame):i.default.instance.getBundleRes("BundleTexture","ui/card_info_atk",cc.SpriteFrame),this.levelNum.string=u.default.instance.getPlantLevel(e),this.plantIcon.skeletonData=i.default.instance.getBundleRes("Spine","plant/"+o.default.instance().getPlant(e).dragonName+"/"+o.default.instance().getPlant(e).dragonName,sp.SkeletonData),this.plantIcon.setAnimation(0,"daiji",!0),this.cards.getChildByName(this.selectID+"").getChildByName("HighLight").active=!0,this.lastID=this.selectID,this.info_icon.getComponent(cc.Sprite).spriteFrame=i.default.instance.getBundleRes("BundleTexture","PlantIcon/p_"+e,cc.SpriteFrame),this.info_name.string=o.default.instance().getPlant(e).name,this.info_desc.string=o.default.instance().getPlant(e).desc;const n=o.default.instance().getPlant(e);this.info_damage.string=""+Math.floor(n.damage[u.default.instance.getPlantLevel(e)-1][1]*n.simpleDamage),this.info_cd.string=""+n.cd[u.default.instance.getPlantLevel(e)-1][1],this.info_cost.string=""+n.cost[u.default.instance.getPlantLevel(e)-1][1]}onClickVideoBtn(){f.default.instance.AdsButtonClick(f.VideoIndex.tryPlant),g.default.instance.showVideo(()=>{if(this.tryTimes++,s.default.instance.tryPlant.push(this.selectID),this.cards.getChildByName(this.selectID+"").getChildByName("Lock").active=!1,this.selectCard(this.selectID,this.cards.getChildByName(this.selectID+"")),2==this.tryTimes)for(let e=0;e<this.unLockPlantID.length;e++)this.cards.getChildByName(this.unLockPlantID[e]+"").getChildByName("Lock").active=!1,s.default.instance.tryPlant.includes(this.unLockPlantID[e])||s.default.instance.tryPlant.push(this.unLockPlantID[e]);p.default.instance.eventReport("\u8bd5\u7528\u690d\u7269\u89c6\u9891\u89c6\u9891\u89c2\u770b\u6210\u529f"),f.default.instance.AdsPlayRet(f.VideoIndex.tryPlant,0)},()=>{p.default.instance.eventReport("\u8bd5\u7528\u690d\u7269\u89c6\u9891\u89c6\u9891\u89c2\u770b\u53d6\u6d88"),f.default.instance.AdsPlayRet(f.VideoIndex.tryPlant,1)},()=>{f.default.instance.AdsPlayRet(f.VideoIndex.tryPlant,-1),p.default.instance.eventReport("\u8bd5\u7528\u690d\u7269\u89c6\u9891\u89c6\u9891\u52a0\u8f7d\u5931\u8d25")})}clearAll(){this.cardList.removeAllChildren(),s.default.instance.selectPlantID=[],this.refreshCardPanel()}};n([y(cc.Node)],C.prototype,"cards",void 0),n([y(sp.Skeleton)],C.prototype,"plantIcon",void 0),n([y(cc.Node)],C.prototype,"info_icon",void 0),n([y(cc.Node)],C.prototype,"close_icon",void 0),n([y(cc.Label)],C.prototype,"info_name",void 0),n([y(cc.Label)],C.prototype,"info_desc",void 0),n([y(cc.Label)],C.prototype,"info_damage",void 0),n([y(cc.Label)],C.prototype,"info_cd",void 0),n([y(cc.Label)],C.prototype,"info_level",void 0),n([y(cc.Label)],C.prototype,"info_cost",void 0),n([y(cc.Node)],C.prototype,"cardList",void 0),n([y(cc.Sprite)],C.prototype,"atkIcon",void 0),n([y(cc.Label)],C.prototype,"levelNum",void 0),n([y(cc.Node)],C.prototype,"videoBtn",void 0),C=n([m],C),a.default=C,cc._RF.pop()},{"../ADManager/ADManager":"ADManager","../ADlibs/Hts":"Hts","../Manager/BundleManager":"BundleManager","../Manager/DataManager":"DataManager","../Manager/ExcelManager":"ExcelManager","../Manager/PlantMgr":"PlantMgr","../Manager/UIManager":"UIManager","../Manager/UserDataManager":"UserDataManager","../TaSdk/TaSdk":"TaSdk","../entity/Card":"Card","../scene_stage/SceneStage":"SceneStage","../utils/MyUtils":"MyUtils"}],Privacy_UserView:[function(e,t,a){"use strict";cc._RF.push(t,"ba590GN2jRLKKeU6/b5S5kL","Privacy_UserView");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0}),a.PUType=void 0;const i=e("../ADManager/ADManager"),{ccclass:s,property:l}=cc._decorator;let o=class extends cc.Component{constructor(){super(...arguments),this.title=null,this.user=null,this.pravicy=null,this.userOppo=null,this.pravicyOppo=null,this.userXiaoMi=null,this.pravicyXiaoMi=null,this.pravicyHuaWei=null,this.userHuaWei=null}init(e){switch(e){case r.Privacy:this.title.string="\u9690\u79c1\u653f\u7b56",i.default.instance.sdkType==i.SDK_TYPE.Oppo?(this.userOppo.active=!1,this.pravicyOppo.active=!0):i.default.instance.sdkType==i.SDK_TYPE.XiaoMi?(this.userXiaoMi.active=!1,this.pravicyXiaoMi.active=!0):i.default.instance.sdkType==i.SDK_TYPE.HuaWei?(this.userHuaWei.active=!1,this.pravicyHuaWei.active=!0):(this.user.active=!1,this.pravicy.active=!0);break;case r.User:this.title.string="\u7528\u6237\u534f\u8bae",i.default.instance.sdkType==i.SDK_TYPE.Oppo?(this.userOppo.active=!0,this.pravicyOppo.active=!1):i.default.instance.sdkType==i.SDK_TYPE.XiaoMi?(this.userXiaoMi.active=!0,this.pravicyXiaoMi.active=!1):i.default.instance.sdkType==i.SDK_TYPE.HuaWei?(this.userHuaWei.active=!0,this.pravicyHuaWei.active=!1):(this.user.active=!0,this.pravicy.active=!1)}}onClickReject(){i.default.instance.exitGame()}onClickClose(){this.node.active=!1}};var r;n([l(cc.Label)],o.prototype,"title",void 0),n([l(cc.Node)],o.prototype,"user",void 0),n([l(cc.Node)],o.prototype,"pravicy",void 0),n([l(cc.Node)],o.prototype,"userOppo",void 0),n([l(cc.Node)],o.prototype,"pravicyOppo",void 0),n([l(cc.Node)],o.prototype,"userXiaoMi",void 0),n([l(cc.Node)],o.prototype,"pravicyXiaoMi",void 0),n([l(cc.Node)],o.prototype,"pravicyHuaWei",void 0),n([l(cc.Node)],o.prototype,"userHuaWei",void 0),o=n([s],o),a.default=o,function(e){e.Privacy="0",e.User="1"}(r=a.PUType||(a.PUType={})),cc._RF.pop()},{"../ADManager/ADManager":"ADManager"}],RewardUI:[function(e,t,a){"use strict";cc._RF.push(t,"e9be9EByuFCWrylyRyY0RD7","RewardUI");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const i=e("../ADManager/ADManager"),s=e("../Manager/BundleManager"),l=e("../Manager/DataManager"),o=e("../Manager/PlantMgr"),r=e("../Manager/UIManager"),c=e("../Manager/UserDataManager"),{ccclass:d,property:h}=cc._decorator;let u=class extends cc.Component{constructor(){super(...arguments),this.rewardArr=[],this.index=0}onLoad(){i.default.instance.sdkType==i.SDK_TYPE.WeChat&&(i.default.instance.showNative(2),i.default.instance.showNative(3))}init(e=[]){this.rewardArr=e,1==e.length?(this.showSingle(),this.node.getChildByName("CloseBtn").active=!0,this.node.getChildByName("RewardSingle").getChildByName("NextBtn").active=!1,this.node.getChildByName("RewardSingle").getChildByName("AllBtn").active=!1):(this.showSingle(),this.node.getChildByName("CloseBtn").active=!1,this.node.getChildByName("RewardSingle").getChildByName("NextBtn").active=!0,this.node.getChildByName("RewardSingle").getChildByName("AllBtn").active=!0)}showAll(){i.default.instance.sdkType==i.SDK_TYPE.WeChat&&(i.default.instance.hideNative(2),i.default.instance.hideNative(3)),this.node.getChildByName("RewardSingle").active=!1,this.node.getChildByName("RewardList").active=!0,this.node.getChildByName("CloseBtn").active=!0;for(let e=0;e<this.rewardArr.length;e++){let t=this.rewardArr[e];"a"==t.rewardType?(this.node.getChildByName("RewardList").children[e].getChildByName("Chip").active=!0,this.node.getChildByName("RewardList").children[e].getChildByName("Num").active=!0,this.node.getChildByName("RewardList").children[e].getChildByName("Num").getComponent(cc.Label).string="X"+t.number):(this.node.getChildByName("RewardList").children[e].getChildByName("Chip").active=!1,this.node.getChildByName("RewardList").children[e].getChildByName("Num").active=!1),this.node.getChildByName("RewardList").children[e].getChildByName("PlantIcon").getComponent(cc.Sprite).spriteFrame=s.default.instance.getBundleRes("BundleTexture","PlantIcon/p_"+t.plantID,cc.SpriteFrame),this.node.getChildByName("RewardList").children[e].getChildByName("Bg").getComponent(cc.Sprite).spriteFrame=s.default.instance.getBundleRes("BundleTexture","ShopUI/s"+t.rare,cc.SpriteFrame)}}showSingle(){this.node.getChildByName("RewardSingle").active=!0;let e=this.rewardArr[this.index];"a"==e.rewardType?(this.node.getChildByName("RewardSingle").getChildByName("TipLabel").active=!1,this.node.getChildByName("RewardSingle").getChildByName("Chip").active=!0,this.node.getChildByName("RewardSingle").getChildByName("Num").active=!0,this.node.getChildByName("RewardSingle").getChildByName("PlantIcon").active=!0,this.node.getChildByName("RewardSingle").getChildByName("PlantAni").active=!1,this.node.getChildByName("RewardSingle").getChildByName("Bg").active=!0,this.node.getChildByName("RewardSingle").getChildByName("Num").getComponent(cc.Label).string="X"+e.number,this.node.getChildByName("RewardSingle").getChildByName("Bg").getComponent(cc.Sprite).spriteFrame=s.default.instance.getBundleRes("BundleTexture","ShopUI/s"+e.rare,cc.SpriteFrame),this.node.getChildByName("RewardSingle").getChildByName("PlantIcon").getComponent(cc.Sprite).spriteFrame=s.default.instance.getBundleRes("BundleTexture","PlantIcon/p_"+e.plantID,cc.SpriteFrame)):"b"==e.rewardType?(c.default.instance.plantLock.includes(e.plantID)&&!l.default.instance.newPlant.includes(e.plantID)?this.node.getChildByName("RewardSingle").getChildByName("TipLabel").active=!0:this.node.getChildByName("RewardSingle").getChildByName("TipLabel").active=!1,this.node.getChildByName("RewardSingle").getChildByName("Chip").active=!1,1!=e.number?this.node.getChildByName("RewardSingle").getChildByName("Num").getComponent(cc.Label).string="X"+e.number:this.node.getChildByName("RewardSingle").getChildByName("Num").active=!1,this.node.getChildByName("RewardSingle").getChildByName("PlantIcon").active=!1,this.node.getChildByName("RewardSingle").getChildByName("PlantAni").active=!0,this.node.getChildByName("RewardSingle").getChildByName("Bg").active=!1,this.node.getChildByName("RewardSingle").getChildByName("PlantAni").getComponent(sp.Skeleton).skeletonData=s.default.instance.getBundleRes("Spine","plant/"+o.default.instance().getPlant(e.plantID).dragonName+"/"+o.default.instance().getPlant(e.plantID).dragonName,sp.SkeletonData),this.node.getChildByName("RewardSingle").getChildByName("PlantAni").getComponent(sp.Skeleton).setAnimation(0,"daiji",!0)):(this.node.getChildByName("RewardSingle").getChildByName("Chip").active=!1,this.node.getChildByName("RewardSingle").getChildByName("PlantIcon").scale=1,this.node.getChildByName("RewardSingle").getChildByName("Num").getComponent(cc.Label).string="X"+e.number,this.node.getChildByName("RewardSingle").getChildByName("TipLabel").active=!1,1==e.rare?this.node.getChildByName("RewardSingle").getChildByName("PlantIcon").getComponent(cc.Sprite).spriteFrame=s.default.instance.getBundleRes("BundleTexture","ui/a034",cc.SpriteFrame):this.node.getChildByName("RewardSingle").getChildByName("PlantIcon").getComponent(cc.Sprite).spriteFrame=s.default.instance.getBundleRes("BundleTexture","ui/a033",cc.SpriteFrame))}onClickNextBtn(){this.index>=9?this.showAll():(this.index++,this.showSingle())}onClickClose(){l.default.instance.drawGuide&&r.default.instance.uiList.GuideUI2&&r.default.instance.uiList.GuideUI2.emit("nextStep"),r.default.instance.closeUI("RewardUI"),i.default.instance.sdkType==i.SDK_TYPE.WeChat&&(i.default.instance.hideNative(2),i.default.instance.hideNative(3))}};u=n([d],u),a.default=u,cc._RF.pop()},{"../ADManager/ADManager":"ADManager","../Manager/BundleManager":"BundleManager","../Manager/DataManager":"DataManager","../Manager/PlantMgr":"PlantMgr","../Manager/UIManager":"UIManager","../Manager/UserDataManager":"UserDataManager"}],SceneStage:[function(e,t,a){"use strict";cc._RF.push(t,"e1b90/rohdEk4SdmmEZANaD","SceneStage");var n,i=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const s=e("../entity/Card"),l=e("../entity/Plant/PlantBase"),o=e("../utils/kc"),r=e("../Manager/PlantMgr"),c=e("../Manager/ZombieMgr"),d=e("../Manager/DataManager"),h=e("../Manager/BundleManager"),u=e("../utils/MyUtils"),g=e("../Manager/GoldManager"),p=e("../Manager/UIManager"),f=e("../Common"),m=e("../Manager/UserDataManager"),y=e("../Manager/AudioManager"),C=e("../utils/KDefine"),b=e("../entity/Gold"),P=e("../ADlibs/Hts"),v=e("../ADManager/ADManager"),M=e("../TaSdk/TaSdk"),B=e("../entity/Ball"),{ccclass:w,property:D}=cc._decorator;let S=n=class extends cc.Component{constructor(){super(...arguments),this.groudNode=null,this.cardPanel=null,this.plantPanel=null,this.goldNumLabel=null,this.shovel=null,this.gameProgress=null,this.autoBtn=null,this.sunParent=null,this.selectCardID=0,this.lastCardID=0,this.bombNums=0,this.allTime=0,this.nowTime=0,this.isPlay=!1,this.isGuide=!1,this.isRecord=!1,this.cardSelectShadow=null,this.groudXMin=d.default.instance.groudStartPo.x,this.groudXMax=d.default.instance.groudStartPo.x+d.default.instance.blockWidth*d.default.instance.col,this.groudYMin=d.default.instance.groudStartPo.y,this.groudYMax=d.default.instance.groudStartPo.y+d.default.instance.blockHeight*d.default.instance.row,this.pickStartPo=null,this.cardNodeMap=new Map,this.plantNodeMap=new Map,this.shovelShadow=null,this.autoPick=!1,this.tempPlant=null,this.ballPlantID=[],this.ballPlant=0,this.canCreateBall=!0}static get instance(){return this._instance}onLoad(){n._instance=this,d.default.instance.initBlockPos(),this.autoPick=!1,this.bombNums=0;let e=cc.find("Canvas/Bg").width*cc.find("Canvas/Bg").scaleX/2-o.default.view_x;20!=d.default.instance.level?y.default.instance.playMusic(C.AudioName.MainBgm,!0):y.default.instance.playMusic(C.AudioName.BossBgm,!0),cc.find("Canvas/Bg").getComponent(cc.Sprite).spriteFrame=h.default.instance.getBundleRes("BundleTexture","ui/Bg2",cc.SpriteFrame),cc.find("Canvas/Bg").x=81,cc.view.setOrientation(cc.macro.ORIENTATION_LANDSCAPE),this.goldNumLabel.string=this.goldNums+"",this.shovelShadow=cc.instantiate(this.shovel),this.shovelShadow.parent=this.groudNode,this.shovelShadow.setPosition(-1100,0),this.shovelShadow.opacity=140,p.default.instance.hideUI("MoneyPanelUI"),M.default.instance.postEvent("in_level",{level:d.default.instance.level}),this.ballPlant=0,this.node.getChildByName("PauseBtn").active=!1,cc.tween(cc.find("Canvas/Main Camera")).by(e/200,{x:e}).delay(1).by(e/200,{x:-e}).call(()=>{0!=d.default.instance.level?(p.default.instance.openUI("PrepareCards"),2!=d.default.instance.level||m.default.instance.levelGuide||(this.node.getChildByName("PauseBtn").active=!1,this.node.getChildByName("Bomb").active=!1,p.default.instance.openUI("GuideUI2").emit("nextStep"))):(this.node.getChildByName("Bomb").active=!1,p.default.instance.openUI("GuideUI2").emit("init",1))}).start(),this.initBallPlantID()}createBall(){this.ballPlant++;let e=cc.instantiate(h.default.instance.getBundleRes("Prefab","Object/plantBall",cc.Prefab));e.parent=this.node.getChildByName("ballNode"),e.getComponent(B.default).init(u.MyUtils.getArrRandomValue(n.instance.ballPlantID)),this.canCreateBall=!1,this.scheduleOnce(()=>{this.canCreateBall=!0},36)}initBallPlantID(){this.ballPlantID=[];for(let e=0;e<d.default.instance.rare5Array.length;e++)m.default.instance.plantLock.includes[this.ballPlantID[e]]||d.default.instance.selectPlantID.includes[this.ballPlantID[e]]||this.ballPlantID.push(d.default.instance.rare5Array[e])}initPlatform(){switch(v.default.instance.sdkType){case v.SDK_TYPE.Byte:v.default.instance.recorderStart(),this.node.getChildByName("Record").active=!0;break;case v.SDK_TYPE.WeChat:v.default.instance.hideNative(0)}}play(){this.showPlantDeck(),c.default.instance().init(this),0!=d.default.instance.level&&(this.node.getChildByName("PauseBtn").active=!0,this.node.getChildByName("shovelPanel").active=!0,this.autoBtn.active=!0,this.schedule(()=>{this.generateGold()},15)),this.node.getChildByName("Gold").active=!0,c.default.instance().play(),this.node.getChildByName("Begin").active=!0;let e=this.node.getChildByName("Begin").getComponent(sp.Skeleton).setAnimation(0,"kaishi",!1);this.node.getChildByName("Begin").getComponent(sp.Skeleton).setTrackEventListener(e,(e,t)=>{"S6"==t.data.name?y.default.instance.playEffect("S6"):"zi2"==t.data.name?y.default.instance.playEffect("zi"):"S161"==t.data.name&&y.default.instance.playEffect("S161")}),this.initPlatform()}huangGuaGuide(){p.default.instance.openUI("GuideUI2").emit("init",6)}onClickBomb(){if(this.bombNums>0)this.bombNums--,0==this.bombNums&&(this.node.getChildByName("Bomb").getChildByName("video").active=!0),this.shootBomb();else{let e=()=>{P.default.instance.eventReport("\u9ec4\u74dc\u70b8\u5f39\u89c6\u9891\u770b\u5b8c"),M.default.instance.AdsPlayRet(M.VideoIndex.huangGua,0),this.shootBomb()},t=()=>{P.default.instance.eventReport("\u9ec4\u74dc\u70b8\u5f39\u89c6\u9891\u53d6\u6d88"),M.default.instance.AdsPlayRet(M.VideoIndex.huangGua,1)},a=()=>{M.default.instance.AdsPlayRet(M.VideoIndex.huangGua,-1),P.default.instance.eventReport("\u9ec4\u74dc\u70b8\u5f39\u89c6\u9891\u52a0\u8f7d\u5931\u8d25")};v.default.instance.showVideo(e,t,a),M.default.instance.AdsButtonClick(M.VideoIndex.huangGua)}}shootBomb(){this.node.getChildByName("Bomb").getComponent(cc.Button).interactable=!1;let e=cc.instantiate(h.default.instance.getBundleRes("Prefab","Object/Bomb"));e.parent=this.node.getChildByName("Bomb");let t=e.getComponent(sp.Skeleton).setAnimation(0,"baozha",!1);e.getComponent(sp.Skeleton).setTrackEventListener(t,(e,t)=>{if(console.log("event===",t),"baozha"==t.data.name){y.default.instance.playEffect("HuangGuaEff");let e=[...c.default.instance().zombieSet.values()].length;for(let t=0;t<e;t++)[...c.default.instance().zombieSet.values()][t]&&[...c.default.instance().zombieSet.values()][t].hurt(1e3*m.default.instance.chapter)}}),e.getComponent(sp.Skeleton).setCompleteListener(()=>{this.node.getChildByName("Bomb").getComponent(cc.Button).interactable=!0,e.destroy(),2==d.default.instance.level&&p.default.instance.uiList.GuideUI2&&p.default.instance.uiList.GuideUI2.emit("nextStep")})}onClickRecord(){this.isRecord?(this.isRecord=!1,this.endTime=(new Date).getTime(),this.endTime-this.startTime>=3e3?v.default.instance.recorderStop():p.default.instance.showToast("\u5f55\u5c4f\u65f6\u957f\u5c0f\u4e8e3\u79d2"),this.node.getChildByName("Record").getComponentInChildren(cc.Sprite).spriteFrame=h.default.instance.getBundleRes("BundleTexture","ShareUI/play",cc.SpriteFrame),this.node.getChildByName("Record").children[2].active=!1,this.node.getChildByName("Record").getComponentInChildren(cc.Label).string="\u5f00\u59cb\u5f55\u5c4f"):(this.isRecord=!0,v.default.instance.recorderStart(),this.startTime=(new Date).getTime(),this.node.getChildByName("Record").getComponentInChildren(cc.Sprite).spriteFrame=h.default.instance.getBundleRes("BundleTexture","ShareUI/pause",cc.SpriteFrame),this.node.getChildByName("Record").getComponentInChildren(cc.Label).string="\u505c\u6b62\u5f55\u5c4f",this.node.getChildByName("Record").children[2].active=!0)}showProgress(e){this.gameProgress.getChildByName("Head").zIndex=33;let t=[];for(let a=0;a<e.length;a++)this.allTime+=e[a],t.push(this.allTime);for(let a=1;a<t.length;a++){let e=cc.instantiate(h.default.instance.getBundleRes("Prefab","Object/Chess"));e.parent=this.gameProgress,e.x=-this.gameProgress.width*t[a-1]/this.allTime}this.gameProgress.active=!0}get goldNums(){return this._goldNums}set goldNums(e){this._goldNums=e,this.goldNumLabel.string=e+"",this.cardNodeMap.forEach((e,t)=>{r.default.instance().getPlant(t).cost[m.default.instance.getPlantLevel(t)-1][1]>this.goldNums?e.getComponent(s.default).costMask.active=!0:e.getComponent(s.default).costMask.active=!1})}showPlantDeck(e=!1){this.shovel.on(cc.Node.EventType.TOUCH_START,this.onShovelStart,this),this.shovel.on(cc.Node.EventType.TOUCH_MOVE,this.onShovelMove,this),this.shovel.on(cc.Node.EventType.TOUCH_END,this.onShovelEnd,this),this.shovel.on(cc.Node.EventType.TOUCH_CANCEL,this.onShovelEnd,this),this.groudNode.getChildByName("Gird").on(cc.Node.EventType.TOUCH_END,this.onClickBg,this),(m.default.instance.huangGuaGuide||2!=d.default.instance.level&&0!=d.default.instance.level)&&this.showBomb(),M.default.instance.AdsExposure(M.VideoIndex.autoPick),M.default.instance.AdsExposure(M.VideoIndex.huangGua),this.showDeck(e)}showBomb(){this.node.getChildByName("Bomb").active=!0,this.bombNums>0?this.node.getChildByName("Bomb").getChildByName("video").active=!1:this.node.getChildByName("Bomb").getChildByName("video").active=!0}showDeck(e=!1){const t=d.default.instance.selectPlantID;o.default.uiLayout({resPath:{pic:"scene_stage/img/prop/",prefab:"scene_stage/"},layout:[{id:"plant",type:"gird",itemPadding:[0,7],colCount:1,itemPrefab:"PlantPrefab/plant_1"},{id:"card",type:"gird",itemPadding:[0,7],colCount:1,itemPrefab:"card/card_1"}]},[this.plantPanel,this.cardPanel],(e,t,a,n)=>{if("card"===n.id){const t=e.getComponent(s.default);return t.name=a,t.init(a),void this.cardNodeMap.set(a,e)}e.opacity=0,f.default.addPlantComponent(a,e);const i=e.getComponent(l.default);i.reset(a),i.node.on(cc.Node.EventType.TOUCH_START,this.onCardPick,this),i.node.on(cc.Node.EventType.TOUCH_MOVE,this.onCardMoving,this),i.node.on(cc.Node.EventType.TOUCH_END,this.onCardRelease,this),i.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onCardRelease,this),this.plantNodeMap.set(a,e)},[t,t],this,e)}onCardPick(e){const t=e.currentTarget;this.pickStartPo=t.getPosition();const a=t.getComponent(l.default);let n=a.cost;if(this.goldNums>=n){this.selectCardID=a.id,0!=this.lastCardID&&(this.cardNodeMap.get(this.lastCardID).getChildByName("HighLight").active=!1),this.cardNodeMap.get(this.selectCardID).getChildByName("HighLight").active=!0,this.lastCardID=this.selectCardID,a.canMove=!0,a.inUse=!1,a.node.opacity=255;const e=this.cardNodeMap.get(a.id);e.color=cc.color(100,100,100),t.parent=this.groudNode,t.setPosition(cc.v2(t.x,t.y+30).addSelf(this.plantPanel.getPosition())),t.getComponentInChildren(sp.Skeleton).setAnimation(0,"daiji",!0),this.cardSelectShadow=cc.instantiate(h.default.instance.getBundleRes("Prefab","card/card_2")),this.cardSelectShadow.getComponent(cc.Sprite).spriteFrame=e.getChildByName("icon").getComponent(cc.Sprite).spriteFrame,this.cardSelectShadow.parent=this.groudNode,this.cardSelectShadow.opacity=0}}generateGold(){let e=u.MyUtils.getRandomInt(-450,400),t=u.MyUtils.getRandomInt(0,5);g.default.instance.getItem(e,470,t,50).parent=this.sunParent}onCardMoving(e){const t=e.currentTarget;if(!t.getComponent(l.default).canMove)return;const a=cc.v2(t.x+e.getDeltaX(),t.y+e.getDeltaY());t.setPosition(a);const n=this.checkMovedPlantPos(a);n&&(this.cardSelectShadow.setPosition(n[0].x,n[0].y+30),this.cardSelectShadow.opacity=150)}onCardRelease(e){const t=e.currentTarget,a=t.getComponent(l.default);if(!a.canMove)return;const n=cc.v2(e.currentTarget.x,e.currentTarget.y);a.canMove=!1,t.opacity=0,t.parent=this.plantPanel,t.setPosition(this.pickStartPo),this.cardSelectShadow.destroy();const i=this.checkMovedPlantPos(n);if(!i)return void(this.cardNodeMap.get(a.id).color=cc.Color.WHITE);this.cardNodeMap.get(this.selectCardID).getChildByName("HighLight").active=!1,this.selectCardID=0,this.lastCardID=0;let o=a.cost;this.goldNums-=o,this.cardNodeMap.get(a.id).getComponent(s.default).showCD();const r=cc.instantiate(t);r.parent=this.groudNode,r.opacity=255,r.setPosition(i[0].x,i[0].y-10),r.getComponent(l.default).reset(a.id,!0),r.getComponent(l.default).play(i[1],i[2]),r.getChildByName("PlantEffect").active=!0,d.default.instance.blockArr[i[1]][i[2]][1]=r,this.cardNodeMap.get(a.id).color=cc.Color.WHITE,y.default.instance.playEffect(C.AudioName.PutPlantEff)}onClickBg(e){if(0!=this.selectCardID){let t=e.getLocation(),a=this.groudNode.convertToNodeSpaceAR(t),n=this.checkMovedPlantPos(a);if(n){let e=this.plantNodeMap.get(this.selectCardID);this.cardNodeMap.get(this.selectCardID).getChildByName("HighLight").active=!1,this.selectCardID=0,this.lastCardID=0;let t=e.getComponent(l.default).cost;this.goldNums-=t,this.cardNodeMap.get(e.getComponent(l.default).id).getComponent(s.default).showCD();const a=cc.instantiate(e);a.parent=this.groudNode,a.opacity=255,a.setPosition(n[0]),a.getComponent(l.default).reset(e.getComponent(l.default).id,!0),a.getComponent(l.default).play(n[1],n[2]),a.getChildByName("PlantEffect").active=!0,d.default.instance.blockArr[n[1]][n[2]][1]=a}}}onClickAutoBtn(){v.default.instance.showVideo(()=>{this.autoBtn.active=!1,this.autoPick=!0;for(let e=0;e<this.sunParent.childrenCount;e++)this.sunParent.children[e].getComponent(b.default).onClickGold();P.default.instance.eventReport("\u81ea\u52a8\u6536\u96c6\u9633\u5149\u89c6\u9891\u770b\u5b8c"),M.default.instance.AdsPlayRet(M.VideoIndex.autoPick,0)},()=>{P.default.instance.eventReport("\u81ea\u52a8\u6536\u96c6\u9633\u5149\u89c6\u9891\u53d6\u6d88"),M.default.instance.AdsPlayRet(M.VideoIndex.autoPick,1)},()=>{P.default.instance.eventReport("\u81ea\u52a8\u6536\u96c6\u9633\u5149\u89c6\u9891\u52a0\u8f7d\u5931\u8d25"),M.default.instance.AdsPlayRet(M.VideoIndex.autoPick,-1)}),M.default.instance.AdsButtonClick(M.VideoIndex.autoPick)}onClickPause(){p.default.instance.openUI("PauseUI",30)}lose(){P.default.instance.eventReport("\u7b2c"+m.default.instance.chapter+"\u5468\u76ee\u7b2c"+d.default.instance.level+"\u5173\u5931\u8d25"),M.default.instance.postEvent("level",{level:d.default.instance.level,is_Win:0}),p.default.instance.closeUI("MainUI"),p.default.instance.openUI("FailUI")}win(){P.default.instance.eventReport("\u7b2c"+m.default.instance.chapter+"\u5468\u76ee\u7b2c"+d.default.instance.level+"\u5173\u6210\u529f"),M.default.instance.postEvent("level",{level:d.default.instance.level,is_Win:1}),this.scheduleOnce(()=>{p.default.instance.closeUI("MainUI"),p.default.instance.openUI("SuccessUI")},3)}checkMovedPlantPos(e){if(e.x>this.groudXMax||e.x<this.groudXMin||e.y>this.groudYMax||e.y<this.groudYMin)return null;const t=e.sub(d.default.instance.groudStartPo),a=Math.floor(t.x/d.default.instance.blockWidth),n=Math.floor(t.y/d.default.instance.blockHeight);return d.default.instance.blockArr[n][a][1]?null:[d.default.instance.blockArr[n][a][0],n,a]}getShovelShadowPos(e){if(e.x>=this.groudXMax||e.x<=this.groudXMin||e.y>=this.groudYMax||e.y<=this.groudYMin)return null;const t=e.sub(d.default.instance.groudStartPo),a=Math.floor(t.x/d.default.instance.blockWidth),n=Math.floor(t.y/d.default.instance.blockHeight);return[d.default.instance.blockArr[n][a][0],n,a]}onShovelStart(e){e.currentTarget.parent.getChildByName("shovelBtn").opacity=140,e.currentTarget.opacity=255}onShovelMove(e){e.currentTarget.setPosition(e.currentTarget.x+e.getDeltaX()/this.node.scale,e.currentTarget.y+e.getDeltaY()/this.node.scale);let t=this.getShovelShadowPos(e.currentTarget.getPosition());if(t){this.shovelShadow.setPosition(t[0].x,t[0].y+30);let e=t[1],a=t[2];d.default.instance.blockArr[e][a][1]?(this.tempPlant&&(this.tempPlant.opacity=255),this.tempPlant=d.default.instance.blockArr[e][a][1],this.tempPlant.opacity=140):this.tempPlant&&(this.tempPlant.opacity=255,this.tempPlant=null)}}onShovelEnd(e){let t=this.getShovelShadowPos(e.currentTarget.getPosition());if(t){let e=t[1],a=t[2];d.default.instance.blockArr[e][a][1]&&(d.default.instance.blockArr[e][a][1].destroy(),this.delPlantInBlckArr(e,a),y.default.instance.playEffect(C.AudioName.ShovelEff))}else this.tempPlant&&(this.tempPlant.opacity=255,this.tempPlant=null);e.currentTarget.parent.getChildByName("shovelBtn").opacity=255,e.currentTarget.opacity=0,e.currentTarget.x=500,e.currentTarget.y=-300,this.shovelShadow.setPosition(-1100,0)}delPlantInBlckArr(e,t){d.default.instance.blockArr[e][t][1]=null}update(e){this.isPlay&&!this.isGuide&&(this.nowTime+=e,this.gameProgress.getComponent(cc.ProgressBar).progress=this.nowTime/this.allTime,this.gameProgress.getChildByName("Head").x=-this.gameProgress.getComponent(cc.ProgressBar).progress*this.gameProgress.width)}onDestroy(){v.default.instance.hideBanner()}};S._instance=null,i([D(cc.Node)],S.prototype,"groudNode",void 0),i([D(cc.Node)],S.prototype,"cardPanel",void 0),i([D(cc.Node)],S.prototype,"plantPanel",void 0),i([D(cc.Label)],S.prototype,"goldNumLabel",void 0),i([D(cc.Node)],S.prototype,"shovel",void 0),i([D(cc.Node)],S.prototype,"gameProgress",void 0),i([D(cc.Node)],S.prototype,"autoBtn",void 0),i([D(cc.Node)],S.prototype,"sunParent",void 0),S=n=i([w],S),a.default=S,cc._RF.pop()},{"../ADManager/ADManager":"ADManager","../ADlibs/Hts":"Hts","../Common":"Common","../Manager/AudioManager":"AudioManager","../Manager/BundleManager":"BundleManager","../Manager/DataManager":"DataManager","../Manager/GoldManager":"GoldManager","../Manager/PlantMgr":"PlantMgr","../Manager/UIManager":"UIManager","../Manager/UserDataManager":"UserDataManager","../Manager/ZombieMgr":"ZombieMgr","../TaSdk/TaSdk":"TaSdk","../entity/Ball":"Ball","../entity/Card":"Card","../entity/Gold":"Gold","../entity/Plant/PlantBase":"PlantBase","../utils/KDefine":"KDefine","../utils/MyUtils":"MyUtils","../utils/kc":"kc"}],SharePanelUI:[function(e,t,a){"use strict";cc._RF.push(t,"dfb1fnoMEdDOaZ8Rh4r1ykK","SharePanelUI");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const i=e("../ADlibs/Hts"),s=e("../ADManager/ADManager"),l=e("../Manager/UIManager"),o=e("../Manager/UserDataManager"),{ccclass:r,property:c}=cc._decorator;let d=class extends cc.Component{constructor(){super(...arguments),this.rewardNum=null,this.titleLabel=null}onLoad(){o.default.instance.shareReward?this.rewardNum.string="+100":this.rewardNum.string="+20"}init(e){this.titleLabel.string=0==e?"\u6280\u672f\u60ca\u4eba\uff01\u5206\u4eab\u7ed9\u4f60\u7684\u670b\u53cb\u4eec\u770b\u770b\uff01":"\u4f60\u7684\u53a8\u827a\u60ca\u4eba\uff0c\u6cbb\u597d\u4e86\u6211\u7684\u7cbe\u795e\u5185\u8017\uff01"}onClickShareBtn(){s.default.instance.share(()=>{i.default.instance.eventReport("\u5206\u4eab\u6210\u529f"),o.default.instance.shareReward?(o.default.instance.shareReward=!1,o.default.instance.diamond+=100):o.default.instance.diamond+=20,this.onClickClose()})}onClickClose(){l.default.instance.closeUI("SharePanelUI")}};n([c(cc.Label)],d.prototype,"rewardNum",void 0),n([c(cc.Label)],d.prototype,"titleLabel",void 0),d=n([r],d),a.default=d,cc._RF.pop()},{"../ADManager/ADManager":"ADManager","../ADlibs/Hts":"Hts","../Manager/UIManager":"UIManager","../Manager/UserDataManager":"UserDataManager"}],ShopItem:[function(e,t,a){"use strict";cc._RF.push(t,"20abcDZu61PhLda/WcTcrjq","ShopItem");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const i=e("../ADlibs/Hts"),s=e("../ADManager/ADManager"),l=e("../Manager/BundleManager"),o=e("../Manager/DataManager"),r=e("../Manager/PlantMgr"),c=e("../Manager/UIManager"),d=e("../Manager/UserDataManager"),h=e("../TaSdk/TaSdk"),u=e("../view/NoCoinUI"),g=e("../view/RewardUI"),{ccclass:p}=cc._decorator;let f=class extends cc.Component{onLoad(){}init(e,t){if(this.id=t,this.shopItem=e,this.node.getChildByName("Plant").getChildByName("PlantIcon").getComponent(cc.Sprite).spriteFrame=l.default.instance.getBundleRes("BundleTexture","PlantIcon/p_"+this.shopItem.id,cc.SpriteFrame),d.default.instance.plantLock.includes(this.shopItem.id))this.node.getChildByName("Num").active=!1,this.node.getChildByName("Label").active=!0;else{let e=d.default.instance.getPlantChip(this.shopItem.id);this.node.getChildByName("Num").getComponent(cc.RichText).string=e>=20?`(<color=#FFFFFF><outline color=black>${e}</outline></color>/20)`:`(<color=#FF0000><outline color=black>${e}</outline></color>/20)`,this.node.getChildByName("Label").active=!1,this.node.getChildByName("Num").active=!0}this.node.getChildByName("Desc").color=o.default.instance.rareColor[this.shopItem.rare-1],this.node.getChildByName("Cost").getChildByName("CostNum").getComponent(cc.Label).string=this.shopItem.cost,this.node.getChildByName("Plant").getComponent(cc.Sprite).spriteFrame=l.default.instance.getBundleRes("BundleTexture","ShopUI/s"+this.shopItem.rare,cc.SpriteFrame),1==this.shopItem.discount?(this.node.getChildByName("Cost").getChildByName("DiscountNum").active=!1,this.node.getChildByName("Cost").getChildByName("CostNum").getChildByName("line").active=!1,this.node.getChildByName("discount").active=!1,this.node.getChildByName("VideoBtn").active=!1,this.node.getChildByName("BuyBtn").active=!0):(0==this.shopItem.discount?(this.node.getChildByName("VideoBtn").active=!0,h.default.instance.AdsExposure(h.VideoIndex.freeShop),this.node.getChildByName("BuyBtn").active=!1,this.node.getChildByName("discount").active=!1):(.5==this.shopItem.discount?this.node.getChildByName("discount").getComponent(cc.Sprite).spriteFrame=l.default.instance.getBundleRes("BundleTexture","ShopUI/discount5",cc.SpriteFrame):this.node.getChildByName("discount").getComponent(cc.Sprite).spriteFrame=l.default.instance.getBundleRes("BundleTexture","ShopUI/discount8",cc.SpriteFrame),this.node.getChildByName("discount").active=!0,this.node.getChildByName("VideoBtn").active=!1,this.node.getChildByName("BuyBtn").active=!0),this.node.getChildByName("Cost").getChildByName("DiscountNum").active=!0,this.node.getChildByName("Cost").getChildByName("CostNum").getChildByName("line").active=!0,this.node.getChildByName("Cost").getChildByName("DiscountNum").getComponent(cc.Label).string=Math.floor(this.shopItem.cost*this.shopItem.discount)+""),"a"==this.shopItem.type?(this.node.getChildByName("Plant").getChildByName("Chip").active=!0,this.node.getChildByName("Plant").getChildByName("Num").active=!0,this.node.getChildByName("Plant").getChildByName("Num").getComponent(cc.Label).string="X"+this.shopItem.number,this.node.getChildByName("Desc").getComponent(cc.Label).string=r.default.instance().getPlant(this.shopItem.id).name+"\u788e\u7247"):(this.node.getChildByName("Plant").getChildByName("Chip").active=!1,this.node.getChildByName("Plant").getChildByName("Num").active=!1,this.node.getChildByName("Desc").getComponent(cc.Label).string=r.default.instance().getPlant(this.shopItem.id).name),"g"==this.shopItem.costType?this.node.getChildByName("Cost").getComponent(cc.Sprite).spriteFrame=l.default.instance.getBundleRes("BundleTexture","ui/a043",cc.SpriteFrame):this.node.getChildByName("Cost").getComponent(cc.Sprite).spriteFrame=l.default.instance.getBundleRes("BundleTexture","ui/a042",cc.SpriteFrame),this.shopItem.bought?(this.node.getChildByName("Mask").active=!0,this.node.getChildByName("Label").active=!1):this.node.getChildByName("Mask").active=!1}onClickBuyBtn(){if("g"==this.shopItem.costType){if(d.default.instance.gold<this.shopItem.cost*this.shopItem.discount)return void c.default.instance.openUI("NoCoinUI",50).getComponent(u.default).init(0);d.default.instance.gold-=this.shopItem.cost*this.shopItem.discount}else{if(d.default.instance.diamond<this.shopItem.cost*this.shopItem.discount)return void c.default.instance.openUI("NoCoinUI",50).getComponent(u.default).init(1);this.shopItem.costType,d.default.instance.diamond-=this.shopItem.cost*this.shopItem.discount}this.getreward()}onClickVideoBtn(){h.default.instance.AdsButtonClick(h.VideoIndex.freeShop),s.default.instance.showVideo(()=>{this.getreward(),i.default.instance.eventReport("\u5546\u5e97\u514d\u8d39\u5546\u54c1\u89c6\u9891\u89c2\u770b\u6210\u529f"),h.default.instance.AdsPlayRet(h.VideoIndex.freeShop,0)},()=>{i.default.instance.eventReport("\u5546\u5e97\u514d\u8d39\u5546\u54c1\u89c6\u9891\u89c2\u770b\u53d6\u6d88"),h.default.instance.AdsPlayRet(h.VideoIndex.freeShop,1)},()=>{h.default.instance.AdsPlayRet(h.VideoIndex.freeShop,-1),i.default.instance.eventReport("\u5546\u5e97\u514d\u8d39\u5546\u54c1\u89c6\u9891\u52a0\u8f7d\u5931\u8d25")})}getreward(){"a"==this.shopItem.type?d.default.instance.setPlantChip(this.shopItem.id,this.shopItem.number):d.default.instance.getPlant(this.shopItem.id);let e=[{rewardType:this.shopItem.type,rare:this.shopItem.rare,number:this.shopItem.number,plantID:this.shopItem.id}];this.shopItem.bought=!0,this.init(this.shopItem,this.id),c.default.instance.openUI("RewardUI",30).getComponent(g.default).init(e),d.default.instance.changeshopInfo(this.id,this.shopItem);let t=cc.instantiate(this.node);this.node.parent.addChild(t),this.node.removeFromParent()}};f=n([p],f),a.default=f,cc._RF.pop()},{"../ADManager/ADManager":"ADManager","../ADlibs/Hts":"Hts","../Manager/BundleManager":"BundleManager","../Manager/DataManager":"DataManager","../Manager/PlantMgr":"PlantMgr","../Manager/UIManager":"UIManager","../Manager/UserDataManager":"UserDataManager","../TaSdk/TaSdk":"TaSdk","../view/NoCoinUI":"NoCoinUI","../view/RewardUI":"RewardUI"}],ShopUI:[function(e,t,a){"use strict";cc._RF.push(t,"b8f8euRubBES6qVGdStFVOA","ShopUI");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const i=e("../ADlibs/Hts"),s=e("../ADManager/AD/WeChat/WeChatConstant"),l=e("../ADManager/ADManager"),o=e("../entity/ShopItem"),r=e("../Manager/BundleManager"),c=e("../Manager/UIManager"),d=e("../Manager/UserDataManager"),h=e("../TaSdk/TaSdk"),u=e("../utils/MyUtils"),g=e("./MenuUI"),{ccclass:p,property:f}=cc._decorator;let m=class extends cc.Component{constructor(){super(...arguments),this.list=null,this.boughtItem=[]}onLoad(){h.default.instance.AdsExposure(h.VideoIndex.refreshShop),this.initPanel(),this.refreshVideoBtn(),this.refreshTime(),this.initPlatform(),this.schedule(()=>{this.refreshTime()},1),h.default.instance.postEvent("System",{system:"\u5546\u5e97"})}initPlatform(){switch(l.default.instance.sdkType){case l.SDK_TYPE.WeChat:l.default.instance.showNative(2),l.default.instance.showNative(3),l.default.instance.showNative(1),l.default.instance.hideNative(0)}}refreshTime(){d.default.instance.getHour()!=d.default.instance.shopHour&&(d.default.instance.getShopInfo(),this.refreshPanel());let e=new Date,t="0"+(d.default.instance.shopHour+7-e.getHours()).toString(),a=59-e.getMinutes();a<10&&(a="0"+a.toString());let n=59-e.getSeconds();n<10&&(n="0"+n.toString()),this.node.getChildByName("Bg").getChildByName("Time").getComponentInChildren(cc.Label).string="\u5237\u65b0\u5012\u8ba1\u65f6\uff1a "+t+"\uff1a"+a+"\uff1a"+n}initPanel(){for(let e=0;e<8;e++){let t=d.default.instance.shopInfo[e];if(t.bought)this.boughtItem.push(t);else{let a=cc.instantiate(r.default.instance.getBundleRes("Prefab","Object/ShopItem"));a.getComponent(o.default).init(t,e),a.parent=this.list}}for(let e=0;e<this.boughtItem.length;e++){let t=cc.instantiate(r.default.instance.getBundleRes("Prefab","Object/ShopItem"));t.getComponent(o.default).init(this.boughtItem[e],e),t.parent=this.list}}refreshVideoBtn(){this.node.getChildByName("VideoBtn").getComponentInChildren(cc.Label).string="\u7acb\u5373\u5237\u65b0("+d.default.instance.shopRefreshTimes+"/5)"}refreshPanel(){for(let e=0;e<8;e++){let t=d.default.instance.shopInfo[e],a=this.list.children[e];a.getComponent(o.default).init(t,e),a.parent=this.list}}onClickRefreshBtn(){if(d.default.instance.shopRefreshTimes>=5)return c.default.instance.showToast("\u4eca\u65e5\u5237\u65b0\u6b21\u6570\u5df2\u8fbe\u4e0a\u9650\uff01"),void i.default.instance.eventReport("\u5237\u65b0\u5546\u5e97\u8fbe\u4e0a\u7ebf\u5237\u65b0\u5931\u8d25");h.default.instance.AdsButtonClick(h.VideoIndex.refreshShop),l.default.instance.showVideo(()=>{i.default.instance.eventReport("\u5237\u65b0\u5546\u5e97\u89c6\u9891\u89c2\u770b\u6210\u529f"),d.default.instance.shopRefreshTimes++,d.default.instance.getShopInfo(),this.refreshPanel(),this.refreshVideoBtn(),h.default.instance.AdsPlayRet(h.VideoIndex.refreshShop,0)},()=>{i.default.instance.eventReport("\u5237\u65b0\u5546\u5e97\u89c6\u9891\u89c2\u770b\u53d6\u6d88"),h.default.instance.AdsPlayRet(h.VideoIndex.refreshShop,1)},()=>{h.default.instance.AdsPlayRet(h.VideoIndex.refreshShop,-1),i.default.instance.eventReport("\u5237\u65b0\u5546\u5e97\u89c6\u9891\u52a0\u8f7d\u5931\u8d25")})}onClickCloseBtn(){c.default.instance.closeUI("ShopUI"),c.default.instance.uiList.MenuUI.getComponent(g.default).showNode(),l.default.instance.sdkType==l.SDK_TYPE.WeChat&&(u.MyUtils.probability(s.default.mainInster)&&l.default.instance.showInsert(),l.default.instance.hideNative(2),l.default.instance.hideNative(3),l.default.instance.hideNative(1),l.default.instance.showNative(0))}};n([f(cc.Node)],m.prototype,"list",void 0),m=n([p],m),a.default=m,cc._RF.pop()},{"../ADManager/AD/WeChat/WeChatConstant":"WeChatConstant","../ADManager/ADManager":"ADManager","../ADlibs/Hts":"Hts","../Manager/BundleManager":"BundleManager","../Manager/UIManager":"UIManager","../Manager/UserDataManager":"UserDataManager","../TaSdk/TaSdk":"TaSdk","../entity/ShopItem":"ShopItem","../utils/MyUtils":"MyUtils","./MenuUI":"MenuUI"}],SignUI:[function(e,t,a){"use strict";cc._RF.push(t,"57b76O50a5PSYCYRz3a3duT","SignUI");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const i=e("../ADlibs/Hts"),s=e("../ADManager/AD/WeChat/WeChatConstant"),l=e("../ADManager/ADManager"),o=e("../Manager/BundleManager"),r=e("../Manager/DataManager"),c=e("../Manager/PlantMgr"),d=e("../Manager/UIManager"),h=e("../Manager/UserDataManager"),u=e("../TaSdk/TaSdk"),g=e("../utils/MyUtils"),p=e("./MenuUI"),{ccclass:f,property:m}=cc._decorator;let y=class extends cc.Component{constructor(){super(...arguments),this.signPanel=null,this.rewardType={rewardType:0,rare:0,number:0,plantID:0}}onLoad(){this.refreshSignPanel(),this.getRewardInfo(h.default.instance.signDay),u.default.instance.postEvent("System",{system:"\u7b7e\u5230"}),this.initPlatform()}refreshSignPanel(){for(let e=0;e<7;e++)0==h.default.instance.signDay&&h.default.instance.signTimes>0?(this.signPanel.children[e].getChildByName("Mask").active=!0,this.signPanel.children[e].getChildByName("Spine").active=!1):(e<h.default.instance.signDay&&(this.signPanel.children[e].getChildByName("Mask").active=!0,this.signPanel.children[e].getChildByName("Spine").active=!1),e==h.default.instance.signDay&&0==h.default.instance.signTimes?this.signPanel.children[e].getChildByName("Tip").active=!0:this.signPanel.children[e].getChildByName("Tip").active=!1)}onClickSign(e,t){h.default.instance.signTimes>0?d.default.instance.showToast("\u5df2\u7ecf\u7b7e\u5230\u8fc7\u4e86, \u8bf7\u660e\u5929\u518d\u6765"):h.default.instance.signDay==parseInt(t)-1?(u.default.instance.postEvent("SignIn",{Day:h.default.instance.signDay,Way:1}),h.default.instance.signDay++,h.default.instance.signTimes=1,this.showReward()):d.default.instance.showToast("\u5f53\u5929\u5956\u52b1\u672a\u9886\u53d6\uff01")}getReward(e=!1){switch(h.default.instance.signDay){case 0:h.default.instance.getPlant(20),1==e&&h.default.instance.getPlant(20);break;case 1:h.default.instance.gold+=5e3,1==e&&(h.default.instance.gold+=5e3);break;case 2:h.default.instance.getPlant(22),1==e&&h.default.instance.getPlant(22);break;case 3:h.default.instance.diamond+=100,1==e&&(h.default.instance.diamond+=100);break;case 4:h.default.instance.setPlantChip(19,10),1==e&&h.default.instance.setPlantChip(19,10);break;case 5:h.default.instance.gold+=15e3,1==e&&(h.default.instance.gold+=15e3);break;case 6:h.default.instance.diamond+=300,1==e&&(h.default.instance.diamond+=300)}this.refreshSignPanel(),this.node.getChildByName("RewardUI").active=!1}getRewardInfo(e){switch(e){case 0:this.rewardType.rare=1,this.rewardType.rewardType="c",this.rewardType.number=5e3;break;case 1:this.rewardType.rare=5,this.rewardType.rewardType="b",this.rewardType.plantID=22;break;case 2:this.rewardType.rare=2,this.rewardType.rewardType="c",this.rewardType.number=100;break;case 3:this.rewardType.rare=5,this.rewardType.rewardType="a",this.rewardType.number=10,this.rewardType.plantID=19;break;case 4:this.rewardType.rare=1,this.rewardType.rewardType="c",this.rewardType.number=15e3;break;case 5:this.rewardType.rare=2,this.rewardType.rewardType="c",this.rewardType.number=300;break;case 6:this.rewardType.rare=5,this.rewardType.rewardType="b",this.rewardType.plantID=20}return e}showReward(e=!1){this.node.getChildByName("RewardUI").active=!0,"a"==this.rewardType.rewardType?(this.node.getChildByName("RewardUI").getChildByName("RewardSingle").getChildByName("TipLabel").active=!1,this.node.getChildByName("RewardUI").getChildByName("RewardSingle").getChildByName("Chip").active=!0,this.node.getChildByName("RewardUI").getChildByName("RewardSingle").getChildByName("Num").active=!0,this.node.getChildByName("RewardUI").getChildByName("RewardSingle").getChildByName("PlantIcon").active=!0,this.node.getChildByName("RewardUI").getChildByName("RewardSingle").getChildByName("PlantAni").active=!1,this.node.getChildByName("RewardUI").getChildByName("RewardSingle").getChildByName("Bg").active=!0,this.node.getChildByName("RewardUI").getChildByName("RewardSingle").getChildByName("Num").getComponent(cc.Label).string="X"+this.rewardType.number,this.node.getChildByName("RewardUI").getChildByName("RewardSingle").getChildByName("Bg").getComponent(cc.Sprite).spriteFrame=o.default.instance.getBundleRes("BundleTexture","ShopUI/s"+this.rewardType.rare,cc.SpriteFrame),this.node.getChildByName("RewardUI").getChildByName("RewardSingle").getChildByName("PlantIcon").getComponent(cc.Sprite).spriteFrame=o.default.instance.getBundleRes("BundleTexture","PlantIcon/p_"+this.rewardType.plantID,cc.SpriteFrame)):"b"==this.rewardType.rewardType?(h.default.instance.plantLock.includes(this.rewardType.plantID)&&!r.default.instance.newPlant.includes(this.rewardType.plantID)?this.node.getChildByName("RewardUI").getChildByName("RewardSingle").getChildByName("TipLabel").active=!0:this.node.getChildByName("RewardUI").getChildByName("RewardSingle").getChildByName("TipLabel").active=!1,this.node.getChildByName("RewardUI").getChildByName("RewardSingle").getChildByName("Chip").active=!1,1!=this.rewardType.number&&0!=this.rewardType.number?this.node.getChildByName("RewardUI").getChildByName("RewardSingle").getChildByName("Num").getComponent(cc.Label).string="X"+this.rewardType.number:this.node.getChildByName("RewardUI").getChildByName("RewardSingle").getChildByName("Num").active=!1,this.node.getChildByName("RewardUI").getChildByName("RewardSingle").getChildByName("PlantIcon").active=!1,this.node.getChildByName("RewardUI").getChildByName("RewardSingle").getChildByName("PlantAni").active=!0,this.node.getChildByName("RewardUI").getChildByName("RewardSingle").getChildByName("Bg").active=!1,this.node.getChildByName("RewardUI").getChildByName("RewardSingle").getChildByName("PlantAni").getComponent(sp.Skeleton).skeletonData=o.default.instance.getBundleRes("Spine","plant/"+c.default.instance().getPlant(this.rewardType.plantID).dragonName+"/"+c.default.instance().getPlant(this.rewardType.plantID).dragonName,sp.SkeletonData),this.node.getChildByName("RewardUI").getChildByName("RewardSingle").getChildByName("PlantAni").getComponent(sp.Skeleton).setAnimation(0,"daiji",!0)):(this.node.getChildByName("RewardUI").getChildByName("RewardSingle").getChildByName("Chip").active=!1,this.node.getChildByName("RewardUI").getChildByName("RewardSingle").getChildByName("PlantIcon").scale=1,this.node.getChildByName("RewardUI").getChildByName("RewardSingle").getChildByName("Num").getComponent(cc.Label).string="X"+this.rewardType.number,this.node.getChildByName("RewardUI").getChildByName("RewardSingle").getChildByName("TipLabel").active=!1,1==this.rewardType.rare?this.node.getChildByName("RewardUI").getChildByName("RewardSingle").getChildByName("PlantIcon").getComponent(cc.Sprite).spriteFrame=o.default.instance.getBundleRes("BundleTexture","ui/a034",cc.SpriteFrame):this.node.getChildByName("RewardUI").getChildByName("RewardSingle").getChildByName("PlantIcon").getComponent(cc.Sprite).spriteFrame=o.default.instance.getBundleRes("BundleTexture","ui/a033",cc.SpriteFrame)),e&&(this.node.getChildByName("RewardUI").getChildByName("RewardBtnPanel").children[1].active=!1)}onClickVideoBtn(e,t){u.default.instance.AdsButtonClick(u.VideoIndex.sign),l.default.instance.showVideo(()=>{h.default.instance.signTimes=2,"1"==t?this.getReward(!0):this.showReward(!0),i.default.instance.eventReport("\u7b7e\u5230\u89c6\u9891\u770b\u5b8c"),u.default.instance.postEvent("SignIn",{Day:h.default.instance.signDay,Way:2}),u.default.instance.AdsPlayRet(u.VideoIndex.sign,0)},()=>{u.default.instance.AdsPlayRet(u.VideoIndex.sign,1),i.default.instance.eventReport("\u7b7e\u5230\u89c6\u9891\u53d6\u6d88")},()=>{u.default.instance.AdsPlayRet(u.VideoIndex.sign,-1),i.default.instance.eventReport("\u7b7e\u5230\u89c6\u9891\u52a0\u8f7d\u5931\u8d25")})}onClickCloseBtn(){d.default.instance.closeUI("SignUI"),d.default.instance.uiList.MenuUI.getComponent(p.default).showNode(),l.default.instance.sdkType==l.SDK_TYPE.WeChat&&(g.MyUtils.probability(s.default.mainInster)&&l.default.instance.showInsert(),l.default.instance.hideNative(2),l.default.instance.hideNative(3),l.default.instance.showNative(0),l.default.instance.hideNative(1))}initPlatform(){switch(l.default.instance.sdkType){case l.SDK_TYPE.WeChat:l.default.instance.showNative(1),l.default.instance.hideNative(0),l.default.instance.showNative(2),l.default.instance.showNative(3)}}};n([m(cc.Node)],y.prototype,"signPanel",void 0),y=n([f],y),a.default=y,cc._RF.pop()},{"../ADManager/AD/WeChat/WeChatConstant":"WeChatConstant","../ADManager/ADManager":"ADManager","../ADlibs/Hts":"Hts","../Manager/BundleManager":"BundleManager","../Manager/DataManager":"DataManager","../Manager/PlantMgr":"PlantMgr","../Manager/UIManager":"UIManager","../Manager/UserDataManager":"UserDataManager","../TaSdk/TaSdk":"TaSdk","../utils/MyUtils":"MyUtils","./MenuUI":"MenuUI"}],StateComponent:[function(e,t,a){"use strict";cc._RF.push(t,"659f2OzGXdBurwHH1rtuGFy","StateComponent");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const i=e("./KDefine"),{ccclass:s,property:l}=cc._decorator;let o=class extends cc.Component{constructor(){super(...arguments),this.state=i.State.idle,this.stateMap={idle:()=>{}}}setState(e,t=!1){t||cc.Tween.stopAllByTarget(this.node),this.state=e}regState(e,t){this.stateMap[e]=t}updateFrame(e){this.stateMap[this.state].call(this,e)}};o=n([s],o),a.default=o,cc._RF.pop()},{"./KDefine":"KDefine"}],SuccessUI:[function(e,t,a){"use strict";cc._RF.push(t,"6eaadTo7K1I5LCT/PB3+ncg","SuccessUI");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const i=e("../ADlibs/Hts"),s=e("../ADManager/AD/Byte/ByteConstant"),l=e("../ADManager/AD/WeChat/WeChatConstant"),o=e("../ADManager/ADManager"),r=e("../Manager/AudioManager"),c=e("../Manager/BundleManager"),d=e("../Manager/DataManager"),h=e("../Manager/ExcelManager"),u=e("../Manager/PlantMgr"),g=e("../Manager/UIManager"),p=e("../Manager/UserDataManager"),f=e("../TaSdk/TaSdk"),m=e("../utils/KDefine"),y=e("../utils/MyUtils"),C=e("./SharePanelUI"),b=e("./TryPanelUI"),{ccclass:P,property:v}=cc._decorator;let M=class extends cc.Component{constructor(){super(...arguments),this.rewardGet=!1,this.levelId=1,this.rewardArray=[{gold:0,diamond:0,chip:[1,0]},{gold:0,diamond:0,chip:[1,0]},{gold:0,diamond:0,chip:[1,0]}]}onLoad(){if(this.levelId=d.default.instance.level,this.rewardConfig=h.ExcelMgr.instance.GetExcelObject(h.TableName.levelTable)[this.levelId].rewardConfig,0==d.default.instance.level&&(d.default.instance.level=1),d.default.instance.clearTempData(),r.default.instance.playMusic(m.AudioName.SuccessBgm),this.rewardGet=!0,y.MyUtils.removeArrElement(d.default.instance.tryPlant,20),d.default.instance.level==p.default.instance.level&&(20==d.default.instance.level?d.default.instance.newChapter=!0:(p.default.instance.level++,d.default.instance.focus=!0),0!=h.ExcelMgr.instance.GetExcelObject(h.TableName.levelTable)[this.levelId].firstReward)){let e=h.ExcelMgr.instance.GetExcelObject(h.TableName.levelTable)[this.levelId].firstReward;e?(p.default.instance.getPlant(e),d.default.instance.lockPlant=e,d.default.instance.newPlant.includes(e)||d.default.instance.newPlant.push(e)):p.default.instance.setPlantChip(e,u.default.instance().getPlant(e).merge)}this.rewardPanel=this.node.getChildByName("Panel").getChildByName("RewardPanel"),this.constPanel=this.node.getChildByName("Panel").getChildByName("ConstReward"),this.btnPanel=this.node.getChildByName("Panel").getChildByName("BtnPanel"),this.btnPanel.active=!1,this.initPlatform(),p.default.instance.drawGuide||2!=d.default.instance.level?p.default.instance.newUser?(this.btnPanel.getChildByName("GetAll").getChildByName("GuideFinger").active=!0,this.btnPanel.getChildByName("GetAll").getChildByName("Label").x=0,this.btnPanel.getChildByName("GetAll").getChildByName("VideoBtn").active=!1,this.btnPanel.getChildByName("GetOne").active=!1,this.btnPanel.getChildByName("GetAll").x=0,this.initReward()):(this.showTryPlant(),this.initReward()):(this.rewardArray[0].diamond=20,this.rewardArray[1].gold=3200,this.rewardArray[2].diamond=20,this.btnPanel.getChildByName("GetAll").getChildByName("GuideFinger").active=!0,this.btnPanel.getChildByName("GetAll").getChildByName("Label").x=0,this.btnPanel.getChildByName("GetAll").getChildByName("VideoBtn").active=!1,this.btnPanel.getChildByName("GetOne").active=!1,this.btnPanel.getChildByName("GetAll").x=0,p.default.instance.diamond+=20,i.default.instance.eventReport("\u7b2c\u4e8c\u5173\u901a\u5173"),f.default.instance.postEvent("Tutorial",{tutorial_step:14})),3!=d.default.instance.level||p.default.instance.bossGuide||(d.default.instance.bossGuide=!0),f.default.instance.AdsExposure(f.VideoIndex.successVideo)}initPlatform(){switch(o.default.instance.sdkType){case o.SDK_TYPE.Byte:y.MyUtils.probability(s.default.resultInster)&&d.default.instance.level>=3&&o.default.instance.showInsert(),o.default.instance.recorderStop(),d.default.instance.level>3&&d.default.instance.level%2==0&&g.default.instance.openUI("SharePanelUI",40).getComponent(C.default).init(0),this.tryProbability=s.default.tryPanel;break;case o.SDK_TYPE.WeChat:this.tryProbability=l.default.tryPanel,this.scheduleOnce(()=>{g.default.instance.showUI("MoreGameUI",999)},l.default.juZhenDelay)}}showTryPlant(){let e=[];for(let t=0;t<d.default.instance.selectPlantID.length;t++)p.default.instance.plantLock.includes(d.default.instance.selectPlantID[t])||e.push(d.default.instance.selectPlantID[t]);y.MyUtils.removeArrElement(e,20),0!=e.length&&p.default.instance.freePlant<2&&y.MyUtils.probability(this.tryProbability)&&g.default.instance.openUI("TryPanelUI",30).getComponent(b.default).init(e)}start(){this.node.getChildByName("Panel").getComponent(cc.Animation).play(),this.node.getChildByName("Panel").getComponent(cc.Animation).on("stop",()=>{this.node.getChildByName("Panel").getChildByName("GetBtn").active=!0})}onClickGet(){this.playAnimation()}playAnimation(){this.node.getChildByName("Panel").getChildByName("RewardPanel").active=!0,this.node.getChildByName("Panel").getChildByName("GetBtn").active=!1,this.node.getChildByName("Panel").getChildByName("Title").active=!1,this.node.getChildByName("Panel").getChildByName("ConstReward").active=!1,this.rewardPanel.getComponent(cc.Animation).play("SuccessUI"),this.rewardPanel.getComponent(cc.Animation).on("stop",()=>{this.rewardPanel.getComponent(cc.Animation).off("stop"),this.rewardPanel.getComponent(cc.Animation).play(),this.rewardPanel.getComponent(cc.Animation).on("stop",()=>{for(let e=0;e<this.rewardPanel.childrenCount;e++)this.rewardPanel.children[e].getChildByName("Title").active=!0,this.rewardPanel.children[e].getChildByName("Title").getComponent(cc.Animation).play(null,.1*e),this.rewardGet=!1;this.node.getChildByName("Panel").getChildByName("TitleLabel").active=!0})})}initReward(){let e=1;20==d.default.instance.level&&(e=1==d.default.instance.bossLevel?.2:2==d.default.instance.bossLevel?1:5);for(let n=0;n<this.rewardPanel.childrenCount;n++){let t,a=0,i=Math.random(),s=this.rewardConfig[0];for(;i>s;)a++,s+=this.rewardConfig[a];switch(a){case 0:t=100*y.MyUtils.getRandomInt(10+2*this.levelId,21+4*this.levelId)*p.default.instance.chapter,t=Math.ceil(t*e),this.rewardArray[n].gold=t,this.rewardPanel.children[n].getChildByName("AwardPanel").getChildByName("Icon").getComponent(cc.Sprite).spriteFrame=c.default.instance.getBundleRes("BundleTexture","ui/a034",cc.SpriteFrame),this.rewardPanel.children[n].getChildByName("AwardPanel").getChildByName("chip").active=!1,this.rewardPanel.children[n].getChildByName("AwardPanel").getChildByName("desc").getComponent(cc.Label).string="\u91d1\u5e01",this.rewardPanel.children[n].getChildByName("AwardPanel").getChildByName("desc").color=cc.color(0,199,255);break;case 1:t=y.MyUtils.getRandomInt(10+2*this.levelId,21+4*this.levelId)*p.default.instance.chapter,t=Math.ceil(t*e),this.rewardArray[n].diamond=t,this.rewardPanel.children[n].getChildByName("AwardPanel").getChildByName("Icon").getComponent(cc.Sprite).spriteFrame=c.default.instance.getBundleRes("BundleTexture","ui/a033",cc.SpriteFrame),this.rewardPanel.children[n].getChildByName("AwardPanel").getChildByName("chip").active=!1,this.rewardPanel.children[n].getChildByName("AwardPanel").getChildByName("desc").getComponent(cc.Label).string="\u94bb\u77f3",this.rewardPanel.children[n].getChildByName("AwardPanel").getChildByName("desc").color=cc.color(158,52,224);break;case 2:let i,s;if(t=y.MyUtils.getRandomInt(4,9)*p.default.instance.chapter,20==d.default.instance.level&&3==d.default.instance.bossLevel&&(t*=3),this.levelId>=1&&this.levelId<=5)i=Math.random()<=.8?1:3;else if(this.levelId>=6&&this.levelId<=10){let e=Math.random();i=e<=.5?1:e>.5&&e<=.9?3:4}else if(this.levelId>=11&&this.levelId<=15){let e=Math.random();i=e<=.3?1:e>.3&&e<=.6?3:e>.6&&e<=.9?4:5}else{let e=Math.random();i=e<=.2?1:e>.2&&e<=.4?3:e>.4&&e<=.7?4:5}s=y.MyUtils.getArrRandomValue(d.default.instance["rare"+i+"Array"]),this.rewardPanel.children[n].getChildByName("AwardPanel").getChildByName("Icon").getComponent(cc.Sprite).spriteFrame=c.default.instance.getBundleRes("BundleTexture","PlantIcon/p_"+s,cc.SpriteFrame),this.rewardPanel.children[n].getChildByName("AwardPanel").getChildByName("chip").active=!0,this.rewardPanel.children[n].getChildByName("AwardPanel").getChildByName("desc").getComponent(cc.Label).string="\u788e\u7247",this.rewardPanel.children[n].getChildByName("AwardPanel").getChildByName("desc").color=cc.color(255,255,255),this.rewardArray[n].chip[0]=s,this.rewardArray[n].chip[1]=t}this.rewardPanel.children[n].getChildByName("AwardPanel").getChildByName("RewardNum").getComponent(cc.Label).string="X"+t}let t=h.ExcelMgr.instance.GetExcelObject(h.TableName.levelTable)[this.levelId].rewardType,a=h.ExcelMgr.instance.GetExcelObject(h.TableName.levelTable)[this.levelId].rewardCount;switch(t){case"a":p.default.instance.gold+=a,this.constPanel.getChildByName("GDReward").getComponentInChildren(cc.Sprite).spriteFrame=c.default.instance.getBundleRes("BundleTexture","ui/a034",cc.SpriteFrame),this.constPanel.getChildByName("GDReward").getComponentInChildren(cc.Label).string="\u91d1\u5e01  X"+a;break;case"b":p.default.instance.diamond+=a,this.constPanel.getChildByName("GDReward").getComponentInChildren(cc.Label).string="\u94bb\u77f3  X"+a;break;default:this.constPanel.getChildByName("GDReward").active=!1,this.constPanel.getChildByName("ChipReward").active=!0,t=t.slice(1),p.default.instance.setPlantChip(t,a),this.constPanel.getChildByName("ChipReward").getComponentInChildren(cc.Label).string="X"+a,this.constPanel.getChildByName("ChipReward").getChildByName("PlantIcon").getComponent(cc.Sprite).spriteFrame=c.default.instance.getBundleRes("BundleTexture","PlantIcon/p_"+t,cc.SpriteFrame)}}onClickCard(e,t){if(this.rewardGet)return;for(let n=0;n<this.rewardPanel.childrenCount;n++)this.rewardPanel.children[n].getChildByName("Title").active=!1;this.node.getChildByName("Panel").getChildByName("TitleLabel").active=!1,this.rewardGet=!0;let a=e.currentTarget;a.getComponent(cc.Animation).play(),this.selectID=parseInt(t),a.getComponent(cc.Animation).on("stop",()=>{a.getChildByName("Effect").active=!0,this.scheduleOnce(this.showAll,.5)})}showAll(){for(let e=0;e<this.rewardPanel.childrenCount;e++)e!=this.selectID&&(this.rewardPanel.children[e].getComponent(cc.Animation).play(),this.rewardPanel.children[e].getComponent(cc.Animation).on("stop",()=>{this.btnPanel.active=!0}))}onClickGetOne(){p.default.instance.gold+=this.rewardArray[this.selectID].gold,p.default.instance.diamond+=this.rewardArray[this.selectID].diamond,p.default.instance.setPlantChip(this.rewardArray[this.selectID].chip[0],this.rewardArray[this.selectID].chip[1]),g.default.instance.closeUI("SuccessUI"),g.default.instance.openUI("MenuUI")}onClickGetAll(){if(f.default.instance.AdsButtonClick(f.VideoIndex.successVideo),!p.default.instance.drawGuide&&2==d.default.instance.level||p.default.instance.newUser){p.default.instance.drawGuide||2!=d.default.instance.level||(d.default.instance.drawGuide=!0);for(let e=0;e<this.rewardArray.length;e++)p.default.instance.gold+=this.rewardArray[e].gold,p.default.instance.diamond+=this.rewardArray[e].diamond,p.default.instance.setPlantChip(this.rewardArray[e].chip[0],this.rewardArray[e].chip[1]);g.default.instance.closeUI("SuccessUI"),g.default.instance.openUI("MenuUI")}else o.default.instance.showVideo(()=>{for(let e=0;e<this.rewardArray.length;e++)p.default.instance.gold+=this.rewardArray[e].gold,p.default.instance.diamond+=this.rewardArray[e].diamond,p.default.instance.setPlantChip(this.rewardArray[e].chip[0],this.rewardArray[e].chip[1]);g.default.instance.closeUI("SuccessUI"),g.default.instance.openUI("MenuUI"),i.default.instance.eventReport("\u80dc\u5229\u754c\u9762\u591a\u6b21\u9886\u53d6\u89c6\u9891\u6210\u529f"),f.default.instance.AdsPlayRet(f.VideoIndex.successVideo,0)},()=>{i.default.instance.eventReport("\u80dc\u5229\u754c\u9762\u591a\u6b21\u9886\u53d6\u89c6\u9891\u53d6\u6d88"),f.default.instance.AdsPlayRet(f.VideoIndex.successVideo,1)},()=>{i.default.instance.eventReport("\u80dc\u5229\u754c\u9762\u591a\u6b21\u9886\u53d6\u89c6\u9891\u52a0\u8f7d\u5931\u8d25"),f.default.instance.AdsPlayRet(f.VideoIndex.successVideo,-1)})}};M=n([P],M),a.default=M,cc._RF.pop()},{"../ADManager/AD/Byte/ByteConstant":"ByteConstant","../ADManager/AD/WeChat/WeChatConstant":"WeChatConstant","../ADManager/ADManager":"ADManager","../ADlibs/Hts":"Hts","../Manager/AudioManager":"AudioManager","../Manager/BundleManager":"BundleManager","../Manager/DataManager":"DataManager","../Manager/ExcelManager":"ExcelManager","../Manager/PlantMgr":"PlantMgr","../Manager/UIManager":"UIManager","../Manager/UserDataManager":"UserDataManager","../TaSdk/TaSdk":"TaSdk","../utils/KDefine":"KDefine","../utils/MyUtils":"MyUtils","./SharePanelUI":"SharePanelUI","./TryPanelUI":"TryPanelUI"}],TaSdk:[function(e,t,a){"use strict";cc._RF.push(t,"24a1bRtGJxP+bCaIZHk+d44","TaSdk"),Object.defineProperty(a,"__esModule",{value:!0}),a.VideoIndex=void 0;const n=e("../ADManager/AD/WeChat/WeChatConstant"),i=e("../ADManager/ADManager"),s=e("../Manager/UserDataManager");(function(e){e[e.BallTry=1]="BallTry",e[e.freeShop=2]="freeShop",e[e.huangGua=3]="huangGua",e[e.autoPick=4]="autoPick",e[e.bossUnlock=5]="bossUnlock",e[e.goldVideo=6]="goldVideo",e[e.diamond=7]="diamond",e[e.online=8]="online",e[e.daifu=9]="daifu",e[e.tryPlant=10]="tryPlant",e[e.refreshShop=11]="refreshShop",e[e.sign=12]="sign",e[e.successVideo=13]="successVideo",e[e.getPlant=14]="getPlant"})(a.VideoIndex||(a.VideoIndex={}));class l{constructor(){this.ta=null}static get instance(){return null==this._instance&&(this._instance=new l),this._instance}init(){console.log("\u521d\u59cb\u5316\u6570\u6570\u79d1\u6280\u6253\u70b9sdk0===="),i.default.instance.isTest||(console.log("\u521d\u59cb\u5316\u6570\u6570\u79d1\u6280\u6253\u70b9sdk1===="),this.ta=new ThinkingAnalyticsAPI({appId:"aa59e60bdd334a1a9ac24f71150fed95",serverUrl:"https://tga-data-upload.hrgame.com.cn",autoTrack:{appShow:!0,appHide:!0}}),this.ta.init())}setUserData(){if(i.default.instance.isTest)return;let e="",t="";i.default.instance.sdkType==i.SDK_TYPE.WeChat?(e=wx.getLaunchOptionsSync().scene,t=n.default.openID):i.default.instance.sdkType==i.SDK_TYPE.Byte&&(e=tt.getLaunchOptionsSync().scene,t=tt.getLaunchOptionsSync().extra.aid),this.ta.userSetOnce({twtraceid:e,tracetime:Date.now(),channel:i.default.instance.sdkType,gameid:5053,openid:t}),this.ta.userSet({level:s.default.instance.level+20*(s.default.instance.chapter-1),coins:s.default.instance.gold,diamond:s.default.instance.diamond}),this.ta.setSuperProperties({level:s.default.instance.level+20*(s.default.instance.chapter-1),coins:s.default.instance.gold,diamond:s.default.instance.diamond,channel:i.default.instance.sdkType,openid:t,gameid:5053,is_new:s.default.instance.is_new})}postEvent(e,t){i.default.instance.isTest||this.ta.track(e,t)}AdsButtonClick(e){this.postEvent("AdsButtonClick",{adsid:e})}AdsExposure(e){this.postEvent("AdsExposure",{adsid:e})}AdsPlayRet(e,t){this.postEvent("AdsPlayRet",{adsid:e,playret:t})}setSuperProperties(e){i.default.instance.isTest||this.ta.setSuperProperties(e)}userSetOnce(e){i.default.instance.isTest||this.ta.userSetOnce(e)}}a.default=l,l._instance=null,cc._RF.pop()},{"../ADManager/AD/WeChat/WeChatConstant":"WeChatConstant","../ADManager/ADManager":"ADManager","../Manager/UserDataManager":"UserDataManager"}],TaskUI:[function(e,t,a){"use strict";cc._RF.push(t,"499e1FI3hlGO4CDCzwcRIUJ","TaskUI");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const i=e("../Manager/UIManager"),s=e("./MenuUI"),{ccclass:l,property:o}=cc._decorator;let r=class extends cc.Component{onLoad(){}onClickClose(){i.default.instance.closeUI("TaskUI"),i.default.instance.uiList.MenuUI.getComponent(s.default).showNode()}};r=n([l],r),a.default=r,cc._RF.pop()},{"../Manager/UIManager":"UIManager","./MenuUI":"MenuUI"}],TestScene:[function(e,t,a){"use strict";cc._RF.push(t,"1d18d/gFbpIt4Quh6wxIJbJ","TestScene");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const{ccclass:i,property:s}=cc._decorator;let l=class extends cc.Component{onLoad(){cc.dynamicAtlasManager.enabled=!1}};l=n([i],l),a.default=l,cc._RF.pop()},{}],Time:[function(e,t,a){"use strict";cc._RF.push(t,"bac44MM5ApGSZ89aUUZW1BF","Time"),Object.defineProperty(a,"__esModule",{value:!0});const n=e("./ByteAD"),i=e("./ByteConstant");a.default=class extends cc.Component{onLoad(){this.schedule(()=>{n.default.videoTime++,n.default.videoTime>=i.default.noVideoTime&&(n.default.videoTime=i.default.noVideoTime)},1)}},cc._RF.pop()},{"./ByteAD":"ByteAD","./ByteConstant":"ByteConstant"}],ToastUI:[function(e,t,a){"use strict";cc._RF.push(t,"b299dvuBsxMorTkyzegkqnL","ToastUI");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const i=e("../Manager/BundleManager"),s=e("../Manager/UIManager"),{ccclass:l,property:o}=cc._decorator;let r=class extends cc.Component{constructor(){super(...arguments),this.layout=null}showToast(e){let t=cc.instantiate(i.default.instance.getBundleRes("Prefab","Object/Toast",cc.Prefab));this.node.getChildByName("Layout").addChild(t),t.getChildByName("label").getComponent(cc.Label).string=e,t.opacity=0,cc.tween(t).to(.25,{opacity:255}).delay(1.5).to(.25,{opacity:0}).call(()=>t.destroy()).start()}update(e){0==this.layout.childrenCount&&s.default.instance.closeUI("ToastUI")}};n([o(cc.Node)],r.prototype,"layout",void 0),r=n([l],r),a.default=r,cc._RF.pop()},{"../Manager/BundleManager":"BundleManager","../Manager/UIManager":"UIManager"}],TryPanelUI:[function(e,t,a){"use strict";cc._RF.push(t,"10fb9n61IZO/Kkaz6XLU5lH","TryPanelUI");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const i=e("../ADlibs/Hts"),s=e("../ADManager/ADManager"),l=e("../Manager/BundleManager"),o=e("../Manager/PlantMgr"),r=e("../Manager/UIManager"),c=e("../Manager/UserDataManager"),d=e("../TaSdk/TaSdk"),h=e("../utils/MyUtils"),u=e("./RewardUI"),{ccclass:g,property:p}=cc._decorator;let f=class extends cc.Component{constructor(){super(...arguments),this.rewardPanel=null}init(e){this.plantArr=e,this.initPlantPanel(),this.initPlatform(),d.default.instance.AdsExposure(d.VideoIndex.getPlant)}initPlatform(){switch(s.default.instance.sdkType){case s.SDK_TYPE.Byte:this.node.getChildByName("Bg").getChildByName("Close1").active=!1,this.node.getChildByName("Bg").getChildByName("Close2").active=!0}}initPlantPanel(){this.plant1ID=h.MyUtils.getArrRandomValue(this.plantArr);let e=o.default.instance().getPlant(this.plant1ID);this.rewardPanel.children[0].getChildByName("Plant").getComponent(sp.Skeleton).skeletonData=l.default.instance.getBundleRes("Spine","plant/"+e.dragonName+"/"+e.dragonName,sp.SkeletonData),this.rewardPanel.children[0].getChildByName("Plant").getComponent(sp.Skeleton).setAnimation(0,"daiji",!0)}onClickVideoBtn(e,t){d.default.instance.AdsButtonClick(d.VideoIndex.getPlant),d.default.instance.postEvent("AdsButtonClick",{adsid:"\u4fdd\u7559\u690d\u7269"}),s.default.instance.showVideo(()=>{let a=[{rewardType:"b",rare:1,number:1,plantID:1}];"1"==t?(a[0].rare=o.default.instance().getPlant(this.plant1ID).rare,a[0].plantID=this.plant1ID,c.default.instance.getPlant(this.plant1ID),i.default.instance.eventReport("\u4fdd\u7559\u690d\u7269"+o.default.instance().getPlant(this.plant1ID).name+"\u89c6\u9891\u770b\u5b8c")):(a[0].rare=o.default.instance().getPlant(this.plant2ID).rare,c.default.instance.getPlant(this.plant2ID),a[0].plantID=this.plant2ID,i.default.instance.eventReport("\u4fdd\u7559\u690d\u7269"+o.default.instance().getPlant(this.plant2ID).name+"\u89c6\u9891\u770b\u5b8c")),e.currentTarget.getComponent(cc.Button).interactable=!1,c.default.instance.freePlant++,d.default.instance.AdsPlayRet(d.VideoIndex.getPlant,0),r.default.instance.openUI("RewardUI",40).getComponent(u.default).init(a),this.onClickCloseBtn()},()=>{d.default.instance.AdsPlayRet(d.VideoIndex.getPlant,1),i.default.instance.eventReport("\u4fdd\u7559\u690d\u7269\u89c6\u9891\u53d6\u6d88")},()=>{i.default.instance.eventReport("\u4fdd\u7559\u690d\u7269"+o.default.instance().getPlant(this.plant2ID).name+"\u89c6\u9891\u52a0\u8f7d\u5931\u8d25"),d.default.instance.AdsPlayRet(d.VideoIndex.getPlant,-1)})}onClickCloseBtn(){r.default.instance.closeUI("TryPanelUI")}};n([p(cc.Node)],f.prototype,"rewardPanel",void 0),f=n([g],f),a.default=f,cc._RF.pop()},{"../ADManager/ADManager":"ADManager","../ADlibs/Hts":"Hts","../Manager/BundleManager":"BundleManager","../Manager/PlantMgr":"PlantMgr","../Manager/UIManager":"UIManager","../Manager/UserDataManager":"UserDataManager","../TaSdk/TaSdk":"TaSdk","../utils/MyUtils":"MyUtils","./RewardUI":"RewardUI"}],UIManager:[function(e,t,a){"use strict";cc._RF.push(t,"6511czAxl1DbKnHB4SATmHI","UIManager"),Object.defineProperty(a,"__esModule",{value:!0}),a.UIName=void 0;const n=e("../view/ToastUI"),i=e("./BundleManager");(function(e){e.MainUI="MainUI",e.LevelUI="LevelUI",e.PassUI="PassUI",e.TipPanelUI="TipPanelUI",e.TipPanelUI2="TipPanelUI2",e.SettingUI="SettingUI",e.SelectUI="SelectUI",e.ShareUI="ShareUI",e.GuideUI="GuideUI"})(a.UIName||(a.UIName={}));class s{constructor(){this.uiList={},this.uiRoot=null,this.uiRoot=cc.find("Canvas/UI")}static get instance(){return this._instance||(this._instance=new s),this._instance}openUI(e,t,a){if(this.uiList[e])return this.uiList[e];a||(a=this.uiRoot);let n,s=i.default.instance.getBundleRes("Prefab","UIPrefab/"+e,cc.Prefab);return s&&(n=cc.instantiate(s),a.addChild(n),t&&(n.zIndex=t)),this.uiList[e]=n,console.log("Openuiname==",e),n}closeUI(e){console.log("Closeuiname--",e),null!=this.uiList[e]&&(this.uiList[e].destroy(),delete this.uiList[e])}showUI(e,t){this.uiList[e]?this.uiList[e].active=!0:s.instance.openUI(e,t)}hideUI(e){this.uiList[e]&&(this.uiList[e].active=!1)}showToast(e){this.uiList.ToastUI?this.uiList.ToastUI.getComponent(n.default).showToast(e):this.openUI("ToastUI",999).getComponent(n.default).showToast(e)}}a.default=s,s._instance=null,cc._RF.pop()},{"../view/ToastUI":"ToastUI","./BundleManager":"BundleManager"}],UnLockPlantUI:[function(e,t,a){"use strict";cc._RF.push(t,"95d80ZTHHZFl60XEnQ0Xzq8","UnLockPlantUI");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const i=e("../Manager/BundleManager"),s=e("../Manager/DataManager"),l=e("../Manager/PlantMgr"),o=e("../Manager/UIManager"),r=e("../Manager/UserDataManager"),{ccclass:c,property:d}=cc._decorator;let h=class extends cc.Component{constructor(){super(...arguments),this.plantIcon=null,this.plantName=null,this.rare=null,this.rareName=["\u666e\u901a","\u7a00\u6709","\u7a00\u6709","\u53f2\u8bd7","\u4f20\u8bf4"]}onLoad(){let e=l.default.instance().getPlant(s.default.instance.lockPlant),t=l.default.instance().getPlant(s.default.instance.lockPlant).rare;this.plantIcon.skeletonData=i.default.instance.getBundleRes("Spine","plant/"+e.dragonName+"/"+e.dragonName,sp.SkeletonData),this.plantIcon.setAnimation(0,"daiji",!0),this.plantName.string=e.name,this.rare.string=this.rareName[t-1]}onClickClose(){s.default.instance.lockPlant=0,r.default.instance.upGradeGuide||o.default.instance.openUI("GuideUI2",99).emit("init",2),o.default.instance.closeUI("UnLockPlantUI")}};n([d(sp.Skeleton)],h.prototype,"plantIcon",void 0),n([d(cc.Label)],h.prototype,"plantName",void 0),n([d(cc.Label)],h.prototype,"rare",void 0),h=n([c],h),a.default=h,cc._RF.pop()},{"../Manager/BundleManager":"BundleManager","../Manager/DataManager":"DataManager","../Manager/PlantMgr":"PlantMgr","../Manager/UIManager":"UIManager","../Manager/UserDataManager":"UserDataManager"}],UpgradeUI:[function(e,t,a){"use strict";cc._RF.push(t,"71c5bKt7+BF2oAezRGP/ZMK","UpgradeUI");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const i=e("../Manager/BundleManager"),s=e("../Manager/DataManager"),l=e("../Manager/PlantMgr"),o=e("../Manager/UIManager"),r=e("../utils/MyUtils"),c=e("../entity/Card"),d=e("../Manager/UserDataManager"),h=e("../Manager/AudioManager"),u=e("../utils/KDefine"),g=e("./NoCoinUI"),p=e("../ADlibs/Hts"),f=e("../TaSdk/TaSdk"),m=e("../ADManager/ADManager"),y=e("../ADManager/AD/WeChat/WeChatConstant"),C=e("./MenuUI"),{ccclass:b,property:P}=cc._decorator;let v=class extends cc.Component{constructor(){super(...arguments),this.selectPanel=null,this.rarePanel=null,this.plantPanel=null,this.plantInfoPanel=null,this.goldPanel=null,this.chipPanel=null,this.purchasePanel=null,this.chipIcon1=null,this.chipIcon2=null,this.chipIcon3=null,this.selectRare=0,this.selectID=0}onLoad(){f.default.instance.postEvent("System",{system:"\u690d\u7269\u5347\u7ea7"})}start(){this.node.on("onClickBuyBtn",this.onClickBuyBtn,this),this.node.on("onClickCloseBtn",this.onClickCloseBtn,this),this.refreshSelectPanel(null,"0"),!d.default.instance.upGradeGuide||d.default.instance.drawGuide&&!d.default.instance.upGradeGuide2?this.onClickPlant(11):this.onClickPlant(1),this.refreshMoneyPanel(),this.initPlatform()}initPlatform(){switch(m.default.instance.sdkType){case m.SDK_TYPE.WeChat:m.default.instance.showNative(2),m.default.instance.showNative(3),m.default.instance.showNative(1),m.default.instance.hideNative(0)}}refreshMoneyPanel(){this.goldPanel.getChildByName("gold").getComponent(cc.Label).string=d.default.instance.gold,this.goldEnough()?(this.goldPanel.getChildByName("gold").color=cc.color(255,255,255),this.goldPanel.getChildByName("gold").getComponent(cc.LabelOutline).enabled=!0):(this.goldPanel.getChildByName("gold").color=cc.color(255,0,0),this.goldPanel.getChildByName("gold").getComponent(cc.LabelOutline).enabled=!1),this.chipEnough()?(this.chipPanel.getChildByName("chip").color=cc.color(255,255,255),this.chipPanel.getChildByName("chip").getComponent(cc.LabelOutline).enabled=!0):(this.chipPanel.getChildByName("chip").color=cc.color(255,0,0),this.chipPanel.getChildByName("chip").getComponent(cc.LabelOutline).enabled=!1)}chipEnough(e=this.selectID){return d.default.instance.getPlantChip(e)>=l.default.instance().getPlant(e).costChip[d.default.instance.getPlantLevel(e)-1][1]}goldEnough(e=this.selectID){return d.default.instance.gold>=l.default.instance().getPlant(e).costGold[d.default.instance.getPlantLevel(e)-1][1]}onClickBuyBtn(){if(d.default.instance.plantLock.includes(this.selectID))if(this.goldEnough()&&this.chipEnough()){d.default.instance.gold-=l.default.instance().getPlant(this.selectID).costGold[d.default.instance.getPlantLevel(this.selectID)-1][1],d.default.instance.setPlantChip(this.selectID,-l.default.instance().getPlant(this.selectID).costChip[d.default.instance.getPlantLevel(this.selectID)-1][1]);let e=d.default.instance.getPlantLevel(this.selectID)+1;d.default.instance.setPlantLevel(this.selectID,e),this.refreshMoneyPanel(),this.onClickPlant(this.selectID,!0),this.refreshSelectPanel(null,"0"),this.plantPanel.getChildByName("Effect").getComponent(sp.Skeleton).setAnimation(0,"FX",!1),h.default.instance.playEffect(u.AudioName.UpgradeEff),p.default.instance.eventReport("\u690d\u7269\u5347\u7ea7\u6210\u529f")}else this.goldEnough()?(p.default.instance.eventReport("\u788e\u7247\u4e0d\u8db3\u690d\u7269\u5347\u7ea7\u5931\u8d25"),o.default.instance.showToast("\u788e\u7247\u4e0d\u8db3,\u53ef\u524d\u5f80\u5546\u5e97\u6216\u62bd\u5956\u83b7\u53d6\uff01")):(p.default.instance.eventReport("\u91d1\u5e01\u4e0d\u8db3\u690d\u7269\u5347\u7ea7\u5931\u8d25"),o.default.instance.openUI("NoCoinUI",50).getComponent(g.default).init(0));else d.default.instance.getPlantChip(this.selectID)>=l.default.instance().getPlant(this.selectID).merge?(d.default.instance.getPlant(this.selectID),d.default.instance.setPlantChip(this.selectID,-l.default.instance().getPlant(this.selectID).merge),this.plantPanel.getChildByName("Effect").getComponent(sp.Skeleton).setAnimation(0,"FX",!1),this.refreshMoneyPanel(),this.selectPanel.getChildByName(this.selectID+"").getComponent(c.default).init(this.selectID),this.selectPanel.getChildByName(this.selectID+"").getChildByName("Compound").active=!1,this.onClickPlant(this.selectID,!0),h.default.instance.playEffect(u.AudioName.UpgradeEff),this.refreshSelectPanel(null,"0"),p.default.instance.eventReport("\u690d\u7269\u5408\u6210\u6210\u529f")):(o.default.instance.openUI("ChipTipUI",99),p.default.instance.eventReport("\u788e\u7247\u4e0d\u8db3\u690d\u7269\u5408\u6210\u5931\u8d25"))}refreshSelectPanel(e,t){this.selectRare==parseInt(t)?(0!=this.selectRare&&(this.rarePanel.children[this.rarePanel.childrenCount-this.selectRare].width=65),this.selectRare=0):(0!=this.selectRare&&(this.rarePanel.children[this.rarePanel.childrenCount-this.selectRare].width=65),this.selectRare=parseInt(t),this.rarePanel.children[this.rarePanel.childrenCount-this.selectRare].width=80),this.selectPanel.removeAllChildren();let a=s.default.instance.plantArray,n=s.default.instance.newPlant;if(n.length>=1)for(let s=0;s<n.length;s++){let e=cc.instantiate(i.default.instance.getBundleRes("Prefab","card/card_1",cc.Prefab));if(e.getComponent(c.default).init(n[s]),e.getComponent(c.default).rare==this.selectRare||0==this.selectRare){e.parent=this.selectPanel,e.getComponent(c.default).new.active=!0;let t=n[s];e.name=t+"",e.on(cc.Node.EventType.TOUCH_END,()=>{this.onClickPlant(t)})}else e.destroy()}for(let s=0;s<a.length;s++){let e=cc.instantiate(i.default.instance.getBundleRes("Prefab","card/card_1",cc.Prefab));e.getComponent(c.default).init(a[s]),e.getComponent(c.default).rare!=this.selectRare&&0!=this.selectRare||n.includes(a[s])?e.destroy():(e.parent=this.selectPanel,e.name=a[s]+"",e.on(cc.Node.EventType.TOUCH_END,()=>{this.onClickPlant(a[s])}),!d.default.instance.plantLock.includes(a[s])&&d.default.instance.getPlantChip(a[s])>=20&&(e.getChildByName("Compound").active=!0),this.chipEnough(a[s])&&this.goldEnough(a[s])&&d.default.instance.plantLock.includes(a[s])?e.getChildByName("UpgradeIcon").active=!0:e.getChildByName("UpgradeIcon").active=!1)}}onClickPlant(e,t=!1){if(this.selectID==e&&!t)return;s.default.instance.newPlant.includes(e)&&(r.MyUtils.removeArrElement(s.default.instance.newPlant,e),this.selectPanel.getChildByName(e+"").getChildByName("New").active=!1),this.selectPanel.getChildByName(this.selectID+"")&&(this.selectPanel.getChildByName(this.selectID+"").getChildByName("HighLight").active=!1),2==e||12==e?(this.plantInfoPanel.getChildByName("Generate").getChildByName("desc").getComponent(cc.Label).string="\u751f\u4ea7",this.plantInfoPanel.getChildByName("Generate").getChildByName("Icon").getComponent(cc.Sprite).spriteFrame=i.default.instance.getBundleRes("BundleTexture","ui/card_info_cost",cc.SpriteFrame)):21==e||22==e?(this.plantInfoPanel.getChildByName("Generate").getChildByName("desc").getComponent(cc.Label).string="\u9632\u5fa1",this.plantInfoPanel.getChildByName("Generate").getChildByName("Icon").getComponent(cc.Sprite).spriteFrame=i.default.instance.getBundleRes("BundleTexture","ui/card_info_defence",cc.SpriteFrame)):(this.plantInfoPanel.getChildByName("Generate").getChildByName("desc").getComponent(cc.Label).string="\u4f24\u5bb3",this.plantInfoPanel.getChildByName("Generate").getChildByName("Icon").getComponent(cc.Sprite).spriteFrame=i.default.instance.getBundleRes("BundleTexture","ui/card_info_atk",cc.SpriteFrame)),this.selectPanel.getChildByName(e+"")&&(this.selectPanel.getChildByName(e+"").getChildByName("HighLight").active=!0);let a=l.default.instance().getPlant(e);this.plantPanel.getChildByName("PlantName").getComponent(cc.Label).string=a.name,this.plantPanel.getChildByName("Plant").getComponent(sp.Skeleton).skeletonData=i.default.instance.getBundleRes("Spine","plant/"+a.dragonName+"/"+a.dragonName,sp.SkeletonData),this.plantPanel.getChildByName("Plant").getComponent(sp.Skeleton).setAnimation(0,"daiji",!0),this.plantPanel.getChildByName("chip").getChildByName("num").getComponent(cc.Label).string=d.default.instance.getPlantChip(e),this.chipIcon1.spriteFrame=i.default.instance.getBundleRes("BundleTexture","UpgradeUI/r"+a.rare,cc.SpriteFrame),this.chipIcon2.spriteFrame=i.default.instance.getBundleRes("BundleTexture","UpgradeUI/r"+a.rare,cc.SpriteFrame),this.chipIcon3.spriteFrame=i.default.instance.getBundleRes("BundleTexture","UpgradeUI/r"+a.rare,cc.SpriteFrame),10==d.default.instance.getPlantLevel(e)?(this.plantInfoPanel.getChildByName("Level").getChildByName("num2").getComponent(cc.Label).string="???",this.plantInfoPanel.getChildByName("Generate").getChildByName("num2").getComponent(cc.Label).string="???",this.plantInfoPanel.getChildByName("Cost").getChildByName("num2").getComponent(cc.Label).string="???",this.plantInfoPanel.getChildByName("CD").getChildByName("num2").getComponent(cc.Label).string="???",this.purchasePanel.active=!1):(this.plantInfoPanel.getChildByName("Level").getChildByName("num2").getComponent(cc.Label).string=d.default.instance.getPlantLevel(e)+1,this.plantInfoPanel.getChildByName("Generate").getChildByName("num2").getComponent(cc.Label).string=Math.floor(a.damage[d.default.instance.getPlantLevel(e)][1]*a.shootNums*a.simpleDamage)+"",this.plantInfoPanel.getChildByName("Cost").getChildByName("num2").getComponent(cc.Label).string=a.cost[d.default.instance.getPlantLevel(e)][1],this.plantInfoPanel.getChildByName("CD").getChildByName("num2").getComponent(cc.Label).string=a.cd[d.default.instance.getPlantLevel(e)][1],this.purchasePanel.active=!0),this.plantInfoPanel.getChildByName("Level").getChildByName("num1").getComponent(cc.Label).string=d.default.instance.getPlantLevel(e),this.plantInfoPanel.getChildByName("Generate").getChildByName("num1").getComponent(cc.Label).string=Math.floor(a.damage[d.default.instance.getPlantLevel(e)-1][1]*a.shootNums*a.simpleDamage)+"",this.plantInfoPanel.getChildByName("CD").getChildByName("num1").getComponent(cc.Label).string=a.cd[d.default.instance.getPlantLevel(e)-1][1],this.plantInfoPanel.getChildByName("Cost").getChildByName("num1").getComponent(cc.Label).string=a.cost[d.default.instance.getPlantLevel(e)-1][1],d.default.instance.plantLock.includes(e)?(this.purchasePanel.getChildByName("Panel").active=!0,this.purchasePanel.getChildByName("unLockPanel").active=!1,this.purchasePanel.getChildByName("buyBtn").getComponentInChildren(cc.Label).string="\u5347\u7ea7",this.goldPanel.getChildByName("needGold").getComponent(cc.Label).string="/"+a.costGold[d.default.instance.getPlantLevel(e)-1][1],0==a.costChip[d.default.instance.getPlantLevel(e)-1][1]?this.chipPanel.active=!1:(this.chipPanel.active=!0,this.chipPanel.getChildByName("chip").getComponent(cc.Label).string=d.default.instance.getPlantChip(e)+"",this.chipPanel.getChildByName("needChip").getComponent(cc.Label).string="/"+a.costChip[d.default.instance.getPlantLevel(e)-1][1])):(this.purchasePanel.getChildByName("Panel").active=!1,this.purchasePanel.getChildByName("unLockPanel").active=!0,this.purchasePanel.getChildByName("unLockPanel").getComponentInChildren(cc.ProgressBar).progress=d.default.instance.getPlantChip(e)/a.merge,this.purchasePanel.getChildByName("unLockPanel").getChildByName("progress").getComponentInChildren(cc.Label).string=d.default.instance.getPlantChip(e)+"/"+a.merge,this.purchasePanel.getChildByName("buyBtn").getComponentInChildren(cc.Label).string="\u5408\u6210"),this.selectID=e,this.chipEnough()&&this.goldEnough()&&d.default.instance.plantLock.includes(this.selectID)?this.selectPanel.getChildByName(this.selectID+"").getChildByName("UpgradeIcon").active=!0:this.selectPanel.getChildByName(this.selectID+"").getChildByName("UpgradeIcon").active=!1,this.refreshMoneyPanel()}onClickCloseBtn(){o.default.instance.closeUI("UpgradeUI"),o.default.instance.uiList.MenuUI.getComponent(C.default).showNode(),m.default.instance.sdkType==m.SDK_TYPE.WeChat&&(r.MyUtils.probability(y.default.mainInster)&&d.default.instance.levelGuide&&m.default.instance.showInsert(),m.default.instance.hideNative(2),m.default.instance.hideNative(3),m.default.instance.showNative(0),m.default.instance.hideNative(1))}};n([P(cc.Node)],v.prototype,"selectPanel",void 0),n([P(cc.Node)],v.prototype,"rarePanel",void 0),n([P(cc.Node)],v.prototype,"plantPanel",void 0),n([P(cc.Node)],v.prototype,"plantInfoPanel",void 0),n([P(cc.Node)],v.prototype,"goldPanel",void 0),n([P(cc.Node)],v.prototype,"chipPanel",void 0),n([P(cc.Node)],v.prototype,"purchasePanel",void 0),n([P(cc.Sprite)],v.prototype,"chipIcon1",void 0),n([P(cc.Sprite)],v.prototype,"chipIcon2",void 0),n([P(cc.Sprite)],v.prototype,"chipIcon3",void 0),v=n([b],v),a.default=v,cc._RF.pop()},{"../ADManager/AD/WeChat/WeChatConstant":"WeChatConstant","../ADManager/ADManager":"ADManager","../ADlibs/Hts":"Hts","../Manager/AudioManager":"AudioManager","../Manager/BundleManager":"BundleManager","../Manager/DataManager":"DataManager","../Manager/PlantMgr":"PlantMgr","../Manager/UIManager":"UIManager","../Manager/UserDataManager":"UserDataManager","../TaSdk/TaSdk":"TaSdk","../entity/Card":"Card","../utils/KDefine":"KDefine","../utils/MyUtils":"MyUtils","./MenuUI":"MenuUI","./NoCoinUI":"NoCoinUI"}],UserDataManager:[function(e,t,a){"use strict";cc._RF.push(t,"c63322MOSNDErUqjEKih+EI","UserDataManager"),Object.defineProperty(a,"__esModule",{value:!0});const n=e("./ExcelManager"),i=e("../utils/MyUtils"),s=e("./DataManager"),l=e("../view/MoneyPanelUI"),o=e("./UIManager"),r=e("../view/UpgradeUI");class c{constructor(){this.is_new=!0,this._userDataKey="userDataZombies",this.init()}static get instance(){return null==this._instance&&(this._instance=new c),this._instance}init(){this._userData={lastYear:0,lastMonth:0,lastDay:0,scene:0,shopInfo:[],shopHour:-1,bossLevel:[1],plantLevel:[],plantChip:[],plantLock:[1,2,21],gold:0,diamond:0,level:1,chapter:1,signDay:0,shopRefreshTimes:0,freePlant:0,signTimes:!1,newUser:!0,drawGuide:!1,bossGuide:!1,shareReward:!0,goldGain:0,huangGuaGuide:!1,upGradeGuide:!1,upGradeGuide2:!1,levelGuide:!1,onlineInfo:[],onlineNum:0,onlineTime:0}}getPlantChip(e){return null==this._userData.plantChip&&(this._userData.plantChip=[]),null==this._userData.plantChip[e-1]&&(this._userData.plantChip[e-1]=0,this.writeStorage()),this._userData.plantChip[e-1]}setPlantChip(e,t){null==this._userData.plantChip&&(this._userData.plantChip=[]),null==this._userData.plantChip[e-1]&&(this._userData.plantChip[e-1]=0),this._userData.plantChip[e-1]+=t,this.writeStorage()}getPlantLevel(e){return null==this._userData.plantLevel&&(this._userData.plantLevel=[]),null==this._userData.plantLevel[e-1]&&(this._userData.plantLevel[e-1]=1,this.writeStorage()),this._userData.plantLevel[e-1]}setPlantLevel(e,t,a=!1){null==this._userData.plantLevel[e-1]&&(this._userData.plantLevel[e-1]=1),this._userData.plantLevel[e-1]=t,a||this.writeStorage()}get plantLock(){return null==this._userData.plantLock&&(this._userData.plantLock=[1,2,21]),this._userData.plantLock}getPlant(e){this._userData.plantLock.includes(e)?this.setPlantChip(e,20):(this._userData.plantLock.push(e),s.default.instance.newPlant.includes(e)||s.default.instance.newPlant.push(e)),this.writeStorage()}get onlineTime(){return null==this._userData.onlineTime&&(this._userData.onlineTime=0),this._userData.onlineTime}set onlineTime(e){e>300&&(e=300),this._userData.onlineTime=e,this.writeStorage()}get onlineNum(){return null==this._userData.onlineNum&&(this._userData.onlineNum=0),this._userData.onlineNum}set onlineNum(e){this._userData.onlineNum=e,this.writeStorage()}get huangGuaGuide(){return null==this._userData.huangGuaGuide&&(this._userData.huangGuaGuide=!1),this._userData.huangGuaGuide}set huangGuaGuide(e){this._userData.huangGuaGuide=e,this.writeStorage()}get bossLevel(){return null==this._userData.bossLevel&&(this._userData.bossLevel=[1],this.writeStorage()),1==this._userData.bossLevel?(this._userData.bossLevel=[1],this.writeStorage()):2==this._userData.bossLevel?(this._userData.bossLevel=[1,2],this.writeStorage()):3==this._userData.bossLevel&&(this._userData.bossLevel=[1,2,3],this.writeStorage()),this._userData.bossLevel}setbossLevel(e){this._userData.bossLevel.push(e),this.writeStorage()}get shareReward(){return null==this._userData.shareReward&&(this._userData.shareReward=!0),this._userData.shareReward}set shareReward(e){this._userData.shareReward=e,this.writeStorage()}get bossGuide(){return null==this._userData.bossGuide&&(this._userData.bossGuide=!1),this._userData.bossGuide}set bossGuide(e){this._userData.bossGuide=e,this.writeStorage()}get drawGuide(){return null==this._userData.drawGuide&&(this._userData.drawGuide=!1),this._userData.drawGuide}set drawGuide(e){this._userData.drawGuide=e,this.writeStorage()}get shopRefreshTimes(){return null==this._userData.shopRefreshTimes&&(this._userData.shopRefreshTimes=0),this._userData.shopRefreshTimes}set shopRefreshTimes(e){this._userData.shopRefreshTimes=e,this.writeStorage()}get signTimes(){return null==this._userData.signTimes&&(this._userData.signTimes=0),this._userData.signTimes}set signTimes(e){this._userData.signTimes=e,this.writeStorage()}get signDay(){return null==this._userData.signDay&&(this._userData.signDay=0),this._userData.signDay}set signDay(e){this._userData.signDay=e,this._userData.signDay>=7&&(this._userData.signDay=0),this.writeStorage()}get shopHour(){return null==this._userData.shopHour&&(this._userData.shopHour=-1),this._userData.shopHour}set shopHour(e){this._userData.shopHour=e,this.writeStorage()}get shopInfo(){return null==this._userData.shopInfo&&(this._userData.shopInfo=[]),this._userData.shopInfo}set shopInfo(e){this._userData.shopInfo=e,this.writeStorage()}changeshopInfo(e,t){this._userData.shopInfo[e]=t,this.writeStorage()}get onlineInfo(){return null!=this._userData.onlineInfo&&this._userData.onlineInfo!=[]||this.getonlineInfo(),this._userData.onlineInfo}set onlineInfo(e){this._userData.onlineInfo=e,this.writeStorage()}changeOnlineInfo(e,t){this._userData.onlineInfo[e]=t,this.writeStorage()}get levelGuide(){return null==this._userData.levelGuide&&(this._userData.levelGuide=!0),this._userData.levelGuide}set levelGuide(e){this._userData.levelGuide=e,this.writeStorage()}get upGradeGuide2(){return null==this._userData.upGradeGuide2&&(this._userData.upGradeGuide2=!1),this._userData.upGradeGuide2}set upGradeGuide2(e){this._userData.upGradeGuide2=e,this.writeStorage()}get upGradeGuide(){return null==this._userData.upGradeGuide&&(this._userData.upGradeGuide=!0),this._userData.upGradeGuide}set upGradeGuide(e){this._userData.upGradeGuide=e,this.writeStorage()}get newUser(){return null==this._userData.newUser&&(this._userData.newUser=!0),this._userData.newUser}set newUser(e){this._userData.newUser=e,this.writeStorage()}get level(){return null==this._userData.level&&(this._userData.level=1),this._userData.level}set level(e){this._userData.level=e,this._userData.level>20&&(this._userData.level=1,this._userData.chapter++),this.writeStorage()}get chapter(){return null==this._userData.chapter&&(this._userData.chapter=1),this._userData.chapter}set chapter(e){this._userData.chapter=e,this.writeStorage()}get gold(){return null==this._userData.gold&&(this._userData.gold=0),this._userData.gold}set gold(e){this._userData.gold=e,l.default.instance&&l.default.instance.refreshMoneyPanel(),o.default.instance.uiList.UpgradeUI&&o.default.instance.uiList.UpgradeUI.getComponent(r.default).refreshMoneyPanel(),this.writeStorage()}get freePlant(){return null==this._userData.freePlant&&(this._userData.freePlant=0),this._userData.freePlant}set freePlant(e){this._userData.freePlant=e,this.writeStorage()}get diamond(){return null==this._userData.diamond&&(this._userData.diamond=0),this._userData.diamond}set diamond(e){this._userData.diamond=e,l.default.instance&&l.default.instance.refreshMoneyPanel(),this.writeStorage()}get scene(){return null==this._userData.scene&&(this._userData.scene=0),this._userData.scene}set scene(e){this._userData.scene=e,this.writeStorage()}get lastYear(){return null==this._userData.lastYear&&(this._userData.lastYear=0),this._userData.lastYear}set lastYear(e){this._userData.lastYear=e,this.writeStorage()}get lastMonth(){return null==this._userData.lastMonth&&(this._userData.lastMonth=0),this._userData.lastMonth}set lastMonth(e){this._userData.lastMonth=e,this.writeStorage()}get lastDay(){return null==this._userData.lastDay&&(this._userData.lastDay=0),this._userData.lastDay}set lastDay(e){this._userData.lastDay=e,this.writeStorage()}isNewDay(){let e=new Date,t=this.lastYear,a=this.lastMonth,n=this.lastDay;e.getDate()==n&&e.getMonth()==a&&e.getFullYear()==t?(console.log("\u662f\u540c\u4e00\u5929\u4e0d\u5904\u7406"),this.getHour()!=this.shopHour&&(this.getShopInfo(),console.log("\u5237\u65b0\u5546\u5e97==="))):(console.log("\u65b0\u7684\u4e00\u5929"),this.signTimes=!1,this.freePlant=0,this.shareReward=!0,this.onlineNum=0,this.onlineTime=0,c.instance.shopRefreshTimes=0,this.lastYear=e.getFullYear(),this.lastMonth=e.getMonth(),this.lastDay=e.getDate(),this.getShopInfo(),this.getonlineInfo())}getShopInfo(){let e=[],t=n.ExcelMgr.instance.GetExcelObject(n.TableName.shopTable),a=0,l=[];for(let n=1;n<=Object.keys(t).length;n++)a+=t[n].weight,l.push(a);for(let n=0;n<8;n++){let a={id:0,type:"",costType:"",rare:0,discount:1,number:0,cost:0,bought:!1},n=i.MyUtils.getRandomInt(1,101),o=0;for(;n>l[o];)o++;o++,a.type=t[o].goodsType,a.rare=t[o].rare,"a"==a.type?(a.number=i.MyUtils.getRandomInt(t[o].goodsNumber[0],t[o].goodsNumber[1]+1),Math.random()>.6?(a.costType="g",a.cost=a.number*s.default.instance["rarePrice"+a.rare][0]):(a.costType="d",a.cost=a.number*s.default.instance["rarePrice"+a.rare][1])):(a.number=1,Math.random()>.6?(a.costType="g",a.cost=20*s.default.instance["rarePrice"+a.rare][0]):(a.costType="d",a.cost=20*s.default.instance["rarePrice"+a.rare][1])),Math.random()<.05?a.discount=.5:Math.random()>=.05&&Math.random()<.25?a.discount=.8:Math.random()>=.25&&Math.random()<.35?a.discount=0:a.discount=1,a.id=i.MyUtils.getArrRandomValue(s.default.instance["rare"+a.rare+"Array"]),e.push(a)}this.shopInfo=e,this.shopHour=this.getHour()}getonlineInfo(){let e=[];for(let t=0;t<3;t++){let a={id:0,rare:1,get:!1},n=Math.random();0==t?n>.8?(a.id=i.MyUtils.getArrRandomValue(s.default.instance.rare1Array),a.rare=1):(a.id=i.MyUtils.getArrRandomValue(s.default.instance.rare3Array),a.rare=3):1==t?n>.8?(a.id=i.MyUtils.getArrRandomValue(s.default.instance.rare3Array),a.rare=3):(a.id=i.MyUtils.getArrRandomValue(s.default.instance.rare4Array),a.rare=4):n>.8?(a.id=i.MyUtils.getArrRandomValue(s.default.instance.rare4Array),a.rare=4):(a.id=i.MyUtils.getArrRandomValue(s.default.instance.rare5Array),a.rare=5),e.push(a)}this.onlineInfo=e}getHour(){let e=(new Date).getHours();return e>=0&&e<8?0:e>=8&&e<16?8:16}writeStorage(){this._userData?cc.sys.localStorage.setItem(this._userDataKey,JSON.stringify(this._userData)):console.log("\u6ca1\u6709\u521d\u59cb\u5316\u6570\u636e\u4e0d\u5b58!")}}a.default=c,c._instance=null,cc._RF.pop()},{"../utils/MyUtils":"MyUtils","../view/MoneyPanelUI":"MoneyPanelUI","../view/UpgradeUI":"UpgradeUI","./DataManager":"DataManager","./ExcelManager":"ExcelManager","./UIManager":"UIManager"}],VIVOAD:[function(e,t,a){"use strict";cc._RF.push(t,"d3192PFTJ1DYLSmXB+N4QxD","VIVOAD");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const i=e("../Interface/ADInterface"),s=e("./VIVOConstant"),{ccclass:l,property:o}=cc._decorator;let r=class extends i.default{constructor(){super(...arguments),this.nativeTime=0,this.isShare=!1}initAd(){this.creatBanner(),this.createVideo()}creatNative(e){let t=qg.getSystemInfoSync().windowWidth,a=qg.getSystemInfoSync().windowHeight;switch(console.log("type===1",e),e){case 0:this.customAd1=qg.createCustomAd({adUnitId:s.default.POSID_NativeAD[0],style:{left:0,top:a/2-720*t/1280+100}}),this.customAd1.onError(e=>{console.log("vivo\u539f\u751f err:",JSON.stringify(e))})}}showNative(e){if((new Date).getTime()-this.nativeTime<6e4)console.log("\u95f4\u9694\u65f6\u95f4\u4e0d\u8db3");else switch(e||(e=0),this.hideNative(),this.creatNative(e),console.log("shownative==="),e){case 0:this.customAd1.show().then(()=>{console.log("\u539f\u751f\u5e7f\u544a\u52a0\u8f7d\u6210\u529f"),this.nativeTime=(new Date).getTime()}).catch(e=>{console.log("\u539f\u751f\u5e7f\u544a\u5c55\u793a\u5931\u8d25222:"+JSON.stringify(e))})}}hideNative(){this.customAd1&&this.customAd1.destroy(),this.customAd2&&this.customAd2.destroy()}creatInsert(){this.insertAd=qg.createInterstitialAd({adUnitId:s.default.POSID_InsertAD})}createVideo(){this.rewardVideoAd=qg.createRewardedVideoAd({adUnitId:s.default.POSID_VedioAD})}showToast(e){qg.showToast({title:e})}showInsert(){this.creatInsert();let e=this;this.insertAd.load().then(()=>{e.insertAd.show(),e.log("\u63d2\u5c4f\u5e7f\u544a\u52a0\u8f7d\u5b8c\u6210\uff0c\u51c6\u5907\u5c55\u793a")}).catch(t=>{e.log("\u63d2\u5c4f\u5e7f\u544a\u5f02\u5e38:"+JSON.stringify(t)),e.insertAd&&e.insertAd.destroy()}),this.insertAd.onError(function(t){e.log("\u63d2\u5c4f\u5e7f\u544a\u52a0\u8f7d\u51fa\u9519\uff1a "+JSON.stringify(t)),e.insertAd&&e.insertAd.destroy()}),this.insertAd.onClose(function(t){e.log("\u63d2\u5c4f\u5e7f\u544a\u5173\u95ed:"+t),e.insertAd&&e.insertAd.destroy()})}showVideo(e){null!=this.rewardVideoAd&&null!=this.rewardVideoAd?(this.insertIntervalTime=(new Date).getTime(),cc.game.pause(),this.rewardVideoAd.offClose(),this.rewardVideoAd.offError(),this.rewardVideoAd.offLoad(),this.rewardVideoAd.onLoad(()=>{this.rewardVideoAd.show().then(()=>{console.log("\u5e7f\u544a\u663e\u793a\u6210\u529f")}).catch(e=>{cc.game.resume(),console.log("\u5e7f\u544a\u7ec4\u4ef6\u51fa\u73b0\u95ee\u9898",e)}),console.log("\u89c6\u9891\u52a0\u8f7d\u6210\u529f")}),this.rewardVideoAd.onError(()=>{cc.game.resume()}),this.rewardVideoAd.onClose(t=>{t&&t.isEnded||void 0===t?(e&&e(),this.showToast("\u5956\u52b1\u9886\u53d6\u6210\u529f"),cc.game.resume()):(this.showToast("\u64ad\u653e\u4e2d\u9014\u9000\u51fa"),cc.game.resume())}),this.rewardVideoAd.load()):this.createVideo()}creatBanner(){qg.getSystemInfoSync().screenWidth;let e=qg.getSystemInfoSync().screenHeight;console.log("hei==111221",e),this.bannerAd=qg.createBannerAd({adUnitId:s.default.POSID_BannerAD,style:{},adIntervals:30}),this.bannerAd.onError(e=>{console.log("initBanner err:"+e)})}requestSubscribeSystemMessage(e){}onAddToFavorites(){}showBanner(){console.log("banner===="),this.bannerAd||this.creatBanner(),this.bannerAd.show().then(()=>{console.log("banner\u52a0\u8f7d\u6210\u529f")}).catch(e=>{console.log("showBanner err:"+JSON.stringify(e))})}hideBanner(){null!=this.bannerAd&&this.bannerAd.hide()}recorderStart(){}recorderStop(){}share(e){}canShare(){return!((new Date).getTime()-this.shareTime<3e3||(this.shareTime=(new Date).getTime(),0))}addShortcut(){}exitGame(){qg.exitApplication()}log(e){console.log("WeChatAD:"+e)}};r=n([l],r),a.default=r,cc._RF.pop()},{"../Interface/ADInterface":"ADInterface","./VIVOConstant":"VIVOConstant"}],VIVOConstant:[function(e,t,a){"use strict";cc._RF.push(t,"25ef1WpHqFCkrJDGhH0/BKg","VIVOConstant"),Object.defineProperty(a,"__esModule",{value:!0});class n{}a.default=n,n.POSID_NativeAD=["8fcd87f9ee5b47b7833d38f6e49216a6"],n.POSID_BannerAD="68b59faf4c824ead821de4be9ab6e3ef",n.POSID_InsertAD="9ff8f6d30f4a4dde84051a160f8125cd",n.POSID_VedioAD="ea5f17cd24fc480caada87d45eb2a240",n.appId="105554091",n.Balltimes=0,cc._RF.pop()},{}],VideoControl:[function(e,t,a){"use strict";cc._RF.push(t,"2ea8bTiIf9D6aZEThZ9EKnt","VideoControl");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const i=e("../Manager/BundleManager"),s=e("./AD/WeChat/WeChatConstant"),l=e("./ADManager"),{ccclass:o,property:r}=cc._decorator;let c=class extends cc.Component{onLoad(){switch(l.default.instance.sdkType){case l.SDK_TYPE.WeChat:this.node.opacity=0,this.node.getComponent(cc.Sprite).spriteFrame=i.default.instance.getBundleRes("BundleTexture","ui/Video2",cc.SpriteFrame),this.scheduleOnce(()=>{this.node.opacity=160},s.default.btnDelay)}}};c=n([o],c),a.default=c,cc._RF.pop()},{"../Manager/BundleManager":"BundleManager","./AD/WeChat/WeChatConstant":"WeChatConstant","./ADManager":"ADManager"}],WeChatAD:[function(e,t,a){"use strict";cc._RF.push(t,"b5660yuK2VG74S9NhbaUeB+","WeChatAD");var n,i=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const s=e("../../../Manager/AudioManager"),l=e("../../../TaSdk/TaSdk"),o=e("../Interface/ADInterface"),r=e("./WeChatConstant"),{ccclass:c,property:d}=cc._decorator;let h=n=class extends o.default{constructor(){super(...arguments),this.bannerAd=[null],this.bannerAd2=[null,null,null],this.windowWidth=wx.getSystemInfoSync().windowWidth,this.windowHeight=wx.getSystemInfoSync().windowHeight,this.nativeStyle=[{left:this.windowWidth-75,top:this.windowHeight/5,fixed:!1},{left:200,top:0,fixed:!1,width:50},{left:70,top:this.windowHeight/5,fixed:!1,windth:70},{left:this.windowWidth-100,top:this.windowHeight/5,fixed:!1,windth:70},{left:this.windowWidth/3,top:this.windowHeight/7,fixed:!1,width:this.windowWidth/3}],this.js_code="",this.bannerIndex=0,this.isShowBanner=!1,this.bannerHeight=200,this.bannerWidth=800,this.isShare=!1}initAd(){wx.onError(e=>{console.log("err===",e)}),console.log("init===12345"),this.createBanner(),this.WxShowAndHide(),this.login(),wx.getSetting({withSubscriptions:!0,success(e){"accept"==e.subscriptionsSetting.SYS_MSG_TYPE_INTERACTIVE&&(n.isSubscribe=!0)}}),this.createVideo(),this.createNative(4),this.createNative(3),this.createNative(2),this.createNative(1),this.createNative(0)}login(){let e=this;wx.login({success(t){t.code?(console.log("login code:"+t.code+"    "+JSON.stringify(t)),e.js_code=t.code,e.getOpenID()):console.log("\u767b\u5f55\u5931\u8d25\uff01"+t.errMsg)}})}getOpenID(){let e={appId:r.default.appId,code:this.js_code};console.log("login====1");let t=new XMLHttpRequest;t.open("POST","https://ga.gamejym.com/fcm/pay_wx/getOpenId",!0),t.setRequestHeader("Content-Type","application/json; charset=utf-8");let a=JSON.stringify(e);t.send(a),t.onload=function(){if(4===t.readyState&&t.status>=200&&t.status<300){let e=JSON.parse(t.responseText);console.log("respText==111",e),r.default.openID=e.openid,console.log("openid===",r.default.openID)}else console.error("\u8bf7\u6c42api\u5931\u8d25!"+t.status)}}createNativeBanner(){let e=wx.getSystemInfoSync().windowWidth,t=wx.getSystemInfoSync().windowHeight;for(let a=0;a<this.bannerAd2.length;a++)this.bannerAd2[a]=wx.createBannerAd({adUnitId:"adunit-c07f909c914c84bc",adIntervals:30,style:{left:0,top:t,width:e}}),this.bannerAd2[a].onError(e=>{console.log("errMsg===banner"+e.errMsg),console.log("errCode===banner"+e.errCode),this.bannerAd2[a]=null}),this.bannerAd2[a].onResize(e=>{this.bannerHeight=e.height,this.bannerAd2[a].style.top=e.height*(a+1)})}showNativeBanner(){for(let e=0;e<this.bannerAd2.length;e++)null==this.bannerAd2[e]&&(this.bannerAd2[e]=wx.createBannerAd({adUnitId:"adunit-c07f909c914c84bc",adIntervals:30,style:{left:0,top:this.bannerHeight*(e+1),width:wx.getSystemInfoSync().windowWidth}})),this.bannerAd2[e]&&this.bannerAd2[e].show().then().catch(()=>{this.bannerAd2[e]=null})}hideNativeBanner(){for(let e=0;e<this.bannerAd2.length;e++)this.bannerAd2[e]&&this.bannerAd2[e].hide()}cacheBanner(e){e>this.bannerAd.length||(this.bannerAd[e]&&this.bannerAd[e].show().then(()=>{console.log("success1",e),console.log("top",this.bannerAd[e].style.top)}).catch(()=>{console.log("fail1",e)}),setTimeout(()=>{this.cacheBanner(e+1)},1e3))}createNative(e){this["customAd"+e]=wx.createCustomAd({adUnitId:r.default.POSID_NativeAD[e],adIntervals:30,style:this.nativeStyle[e]}),this["customAd"+e].onError(t=>{this["customAd"+e]=null,console.log("wx\u539f\u751f\u521b\u5efa\u5931\u8d25 err:"+t)})}showNative(e){if(this.hideNative(e),(r.default.showJuzhen||4!=e)&&(r.default.showIcon||3!=e&&2!=e)){if(null==this["customAd"+e])return this.createNative(e),void console.log("createType==",e);console.log("type===",e),this["customAd"+e].show().then(()=>{console.log("\u539f\u751f\u5e7f\u544a\u52a0\u8f7d\u6210\u529f0")}).catch(t=>{this["customAd"+e]=null,console.log("\u539f\u751f\u5e7f\u544a\u5c55\u793a\u5931\u8d25222:"+JSON.stringify(t))})}}hideNative(e){if(console.log("type==",e),null==e)for(let t=0;t<this.nativeStyle.length;t++)this["customAd"+t]&&this["customAd"+t].hide();else this["customAd"+e]&&this["customAd"+e].hide()}creatInsert(){this.insertAd=wx.createInterstitialAd({adUnitId:r.default.POSID_InsertAD})}createVideo(){console.log("vedeo===="),this.rewardVideoAd=wx.createRewardedVideoAd({adUnitId:"adunit-e6759f9e9e4e1508"})}showToast(e){wx.showToast({title:e})}showInsert(){this.creatInsert();let e=this;this.insertAd.load().then(()=>{e.insertAd.show(),e.log("\u63d2\u5c4f\u5e7f\u544a\u52a0\u8f7d\u5b8c\u6210\uff0c\u51c6\u5907\u5c55\u793a")}).catch(t=>{e.log("\u63d2\u5c4f\u5e7f\u544a\u5f02\u5e38:"+JSON.stringify(t)),e.insertAd&&e.insertAd.destroy()}),this.insertAd.onError(function(t){e.log("\u63d2\u5c4f\u5e7f\u544a\u52a0\u8f7d\u51fa\u9519\uff1a "+JSON.stringify(t)),e.insertAd&&e.insertAd.destroy()}),this.insertAd.onClose(function(t){e.log("\u63d2\u5c4f\u5e7f\u544a\u5173\u95ed:"+t),e.insertAd&&e.insertAd.destroy()})}showVideo(e,t,a){null!=this.rewardVideoAd&&null!=this.rewardVideoAd?(this.insertIntervalTime=(new Date).getTime(),cc.game.pause(),this.rewardVideoAd.show().then(()=>{console.log("\u5e7f\u544a\u663e\u793a\u6210\u529f")}).catch(e=>{cc.game.resume(),console.log("\u5e7f\u544a\u7ec4\u4ef6\u51fa\u73b0\u95ee\u9898",e),this.rewardVideoAd.load().then(()=>(console.log("\u624b\u52a8\u52a0\u8f7d\u6210\u529f"),this.rewardVideoAd.show())).catch(()=>{a&&a(),this.showToast("\u6682\u65e0\u5e7f\u544a")})}),this.rewardVideoAd.offClose(),this.rewardVideoAd.offError(),this.rewardVideoAd.onError(e=>{console.log("\u89c6\u9891\u5e7f\u544a\u51fa\u9519err===",e),a&&a(),this.rewardVideoAd=null,this.createVideo(),cc.game.resume()}),this.rewardVideoAd.onClose(a=>{a&&a.isEnded||void 0===a?(e&&e(),this.showToast("\u5956\u52b1\u9886\u53d6\u6210\u529f"),cc.game.resume()):(this.showToast("\u64ad\u653e\u4e2d\u9014\u9000\u51fa"),t&&t(),cc.game.resume())}),this.rewardVideoAd.load()):this.createVideo()}requestSubscribeSystemMessage(e){wx.requestSubscribeSystemMessage({msgTypeList:["SYS_MSG_TYPE_INTERACTIVE","SYS_MSG_TYPE_RANK"],success(t){e.success()},fail(e){console.log("errr====",e.errMsg,"code====",e.errCode)}})}onAddToFavorites(){console.log("\u6536\u85cf==="),wx.onAddToFavorites(()=>({title:"\u6211\u90fd\u5f02\u4e16\u754c\u65e5\u8bb0",imageUrl:""}))}showBanner(){console.log("index==1",this.bannerIndex);let e=this.bannerIndex;this.bannerIndex++,this.bannerIndex=this.bannerIndex%this.bannerAd.length,null!=this.bannerAd[e]&&null!=this.bannerAd[e]?(this.bannerAd[e].style.top=wx.getSystemInfoSync().windowHeight-this.bannerHeight,this.bannerAd[e].style.left=(wx.getSystemInfoSync().windowWidth-this.bannerWidth)/2,this.bannerAd[e].show().then(()=>{l.default.instance.postEvent("bannerExposure",{adsid:r.default.POSID_BannerAD})}).catch(e=>{console.log("showBanner err:"+e)})):this.createBannerSingle(e)}createBannerSingle(e){let t=wx.getSystemInfoSync().windowWidth,a=wx.getSystemInfoSync().windowHeight;this.bannerAd[e]=wx.createBannerAd({adUnitId:r.default.POSID_BannerAD[e%3],adIntervals:30,style:{left:0,top:a-1,width:t,height:200}}),this.bannerAd[e].onError(t=>{this.bannerAd[e]=null,console.log("initBanner err:"+t)})}createBanner(){let e=wx.getSystemInfoSync().windowWidth,t=wx.getSystemInfoSync().windowHeight;for(let a=0;a<this.bannerAd.length;a++)this.bannerAd[a]=wx.createBannerAd({adUnitId:r.default.POSID_BannerAD[a],adIntervals:30,style:{left:e-1,top:t-1,width:e/3}}),this.bannerAd[a].onError(e=>{console.log("errMsg===banner"+e.errMsg),console.log("errCode===banner"+e.errCode),this.bannerAd[a]=null}),this.bannerAd[a].onResize(e=>{this.bannerHeight=e.height,this.bannerWidth=e.width});setTimeout(()=>{this.cacheBanner(0)},8e3)}hideBanner(){console.log("hidebanner");for(let e=0;e<this.bannerAd.length;e++)this.bannerAd[e]&&this.bannerAd[e].hide()}recorderStart(){}recorderStop(){}share(e,t){this.isShare=!0,this.shareCallBack=e,this.shareFailBack=t,wx.shareAppMessage({title:r.default.shareText,imageUrl:r.default.shareImageUrl[0],imameUrlId:r.default.shareImageUrlId[0]})}WxShowAndHide(){wx.onShow(()=>{console.log("in"),cc.game.resume(),s.default.instance.resumeBgm(),this.isShare&&(this.canShare()?(this.shareCallBack&&this.shareCallBack(),this.showToast("\u5206\u4eab\u6210\u529f!")):(this.showToast("\u5206\u4eab\u5931\u8d25!"),this.shareFailBack&&this.shareFailBack())),this.isShare=!1}),wx.onHide(()=>{console.log("exit"),cc.game.pause(),this.isShare&&(this.shareTime=(new Date).getTime())})}canShare(){return!((new Date).getTime()-this.shareTime<3e3||(this.shareTime=(new Date).getTime(),0))}addShortcut(){}exitGame(){wx.exitMiniProgram()}log(e){console.log("WeChatAD:"+e)}};h.isSubscribe=!1,h=n=i([c],h),a.default=h,cc._RF.pop()},{"../../../Manager/AudioManager":"AudioManager","../../../TaSdk/TaSdk":"TaSdk","../Interface/ADInterface":"ADInterface","./WeChatConstant":"WeChatConstant"}],WeChatConstant:[function(e,t,a){"use strict";cc._RF.push(t,"d14c13p67NLmYkb6DtJm2E0","WeChatConstant"),Object.defineProperty(a,"__esModule",{value:!0});class n{}a.default=n,n.POSID_NativeAD=["adunit-3f602da5d2e43cb1","adunit-36d1d4631248e168","adunit-3c95d54639a07503","adunit-cd9a82b59710a11d","adunit-26d16b3591cd5d19"],n.POSID_BannerAD=["adunit-89b75643d3dfe6b3"],n.POSID_InsertAD="adunit-7255cfe3e290d68a",n.POSID_VedioAD="adunit-b6ecbee0564eabed",n.appId="wx987d4570f328b6d4",n.shareImageUrlId=["EkRGAQUdQFKyKDuaQxfrMA==","n/6oX37pS0CgkXadzGbXNQ==","UeJf7wHtQ0W949erfY5pFg=="],n.shareImageUrl=["share.jpg","https://mmocgame.qpic.cn/wechatgame/sTze5UcxyM7IhWqCmUibaj6gfwibZCmT4UJ0l9ZKUrh8DsAbqqRBYVGKBnXM3N4OXX/0","https://mmocgame.qpic.cn/wechatgame/sTze5UcxyM7xHbZx0dlWP6gHgPeF4WPhYvgqQREucm14m1qDwIrianVK26CX72yXy/0"],n.shareText="\u5a18\u5316\u690d\u7269\uff0c\u706b\u70ed\u51fa\u51fb",n.openID="",n.btnDelay=0,n.tryPanel=0,n.mainInster=0,n.noOperation=0,n.firstJuzhen=!1,n.juZhenDelay=0,n.showIcon=!1,n.showJuzhen=!1,cc._RF.pop()},{}],WeChatTime:[function(e,t,a){"use strict";cc._RF.push(t,"8661d37xxxPVZ4FXnnsDmuM","WeChatTime");var n,i=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const s=e("../../../Manager/UIManager"),l=e("./WeChatConstant"),{ccclass:o,property:r}=cc._decorator;let c=n=class extends cc.Component{constructor(){super(...arguments),this._eventManager=cc.internal.eventManager}onLoad(){cc.systemEvent.on(cc.Node.EventType.TOUCH_START,()=>{console.log("===")},this),this.schedule(()=>{n.videoTime++,n.videoTime>=l.default.noOperation&&(s.default.instance.uiList.MoreGameUI||(n.videoTime=0,s.default.instance.openUI("MoreGameUI",999)))},1)}start(){const e=cc.EventListener;this._touchListener=e.create({event:e.TOUCH_ONE_BY_ONE,swallowTouches:!1,owner:this.node,mask:null,onTouchBegan:this.onTouchStart,onTouchMoved:this.onTouchMoved,onTouchEnded:this.onTouchEnded,onTouchCancelled:this.onTouchCancelled}),this._eventManager.addListener(this._touchListener,this.node)}onTouchStart(e,t){return n.videoTime=0,!0}onTouchMoved(e,t){}onTouchEnded(e,t){}onTouchCancelled(e,t){}onDestroy(){this._eventManager.removeListener(this._touchListener,this.node)}};c.videoTime=0,c=n=i([o],c),a.default=c,cc._RF.pop()},{"../../../Manager/UIManager":"UIManager","./WeChatConstant":"WeChatConstant"}],WechatImgControl:[function(e,t,a){"use strict";cc._RF.push(t,"4b81erv54hCQKD2rVWqZoRb","WechatImgControl");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const i=e("../../ADManager"),{ccclass:s,property:l}=cc._decorator;let o=class extends cc.Component{constructor(){super(...arguments),this.img=null}onLoad(){i.default.instance.sdkType==i.SDK_TYPE.WeChat&&(this.node.getComponent(cc.Sprite).spriteFrame=this.img)}};n([l(cc.SpriteFrame)],o.prototype,"img",void 0),o=n([s],o),a.default=o,cc._RF.pop()},{"../../ADManager":"ADManager"}],XiaoMiAD:[function(e,t,a){"use strict";cc._RF.push(t,"22e8diATFVFD5xL7McFuueg","XiaoMiAD");var n,i=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0}),a.XiaoMiHutui=void 0;const s=e("../../ADManager"),l=e("../Interface/ADInterface"),o=e("./XiaoMiConstant"),{ccclass:r,property:c}=cc._decorator;var d;(function(e){e[e.JiuGongGe=0]="JiuGongGe",e[e.HengFu=1]="HengFu",e[e.ChouTi=2]="ChouTi",e[e.XuanFuQiu=3]="XuanFuQiu"})(d=a.XiaoMiHutui||(a.XiaoMiHutui={}));let h=n=class extends l.default{constructor(){super(...arguments),this.videoCallBack=null,this.isShare=!1}initAd(){this.creatBanner(),this.createVideo()}static showHuTuiAd(e){s.default.instance.isTest||qg.displayAd({type:this.HutuiType[e],upid:o.default.POSID_HuTuiAD[e],success:e=>{console.log(e)},fail:t=>{e==d.JiuGongGe&&qg.showToast({title:"\u6682\u65e0\u5e7f\u544a"}),console.log(t)}})}static closeHuTuiAd(e){if(!s.default.instance.isTest)try{if(!qg.closeAd)return;qg.closeAd({type:this.HutuiType[e],success:e=>{console.log(e)},fail:e=>{console.log(e)}})}catch(t){}}static canShowInsertXiaoMi(){return(new Date).getTime()-this.insertIntervalTime<3e4?(console.log("\u63d2\u5c4f\u663e\u793a\u95f4\u9694\u65f6\u95f4\u4e0d\u8db3"),!1):(console.log("\u53ef\u4ee5\u663e\u793a\u63d2\u5c4f"),this.insertIntervalTime=(new Date).getTime(),!0)}showNative(e){}hideNative(){}creatInsert(){this.insertAd=qg.createInterstitialAd({adUnitId:o.default.POSID_InsertAD})}createVideo(){this.rewardVideoAd=qg.createRewardedVideoAd({adUnitId:o.default.POSID_VedioAD}),this.rewardVideoAd.onError(()=>{cc.audioEngine.resumeMusic(),cc.director.resume()}),this.rewardVideoAd.onClose(e=>{e&&e.isEnded||void 0===e?(cc.director.resume(),this.videoCallBack&&this.videoCallBack(),this.showToast("\u5956\u52b1\u9886\u53d6\u6210\u529f"),cc.audioEngine.resumeMusic()):(this.showToast("\u64ad\u653e\u4e2d\u9014\u9000\u51fa"),cc.audioEngine.resumeMusic(),cc.director.resume())}),this.rewardVideoAd.load()}showToast(e){qg.showToast({title:e})}showInsert(){if(!n.canShowInsertXiaoMi())return;this.creatInsert();let e=this;this.insertAd.onLoad(()=>{console.log("\u63d2\u5c4f\u5e7f\u544a\u52a0\u8f7d\u6210\u529f"),this.insertAd.show()}),this.insertAd.onError(function(){if(e.insertAd)try{e.insertAd.destroy()}catch(t){}}),this.insertAd.onClose(function(t){if(e.log("\u63d2\u5c4f\u5e7f\u544a\u5173\u95ed:"+t),e.insertAd)try{e.insertAd.destroy()}catch(a){}})}showVideo(e){null!=this.rewardVideoAd&&null!=this.rewardVideoAd?(cc.audioEngine.pauseMusic(),cc.director.pause(),this.videoCallBack=e,this.rewardVideoAd.show().catch(e=>{cc.audioEngine.resumeMusic(),cc.director.resume(),n.insertIntervalTime=(new Date).getTime(),this.rewardVideoAd.load().then(()=>{this.rewardVideoAd.show().catch(()=>{this.showToast("\u6682\u65e0\u5e7f\u544a")})}).catch(()=>{this.showToast("\u6682\u65e0\u5e7f\u544a")}),console.log("\u5e7f\u544a\u7ec4\u4ef6\u51fa\u73b0\u95ee\u9898",e)}),console.log("\u89c6\u9891\u52a0\u8f7d\u6210\u529f")):this.createVideo()}creatBanner(){this.bannerAd=qg.createBannerAd({adUnitId:o.default.POSID_BannerAD,adIntervals:30}),this.bannerAd.onError(e=>{this.bannerAd=null,console.log("initBanner err:"+e)})}requestSubscribeSystemMessage(e){}onAddToFavorites(){}showBanner(){this.bannerAd||this.creatBanner(),this.bannerAd.show().then(()=>{console.log("banner\u52a0\u8f7d\u6210\u529f")}).catch(e=>{console.log("showBanner err:"+JSON.stringify(e))})}hideBanner(){null!=this.bannerAd&&(this.bannerAd.hide(),this.bannerAd=null)}recorderStart(){}recorderStop(){}share(e){}canShare(){return!((new Date).getTime()-this.shareTime<3e3||(this.shareTime=(new Date).getTime(),0))}addShortcut(){}exitGame(){console.log("exit==="),qg.exitApplication({success:()=>{},fail:()=>{console.log("fail===")},complete:()=>{console.log("complete===")}})}log(e){console.log("WeChatAD:"+e)}};h.insertIntervalTime=0,h.isSubscribe=!1,h.HutuiType=[100,120,130,150],h=n=i([r],h),a.default=h,cc._RF.pop()},{"../../ADManager":"ADManager","../Interface/ADInterface":"ADInterface","./XiaoMiConstant":"XiaoMiConstant"}],XiaoMiConstant:[function(e,t,a){"use strict";cc._RF.push(t,"e8c7bFBbBxNKJI9F6RkkJeu","XiaoMiConstant"),Object.defineProperty(a,"__esModule",{value:!0});class n{}a.default=n,n.POSID_NativeAD="26eb6701a4956751f23da5f3b1a5dd6d",n.POSID_BannerAD="88752052f5dbe2d55aad5b6dfaffac46",n.POSID_InsertAD="b792fd6ebb37727b37709120f33d52c6",n.POSID_VedioAD="c08945d546b5874480640f5afb998578",n.POSID_HuTuiAD=["ad889eca0a8454865e4330ee11087396","","","73b513d7cb3b1a9487d8122920d9024c"],n.appId="105554091",n.Balltimes=0,cc._RF.pop()},{}],XiaoMiNative:[function(e,t,a){"use strict";cc._RF.push(t,"19c5aNB9kZDarWlAzw//s9k","XiaoMiNative");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const i=e("../../ADManager"),s=e("./XiaoMiAD"),l=e("./XiaoMiConstant"),{ccclass:o,property:r}=cc._decorator;let c=class extends cc.Component{constructor(){super(...arguments),this.image=null,this.title=null,this.desc=null}onLoad(){i.default.instance.sdkType==i.SDK_TYPE.XiaoMi&&s.default.canShowInsertXiaoMi()?i.default.instance.isTest||this.createAD():this.node.destroy()}createAD(){this.hideNode(),i.default.instance.isTest||this.creatNativeAD()}creatNativeAD(){console.log("create====12");let e=this;this._native=qg.createNativeAd({adUnitId:l.default.POSID_NativeAD}),this._native.load(),this._native&&(console.log("naitve==="),this._native.onLoad(function(t){e._nativeCurrentAdList=t.adList.pop(),e.showNativeAd()})),this._native.onError(function(t){console.log("oppoNativeBanner\uff1a \u539f\u751f\u5e7f\u544a\u52a0\u8f7d\u5931\u8d25\uff0c\u9519\u8bef\u7801\uff1a"+JSON.stringify(t)),e.hideNode()})}showNativeAd(){let e;(e=this._nativeCurrentAdList.imgUrlList[0])||(e=this._nativeCurrentAdList.icon);let t=".png";-1!=e.indexOf(".jpg")&&(t=".jpg"),e?cc.assetManager.loadRemote(e,{ext:t},(e,t)=>{if(e)return console.log("err==",e),void this.hideNode();let a=new cc.SpriteFrame(t);this.image.spriteFrame=a,this._native.reportAdShow({adId:this._nativeCurrentAdList.adId}),this.showNode()}):this.hideNode()}clickNativeAd(){this._native&&this._native.reportAdClick({adId:this._nativeCurrentAdList.adId})}showNode(){this.node.active=!0}hideNode(){this.node.active=!1}};n([r(cc.Sprite)],c.prototype,"image",void 0),n([r(cc.Label)],c.prototype,"title",void 0),n([r(cc.Label)],c.prototype,"desc",void 0),c=n([o],c),a.default=c,cc._RF.pop()},{"../../ADManager":"ADManager","./XiaoMiAD":"XiaoMiAD","./XiaoMiConstant":"XiaoMiConstant"}],Zombie2:[function(e,t,a){"use strict";cc._RF.push(t,"515407Xw7RCZZ1szv7OOzKR","Zombie2");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const i=e("./Zombie"),{ccclass:s,property:l}=cc._decorator;let o=class extends i.default{};o=n([s],o),a.default=o,cc._RF.pop()},{"./Zombie":"Zombie"}],ZombieMgr:[function(e,t,a){"use strict";cc._RF.push(t,"3a48e2n56BLSrXA6cM3Z4zs","ZombieMgr"),Object.defineProperty(a,"__esModule",{value:!0});const n=e("../utils/BulletPool"),i=e("../utils/kc"),s=e("../utils/KDefine"),l=e("../entity/Zombie/Zombie"),o=e("../scene_stage/SceneStage"),r=e("./BundleManager"),c=e("./ExcelManager"),d=e("../utils/MyUtils"),h=e("./DataManager"),u=e("./AudioManager"),g=e("./UserDataManager"),p=e("../entity/ZombieTip"),f=e("../view/GuideUI2"),m=e("../Common");class y{constructor(){this.pTime=0,this.zombieFinish=!1,this._zombieNums=0,this.waveData={},this.waveTime=0,this.level=1,this.curWaveId=0,this.itemPoolSize=100,this.itemNode=null,this.itemBornInteval=.5,this.gapTime=0,this.zombieInRow=new Array,this.zombieSet=new Set,this.bPool=new n.default,this.sceneStage=null,this.isPlay=!1,this.isPause=!1,this.allItemArr=[],this.newPos=!1,this.constRow=0}static instance(){return y._me||(y._me=new y),y._me}get zombieNums(){return this._zombieNums}set zombieNums(e){this._zombieNums=e,this.zombieNums>20&&!g.default.instance.huangGuaGuide&&2==h.default.instance.level&&(g.default.instance.huangGuaGuide=!0,o.default.instance.huangGuaGuide()),0==this.zombieNums&&this.zombieFinish&&(0!=h.default.instance.level?o.default.instance.win():f.default.instance.nextStep())}init(e){this.allItemArr=c.ExcelMgr.instance.GetExcelObject(c.TableName.zombieTable),this.sceneStage=e;for(let t=0;t<h.default.instance.row;t++)this.zombieInRow[t]=new Set;return this.zombieSet=new Set,this.initLevel(h.default.instance.level),this}initPool(){this.itemNode=cc.instantiate(r.default.instance.getBundleRes("Prefab","zombie/zombie_1"));for(let e=0;e<this.itemPoolSize;e++)this.bPool.put(cc.instantiate(this.itemNode))}initLevel(e){20!=h.default.instance.level?this.level=e:this.level=100*e+h.default.instance.bossLevel,this.waveData=c.ExcelMgr.instance.GetExcelObject(c.TableName.levelTable)[this.level],this.sceneStage.showProgress(this.waveData.waveTime),this.sceneStage.goldNums=this.waveData.gold+h.default.instance.extraGold,this.curWaveId=0,this.pTime=0,this.waveTime=0,this.zombieFinish=!1,this.zombieNums=0}getItem(e){return this.allItemArr[e]}removeItem(e){this.removeNode(e),this.removeFromMap(e)}removeFromPool(e){this.bPool.del(e)}removeNode(e){e.stop(),this.bPool.back(e.node)}removeFromMap(e){this.zombieNums--,e.row>=0&&this.zombieInRow[e.row].delete(e),this.zombieSet.has(e)&&this.zombieSet.delete(e)}runWave(){const e=y.instance();if(!e.isPlay)return;if(e.pTime++,e.pTime>e.waveTime){if(e.curWaveId++,e.sceneStage.isPlay=!1,e.isPlay=!1,e.curWaveId>e.waveData.waveNums){if(20!=h.default.instance.level)return e.sceneStage.unschedule(e.runWave),console.log("\u6700\u540e\u4e00\u6ce2\u51fa\u5b8c\u4e86"),e.sceneStage.scheduleOnce(()=>{e.zombieFinish=!0,e.zombieNums+=0},2),e.curWaveId=e.waveData.waveNums,void(0==e.zombieNums&&0!=h.default.instance.level&&e.sceneStage.win());e.curWaveId=1}e.waveTime+=e.waveData.waveTime[e.curWaveId-1],e.gapTime=e.waveData.bigGap[e.curWaveId-1],e.sceneStage.unschedule(e.runWave),e.sceneStage.scheduleOnce(()=>{e.sceneStage.schedule(e.runWave,1),e.curWaveId==e.waveData.waveNums?u.default.instance.playEffect(s.AudioName.FinalZombieEff):u.default.instance.playEffect(s.AudioName.ZombieArriveEff),20!=h.default.instance.level&&e.showTip(),e.sceneStage.isPlay=!0,e.isPlay=!0,e.gapTime=0},e.waveData.bigGap[e.curWaveId-1])}if(e.gapTime--,e.gapTime>0)return;e.gapTime=e.waveData.gap[e.curWaveId-1];const t=d.MyUtils.getRandomInt(e.waveData.cnt[e.curWaveId-1][0],e.waveData.cnt[e.curWaveId-1][1]+1);e.randomBorn(t)}showTip(){let e=cc.instantiate(r.default.instance.getBundleRes("Prefab","Object/ZombieTip",cc.Prefab));e.getComponent(p.default).init(`\u7b2c${this.curWaveId}/${this.waveData.waveNums}\u6ce2\u50f5\u5c38\u6765\u88ad\uff01\uff01\uff01`),e.parent=this.sceneStage.node}randomBorn(e){let t=this.curWaveId;for(let a=0;a<e;a++){let e=0,n=0,i=[];for(let a=0;a<this.waveData.mid[t-1].length;a++)n+=this.waveData.mid[t-1][a][1],i.push(n);let s=Math.random();for(;s>i[e];)e++;this.sceneStage.scheduleOnce(()=>{this.showItem(this.allItemArr[this.waveData.mid[t-1][e][0]].id)},a*this.waveData.bornGap[t-1])}}itemBorn(e,t,a){if(!t){let a=i.default.randomInt(0,h.default.instance.row-1);0==h.default.instance.level&&(a=this.constRow%5,this.constRow++),t=20==h.default.instance.level||this.newPos?cc.v2(415,h.default.instance.groudYArr[a]):cc.v2(i.default.view_x+20,h.default.instance.groudYArr[a]),e.row=a,this.zombieInRow[a].add(e)}a&&(this.zombieInRow[a].add(e),e.row=a),this.zombieSet.add(e),this.zombieNums++,e.show(this.sceneStage.groudNode,t,this.curWaveId,this.isPause)}showItem(e,t,a){if(!this.isPlay)return null;let n=this.bPool.get();n||(i.default.log("ZombiePool is empty"),n=cc.instantiate(this.itemNode)),m.default.addZombieComponent(e,n);const s=n.getComponent(l.default);return this.itemBorn(s.reset(e,this.curWaveId-1),t,a),s}play(){return i.default.log("ZombieMgr play"),this.isPlay=!0,this.isPause=!1,this.runWave(),this}stop(){return i.default.log("ZombieMgr stop"),this.isPlay=!1,this.sceneStage.unschedule(this.runWave),this}pause(){return this.isPause=!0,this}resume(){return this.isPause=!1,this}}a.default=y,y._me=null,y.resPre="enemy/",cc._RF.pop()},{"../Common":"Common","../entity/Zombie/Zombie":"Zombie","../entity/ZombieTip":"ZombieTip","../scene_stage/SceneStage":"SceneStage","../utils/BulletPool":"BulletPool","../utils/KDefine":"KDefine","../utils/MyUtils":"MyUtils","../utils/kc":"kc","../view/GuideUI2":"GuideUI2","./AudioManager":"AudioManager","./BundleManager":"BundleManager","./DataManager":"DataManager","./ExcelManager":"ExcelManager","./UserDataManager":"UserDataManager"}],ZombieTip:[function(e,t,a){"use strict";cc._RF.push(t,"5dbf2mxG7lCC6w3Rq4ALtFs","ZombieTip");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const{ccclass:i}=cc._decorator;let s=class extends cc.Component{init(e){this.node.getComponentInChildren(cc.Label).string=e}onLoad(){this.node.getComponent(cc.Animation).on("stop",()=>{console.log("des=="),this.node.destroy()})}};s=n([i],s),a.default=s,cc._RF.pop()},{}],Zombie:[function(e,t,a){"use strict";cc._RF.push(t,"ab0e0mu27xEP7JXCR2RqiMe","Zombie");var n=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const i=e("../../utils/kc"),s=e("../../utils/KDefine"),l=e("../../utils/StateComponent"),o=e("../../Manager/ZombieMgr"),r=e("../Plant/PlantBase"),c=e("../../Manager/BundleManager"),d=e("../../Manager/ExcelManager"),h=e("../../Manager/BulletMgr"),u=e("../../scene_stage/SceneStage"),g=e("../../Manager/AudioManager"),p=e("../../Manager/UserDataManager"),{ccclass:f,property:m}=cc._decorator;let y=class extends l.default{constructor(){super(...arguments),this.id=1,this.speed=1,this.speed2=1,this.hp=1,this.damage=2,this.hitInteval=1,this.wave=1,this.inUse=!1,this.dragon=null,this.row=-1,this.flash=0,this.rate=0,this.frozenTimes=0,this.time=1,this.attackNode=null,this._attackNums=0,this.ani={move:"move",attack:"kenyao",dead:"death"},this.attackTarget=null,this.collider=null,this.moveTargetX=-i.default.view_x,this.canContinueHurt=!0}get attackNums(){return this._attackNums}set attackNums(e){this._attackNums=e}unuse(){this.inUse=!1,this.stop()}reuse(){this.inUse=!1}onLoad(){this.regState(s.State.move,this.stateMove),this.regState(s.State.moveing,this.stateMove),this.regState(s.State.pause,this.statePause),this.regState(s.State.hurt,this.stateHurt),this.regState(s.State.hurting,this.stateHurt),this.regState(s.State.dead,this.stateDead),this.regState(s.State.deading,this.stateDead),this.regState(s.State.attack,this.stateAttack),this.regState(s.State.attacking,this.stateAttack)}reset(e,t=0){this.dragon=this.node.getChildByName("zombie1").getComponent(sp.Skeleton);let a=d.ExcelMgr.instance.GetExcelObject(d.TableName.zombieTable)[e];return this.id=a.id,this.hp=a.hp*p.default.instance.chapter*d.ExcelMgr.instance.GetExcelObject(d.TableName.levelTable)[o.default.instance().level].hp[t],this.damage=a.damage*d.ExcelMgr.instance.GetExcelObject(d.TableName.levelTable)[o.default.instance().level].att[t],this.speed=a.speed*d.ExcelMgr.instance.GetExcelObject(d.TableName.levelTable)[o.default.instance().level].speed[t],this.speed2=this.speed,this.hitInteval=a.hitInteval,this.dragon.skeletonData=c.default.instance.getBundleRes("Spine","zombie/"+a.dragonName+"/"+a.dragonName,sp.SkeletonData),this._material=this.dragon.getMaterial(0),this.collider=this.node.getComponent(cc.BoxCollider),this.node.scale=a.scale,this._material.setProperty("u_rate",0),this._material.setProperty("ucolor",cc.color(255,255,255)),this}show(e,t,a,n=!1){this.inUse=!0,this.node.opacity=255,this.node.setPosition(t),this.node.parent=e,this.node.zIndex=s.ZIndex.enemy-this.row,this.wave=a,n?this.setState(s.State.pause):this.setState(s.State.move)}recoverNormal(){this.frozenTimes--,0==this.frozenTimes&&(this._material.setProperty("ucolor",cc.color(255,255,255)),this._material.setProperty("u_rate",0),this.rate=0,this.flash=0,this.time=1,this.dragon.timeScale=this.time)}frozen(){this.frozenTimes=3,this.unschedule(this.recoverNormal),this.schedule(this.recoverNormal,1,3),this._material.setProperty("ucolor",cc.color(15,0,255)),this.rate=.4,this.time=.6,this.dragon.timeScale=this.time}hurt(e,t,a){if(this.inUse){if(""!=t&&t){let e=h.default.instance().getEffect(t);e.scale=a,e.parent=this.node,e.x=0,e.y=0;let n=e.getComponent(sp.Skeleton);n.setAnimation(0,"newAnimation",!1),n.setCompleteListener(()=>{e.scale=1,h.default.instance().removeEffect(e)})}this.hp-=e,this.hp<=0?this.setState(s.State.dead):this.flash=.7}}stop(){this.inUse=!1,this.setState(s.State.idle)}move(){!this.inUse||this.hp<=0||(this.node.color=cc.Color.WHITE,this.setState(s.State.move))}onCollisionEnter(e,t){!this.inUse||this.hp<=0||(e.tag==s.Tag.car?this.setState(s.State.dead):e.tag==s.Tag.plant&&(this.attackNums++,this.state!=s.State.attacking&&this.setState(s.State.attack)))}onCollisionStay(e,t){if(this.inUse&&!(this.hp<=0)&&e.tag===s.Tag.plant){const t=e.node.getComponent(r.default);if(!t.inUse||!this.canContinueHurt)return;this.canContinueHurt=!1,this.attackTarget=t,this.attackTarget.hurt(this.damage),this.scheduleOnce(()=>{this.hp<=0?this.unscheduleAllCallbacks():this.canContinueHurt=!0},this.hitInteval/this.time)}}onCollisionExit(e,t){!this.inUse||this.hp<=0||e.tag===s.Tag.plant&&(this.attackNums--,0==this.attackNums&&(this.setState(s.State.move),g.default.instance.stopEffect(s.AudioName.ZombieAttackEff+this.node.uuid)))}stateMove(e){this.state===s.State.move&&(this.state=s.State.moveing,this.dragon.setAnimation(0,this.ani.move,!0),this.speed2=this.speed)}statePause(e){this.dragon.timeScale=0}stateDead(e){this.state===s.State.dead&&(0==this.dragon.timeScale&&(this.dragon.timeScale=1),g.default.instance.stopEffect(s.AudioName.ZombieAttackEff+this.node.uuid),this.hp=0,this.speed2=0,this.state=s.State.deading,this.inUse=!1,o.default.instance().removeFromMap(this),this.dragon.setAnimation(0,this.ani.dead,!1),this.dragon.setCompleteListener(()=>{this.dragon.setCompleteListener(null),o.default.instance().removeNode(this)}))}stateHurt(e){this.state===s.State.hurt&&(this.state=s.State.hurting)}stateAttack(e){this.state===s.State.attack&&(this.state=s.State.attacking,this.speed2=0,g.default.instance.playEffect(s.AudioName.ZombieAttackEff,1,!1,!0,this.node.uuid),this.dragon.setAnimation(0,this.ani.attack,!0))}update(e){this.inUse&&(0!=this.speed2&&(this.node.x-=this.speed2*this.time*e*50,this.node.x<-560&&u.default.instance.lose()),this.updateFrame(e),this.flash>this.rate&&(this.hp>0?(this.flash-=e,this.flash<this.rate&&(this.flash=this.rate),this._material.setProperty("u_rate",this.flash)):(this._material.setProperty("u_rate",0),this._material.setProperty("ucolor",cc.color(255,255,255)))))}onDestroy(){g.default.instance.stopEffect(s.AudioName.ZombieAttackEff+this.node.uuid),o.default.instance().removeFromPool(this.node)}};y=n([f],y),a.default=y,cc._RF.pop()},{"../../Manager/AudioManager":"AudioManager","../../Manager/BulletMgr":"BulletMgr","../../Manager/BundleManager":"BundleManager","../../Manager/ExcelManager":"ExcelManager","../../Manager/UserDataManager":"UserDataManager","../../Manager/ZombieMgr":"ZombieMgr","../../scene_stage/SceneStage":"SceneStage","../../utils/KDefine":"KDefine","../../utils/StateComponent":"StateComponent","../../utils/kc":"kc","../Plant/PlantBase":"PlantBase"}],htSdk:[function(e,t,a){"use strict";cc._RF.push(t,"92738of44lKebH97H17V1nW","htSdk"),function(e,t){for(var a in t)e[a]=t[a]}(a,function(e){var t={};function a(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,a),i.l=!0,i.exports}return a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},a.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=1)}([function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){}return e.lerr=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.unshift("====>"),console.error.apply(window,e)},e.llog=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.unshift("====>"),console.log.apply(window,e)},e.twoInt=function(e){return e<10?"0"+e:e},e.todayStr=function(){var t=new Date;return""+t.getFullYear()+e.twoInt(t.getMonth()+1)+e.twoInt(t.getDate())},e.randomInt=function(e,t){return Math.floor(Math.random()*(t-e+1)+e)},e.saveData=function(e,t){var a=window.localStorage;a&&a.setItem("kcSdk_"+e,t)},e.loadData=function(e){var t=window.localStorage;if(t){var a=t.getItem("kcSdk_"+e);if(a)return a}return null},e.encodeUTF8=function(e){var t,a,n,i=[];for(t=0;t<e.length;t++)(a=e.charCodeAt(t))<128?i.push(a):a<2048?i.push(192+(a>>6&31),128+(63&a)):((n=55296^a)>>10==0?(a=(n<<10)+(56320^e.charCodeAt(++t))+65536,i.push(240+(a>>18&7),128+(a>>12&63))):i.push(224+(a>>12&15)),i.push(128+(a>>6&63),128+(63&a)));return i},e.s=function(t){var a,n,i,s=new Uint8Array(e.encodeUTF8(t)),l=16+(s.length+8>>>6<<4);for((t=new Uint8Array(l<<2)).set(new Uint8Array(s.buffer)),t=new Uint32Array(t.buffer),i=new DataView(t.buffer),a=0;a<l;a++)t[a]=i.getUint32(a<<2);t[s.length>>2]|=128<<24-8*(3&s.length),t[l-1]=s.length<<3;var o=[],r=[function(){return h[1]&h[2]|~h[1]&h[3]},function(){return h[1]^h[2]^h[3]},function(){return h[1]&h[2]|h[1]&h[3]|h[2]&h[3]},function(){return h[1]^h[2]^h[3]}],c=function(e,t){return e<<t|e>>>32-t},d=[1518500249,1859775393,-1894007588,-899497514],h=[1732584193,-271733879,null,null,-1009589776];for(h[2]=~h[0],h[3]=~h[1],a=0;a<t.length;a+=16){var u=h.slice(0);for(n=0;n<80;n++)o[n]=n<16?t[a+n]:c(o[n-3]^o[n-8]^o[n-14]^o[n-16],1),i=c(h[0],5)+r[n/20|0]()+h[4]+o[n]+d[n/20|0]|0,h[1]=c(h[1],30),h.pop(),h.unshift(i);for(n=0;n<5;n++)h[n]=h[n]+u[n]|0}for(i=new DataView(new Uint32Array(h).buffer),a=0;a<5;a++)h[a]=i.getUint32(a<<2);return Array.prototype.map.call(new Uint8Array(new Uint32Array(h).buffer),function(e){return(e<16?"0":"")+e.toString(16)}).join("")},e.b=function(e){var t=[];for(var a in e)t.push(a);t=t.sort();for(var n="",i=0;i<t.length;i++){var s=e[t[i]];"object"==typeof s&&(s=this.b(s)),n+=t[i]+s}return n},e.a=function(t,a,n){var i=[];for(var s in t)null!==t[s]&&void 0!==t[s]?i.push(s):delete t[s];i=i.sort();var l=e.b(t);return a&&(l+=a),l+=n||"pH0Xhyenu2e1zdUg",e.s(l)},e.jax=function(t,a,n){n||(n=function(t){if(t)return e.lerr(t)});var i=new XMLHttpRequest,s=(new Date).getTime();a.s=e.a(a,s),i.open("POST",t,!0),i.setRequestHeader("Content-Type","application/json; charset=utf-8"),i.setRequestHeader("ts",""+s);var l=JSON.stringify(a);i.send(l),i.onload=function(){if(200==i.status){var t={jaxERR:""+i.responseText};try{t=JSON.parse(i.responseText)}catch(t){return e.lerr(t),n(null,{re:"1111",err:"jsonErr:"+i.responseText})}return n(null,t)}return n(null,{re:"9"+i.status})}},e}();t.jax=a.jax,t.llog=a.llog,t.lerr=a.lerr,t.saveData=a.saveData,t.loadData=a.loadData,t.randomInt=a.randomInt,t.todayStr=a.todayStr},function(e,t,a){Object.defineProperty(t,"__esModule",{value:!0});var n=a(0),i=function(){function e(){this.version="203",this.jumpGap=3e3,this.lastJumpT=0,this.htHost="https://dk.gametdd.com/htApi/ht_api/",this.picType="jpg",this.stageTime=0}return e.instance=function(){return e.me?e.me:(e.me=new e,e.me)},e.prototype.getUid=function(){return e.Uid?e.Uid:(e.Uid=n.loadData("uid"),e.Uid||"null")},e.prototype.getOpenId=function(){return e.openId?e.openId:(e.openId=n.loadData("openId"),e.openId||"null")},e.prototype.setUid=function(t){t&&(e.Uid=t,n.saveData("uid",t))},e.prototype.setOpenId=function(t){t&&(e.openId=t,n.saveData("openId",t))},e.prototype.jht=function(t,a,i){e.Gid?(a.v=this.version,n.jax(this.htHost+t,a,function(e,t){return e||!t?(n.llog("jhtERR",e),i(e||new Error("no re"))):0!==t.re?(n.llog("jht FAILED!"+JSON.stringify(t)),i(new Error("err:"+t.re))):void i(null,t)})):n.llog("htSdk \u672a\u521d\u59cb\u5316!!jht")},e.prototype.init=function(t,a,i){var s=this;if(n.llog("HTS init v:"+this.version+","+t+","+!!a),!t)return n.llog("HTS no gid."),i(new Error("htSdk \u65e0gid"));e.Gid=t;var l=n.loadData("htHost");l&&(this.htHost=l);var o=n.loadData("picType");o&&(this.picType=o);var r={gid:t,uid:this.getUid(),openId:this.getOpenId()};n.llog("hts init start..."+this.picType+","+this.htHost),this.jht("init2",r,function(t,l){t?i(t):(n.llog("hts init done:"+l.re),s.setUid(l.uid),l.iconPre&&(e.IconPre=l.iconPre),l.picType&&(s.picType=l.picType,n.saveData("picType",l.picType)),l.jumpGap&&(s.jumpGap=l.jumpGap),i(null,"ok"),l.htHost&&l.htHost!==s.htHost&&(s.htHost=l.htHost,n.saveData("htHost",l.htHost)),a||(a=window.wx))})},e.prototype.getBox=function(t,a){var i=this;if(!e.IconPre||!e.Gid)return n.llog("htSdk \u672a\u521d\u59cb\u5316!!"+e.IconPre),a(new Error("htSdk \u672a\u521d\u59cb\u5316 getBox"));var s={bid:t};this.jht("getBox",s,function(n,s){if(n)return a(n);if(0!==s.re||!s.arr)return a(new Error("\u670d\u52a1\u914d\u7f6e\u6709\u8befbid:"+t+",re:"+s.re));for(var l=[],o=0;o<s.arr.length;o++){for(var r=s.arr[o],c=[],d=0;d<r.length;d++){var h=r[d].split("@"),u="",g="";h.length>=4&&"0"!==h[3]&&(u="_"+h[3]),h.length>=5&&(g=h[4]),c.push({jumpKey:h[1],mid:h[0],iconUrl:e.IconPre+h[0]+u+"."+i.picType,txt:h[2],mark:g})}l.push(c)}a(null,l)})},e.prototype.jumpTo=function(t,a,i){var s=this;if(e.Gid){var l=(new Date).getTime();if(l-this.lastJumpT<this.jumpGap)n.llog("jumpTo too");else{this.lastJumpT=l;var o={gid:e.Gid,uid:this.getUid(),bid:t,mid:a};t?a?(i&&(o.fail="true"),n.llog("jumpTo",JSON.stringify(o)),this.jht("jumpTo",o,function(e,t){e||s.setUid(t.uid)})):n.llog("jumpTo \u65e0mid"):n.llog("jumpTo \u65e0bid")}}else n.llog("htSdk \u672a\u521d\u59cb\u5316!! jumpTo")},e.prototype.jumpFail=function(e,t){this.jumpTo(e,t,!0)},e.prototype.navigateToMiniProgram=function(t,a){if(e.Gid)if(a||(a=window.wx),a){var i="hts_gid="+e.Gid,s=n.loadData("hts_link");s&&s.length>5&&(i+="&hts_link="+s),t.path&&t.path.length>0?t.path+="&"+i:t.path="?"+i,a.navigateToMiniProgram(t)}else n.llog("navigateToMiniProgram \u65e0channelObj");else n.llog("htSdk \u672a\u521d\u59cb\u5316!!navigateToMiniProgram")},e.prototype.jumpFrom=function(t){var a=this;if(e.Gid)if(t)if(n.llog("query",t),t.hts_gid){var i={query:t,gid:e.Gid,uid:this.getUid(),openId:this.getOpenId()};n.llog("jumpFrom",JSON.stringify(i)),this.jht("jumpFrom",i,function(e,t){e||(t.hts_link&&n.saveData("hts_link",t.hts_link),t.uid&&a.setUid(t.uid))})}else n.llog("jumpFrom no hts_gid:",t);else n.llog("jumpFrom query is empty!",t);else n.llog("htSdk \u672a\u521d\u59cb\u5316!!jumpFrom")},e.prototype.bindOpenId=function(t,a){this.jht("bindOpenId",{openId:t,gid:e.Gid,uid:this.getUid()},a),this.setOpenId(t)},e.prototype.codeForOpenId=function(t,a){var i=this;this.jht("codeForOpenId",{code:t,uid:this.getUid(),gid:e.Gid},function(e,t){if(e)return n.lerr(e),a(e);t.data?(t.data.openid&&i.setOpenId(t.data.openid),a(null,t.data)):a(),t.uid&&i.setUid(t.uid)})},e.prototype.stageLog=function(t,a,i,s){var l={eventName:t,stageId:a,openId:this.getOpenId(),gid:e.Gid,uid:this.getUid(),userProps:i};s&&(l.stageTime=s),this.jht("stageLog",l,function(e){if(e)return n.lerr(e)})},e.prototype.stageStart=function(e,t){this.stageTime=0,this.stageLog("start",e,t)},e.prototype.stageFail=function(e,t){this.stageTime=Date.now()-this.stageTime,this.stageLog("fail",e,t,this.stageTime),this.stageTime=0},e.prototype.stageComplet=function(e,t){this.stageTime=Date.now()-this.stageTime,this.stageLog("complet",e,t,this.stageTime),this.stageTime=0},e.prototype.userUpdate=function(t){this.jht("userUpdate",{openId:this.getOpenId(),gid:e.Gid,uid:this.getUid(),userProps:t},function(e){if(e)return n.lerr(e)})},e.prototype.eventReport=function(t,a,i){this.jht("eventReport",{eventName:t,eventProp:a,openId:this.getOpenId(),gid:e.Gid,uid:this.getUid(),userProps:i},function(e){if(e)return n.lerr(e)})},e.prototype.sceneReport=function(t,a,i){this.jht("sceneReport",{sceneName:t,sceneTime:a,openId:this.getOpenId(),gid:e.Gid,uid:this.getUid(),userProps:i},function(e){if(e)return n.lerr(e)})},e.prototype.getSharePic=function(e,t){this.jht("getSharePic",{game:e},t)},e.prototype.shareTo=function(e){this.jht("shareTo",{wxPicId:e},function(t){t?n.lerr(t):n.llog("shareTo OK,"+e)})},e.prototype.shareFrom=function(e){this.jht("shareFrom",{wxPicId:e},function(t){t?n.lerr(t):n.llog("shareFrom OK,"+e)})},e.prototype.jreq=function(e,t,a){n.jax(e,t,a)},e}();t.default=i.instance()}])),cc._RF.pop()},{}],kc:[function(e,t,a){"use strict";cc._RF.push(t,"0406fIDd3FAhI32kNJ/+j7G","kc");var n,i=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,l=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(l=(s<3?i(l):s>3?i(t,a,l):i(t,a))||l);return s>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});const s=e("../Manager/BundleManager"),{ccclass:l,property:o}=cc._decorator;let r=n=class{static log(...e){e.unshift("====>"),console.log.apply(window,e)}static err(...e){e.unshift("====>"),console.error.apply(window,e)}static init(){const e=cc.view.getVisibleSize();n.view_x=e.width/2,n.view_y=e.height/2,n.view_mag=cc.v2(n.view_x,n.view_y).mag(),n.log("\u53ef\u89c6\u533a\u57df",n.view_x,n.view_y),cc.view.setResizeCallback(n.init)}static leftPad(e,t,a="0"){const n=t-e.length;if(n<=0)return e;for(let i=0;i<n;i++)e=a+e;return e}static showPassTime(e){const t=""+e%60,a=""+Math.floor(e/60);return this.leftPad(a,2)+":"+this.leftPad(t,2)}static showPercent(e){return 100*e+"%"}static posToAngle(e,t,a,n){return 180*Math.atan2(n-t,a-e)/Math.PI}static clone(e){if(Array.isArray(e)){const t=[];for(let a=0,i=e.length;a<i;a++)t.push(n.clone(e[a]));return t}if("[object Object]"===Object.prototype.toString.call(e)){const t={};for(const a in e)t[a]=n.clone(e[a]);return t}return e}static uiLayout(e,t,a,i,l,o=!1){if(!t||!i||i.length!==t.length)return void n.err("[ERR]uiLayout\u7684fatherNodeArr\u6216itemDataArr\u914d\u7f6e\u9519\u8bef");const r=e.layout;for(let n=0;n<r.length;n++){const c=r[n],d=i[n],h=t[n],u=d.length;if("gird"===c.type){const t=c.colCount||u,n=(Math.ceil(u/t),c.minItems||u),i=o?h.children.length:0,r=cc.instantiate(s.default.instance.getBundleRes("Prefab",c.itemPrefab)),g=c.itemPadding||[0,0],p=c.padding||[0,0,0,0],f=r.width/2+g[0],m=r.height/2+g[1],y=0-t+1,C=0;let b=0,P=0;for(let s=0;s<n;s++){let n;b>=t&&(b=0,P++),n=o&&s<i?h.children[s]:cc.instantiate(r);const g=s<u?d[s]:null;if(a.call(l,n,e,g,c,o),n.parent=h,n.x=(y+2*b)*f-p[1]+p[3],n.y=(C+2*P)*m*-1-p[0]+p[2],c.itemProps)for(const e in c.itemProps)n[e]=c.itemProps[e];b++}if(o&&i>u)for(let e=u;e<i;e++)h.removeChild(h.children[u])}}}static randomInt(e,t){return Math.floor(Math.random()*(t-e+1)+e)}static randomBool(e=.5){return Math.random()<e}static randomPosNeg1(){return Math.random()>.5?1:-1}static shuffle(e){let t=e.length,a=0;for(;t;)a=Math.random()*t-->>>0,[e[t],e[a]]=[e[a],e[t]];return e}static randomChoose(e,t){if(!t||1===t)return[e[Math.floor(Math.random()*e.length)]];const a=e.slice(0);if(t>e.length)return a;let n=0,i=0,s=e.length;const l=s-t;for(;s-- >l;)n=a[i=Math.floor((s+1)*Math.random())],a[i]=a[s],a[s]=n;return a.slice(l)}static randomDraw(e){const t=Math.random();let a=0;for(const n in e){if(t>a&&t<a+e[n])return n;a+=e[n]}return null}static randomPick(e,t){if(!t||1===t)return e.splice(Math.floor(Math.random()*e.length),1);if(t>e.length)return e;const a=[];for(let n=0;n<t;n++){const t=Math.floor(Math.random()*e.length);a.push(e.splice(t,1)[0])}return a}static resetTexRect(e){if(!e.spriteFrame)return void n.err("[ERR]resetTexRect",e);const t=e.spriteFrame.getRect(),a=e.spriteFrame.getTexture(),i=t.x/a.width,s=t.y/a.height,l=(t.x+t.width)/a.width,o=(t.y+t.height)/a.height,r=new cc.Vec4(i,s,l-i,o-s);e.getMaterial(0).setProperty("_TexRect",r)}static shake(e,t=3,a=0,n=10){const i={shakeCount:t,node:e,orgX:e.x,orgY:e.y,isDone:!1,doneFn:()=>{},done:null,tw:null};return i.done=(e,t)=>(e&&(i.doneFn=()=>{e.call(t||i.node)}),i),i.tw=cc.tween(i.node).repeat(i.shakeCount,cc.tween().to(.05,{x:i.orgX+n,y:i.orgY+a}).to(.05,{x:i.orgX-n,y:i.orgY-a})).call(()=>{i.doneFn()}),i.tw.start(),i}static resetMsgReciever(e,t){n.msgMap[e]=t}static delMsgReciever(e){delete n.msgMap[e]}static regMsgReciever(e,t){const a=n.msgMap[e];a?n.msgMap[e]=e=>!!a(e)&&t(e):n.resetMsgReciever(e,t)}static sendMsg(e,t){const a=n.msgMap[e];a&&a(t)}static moveTo(e,t,a,n=.5,i=function(){}){const s=t.sub(cc.v2(e.position)),l=s.mag();if(0===l)return void i();const o=s.x/l*a,r=s.y/l*a;cc.tween(e).to(n,{x:e.x+o,y:e.y+r}).call(i).start()}static updateMove(e,t,a,n=10,i=0,s){if(!e||0===n)return;const l=t.sub(a),o=l.mag();if(0===o)return;0!==i&&(l.x>=0?e.scaleX=i:e.scaleX=-i);const r=l.x/o,c=l.y/o;s&&!s(l,o,r,c)||(e.x+=r*n,e.y+=c*n)}static twoInt(e){return e<10?"0"+e:e}static todayStr(){const e=new Date;return""+e.getFullYear()+n.twoInt(e.getMonth()+1)+n.twoInt(e.getDate())}static saveData(e,t){const a=window.localStorage;a&&a.setItem("kc_"+e,t)}static loadData(e){const t=window.localStorage;if(t){const a=t.getItem("kc_"+e);if(a)return a}return null}static jget(e,t){t||(t=function(e){if(e)return n.err(e)});const a=new XMLHttpRequest;a.open("GET",e,!0),a.onload=function(){return 200==a.status?t(null,a.responseText):t("[ERR-jget]:"+a.status)},a.send()}static jpost(e,t,a){a||(a=function(e){if(e)return n.err(e)});const i=new XMLHttpRequest;(new Date).getTime(),i.open("POST",e,!0),i.setRequestHeader("Content-Type","application/json; charset=utf-8");const s=JSON.stringify(t);i.send(s),i.onload=function(){if(200==i.status){let t={postERR:""+i.responseText};try{t=JSON.parse(i.responseText)}catch(e){return n.err(e),a(null,{code:"1111",err:"jsonErr:"+i.responseText})}return a(null,t)}return a(null,{code:""+i.status})}}};r.view_x=0,r.view_y=0,r.view_mag=0,r.msgMap={},r=n=i([l],r),a.default=r,cc._RF.pop()},{"../Manager/BundleManager":"BundleManager"}]},{},["CSVParser","ADManager","ADUnity","ByteAD","ByteConstant","Time","HuaWeiAD","HuaWeiConstant","IOSConstant","ADCallBack","ADInterface","PayInterface","OppoAD","OppoConstant","OppoNative","VIVOAD","VIVOConstant","KuangDian","MoreGameUI","WeChatAD","WeChatConstant","WeChatTime","WechatImgControl","XiaoMiAD","XiaoMiConstant","XiaoMiNative","FirstPanelUI","Privacy_UserView","GameSwitch","VideoControl","Hts","htSdk","Common","AudioManager","BulletMgr","BundleManager","CardMgr","DataManager","ExcelManager","GoldManager","PlantMgr","PoolManager","UIManager","UserDataManager","ZombieMgr","LoadScene","MainScene","TestScene","TaSdk","Ball","Boss","BulletBase","Car","Card","Gold","Plant10","Plant2","Plant21","Plant23","Plant3","Plant4","Plant5","Plant6","Plant8","Plant9","PlantBase","ShopItem","ZombieTip","Zombie","Zombie2","Debug","GMap","SceneStage","BulletPool","FrameAnim","FrameAnimComponent","KDefine","MyUtils","StateComponent","kc","BossSelectUI","BossUI","ChipTipUI","DrawUI","FailUI","GuideUI","GuideUI2","MenuUI","MoneyPanelUI","NoCoinUI","OnlineRewardUI","PauseUI","PrepareCards","RewardUI","SharePanelUI","ShopUI","SignUI","SuccessUI","TaskUI","ToastUI","TryPanelUI","UnLockPlantUI","UpgradeUI"]);